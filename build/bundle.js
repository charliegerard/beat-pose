(()=>{var e={4200:()=>{if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");const e={childList:!0,attributes:!0,subtree:!0};AFRAME.registerComponent("aabb-collider",{schema:{collideNonVisible:{default:!1},debug:{default:!1},enabled:{default:!0},interval:{default:80},objects:{default:""}},init:function(){this.centerDifferenceVec3=new THREE.Vector3,this.clearedIntersectedEls=[],this.closestIntersectedEl=null,this.boundingBox=new THREE.Box3,this.boxCenter=new THREE.Vector3,this.boxHelper=new THREE.BoxHelper,this.boxMax=new THREE.Vector3,this.boxMin=new THREE.Vector3,this.hitClosestClearEventDetail={},this.hitClosestEventDetail={},this.intersectedEls=[],this.objectEls=[],this.newIntersectedEls=[],this.prevCheckTime=void 0,this.previousIntersectedEls=[],this.setDirty=this.setDirty.bind(this),this.observer=new MutationObserver(this.setDirty),this.dirty=!0,this.hitStartEventDetail={intersectedEls:this.newIntersectedEls}},play:function(){this.observer.observe(this.el.sceneEl,e),this.el.sceneEl.addEventListener("object3dset",this.setDirty),this.el.sceneEl.addEventListener("object3dremove",this.setDirty)},remove:function(){this.observer.disconnect(),this.el.sceneEl.removeEventListener("object3dset",this.setDirty),this.el.sceneEl.removeEventListener("object3dremove",this.setDirty)},tick:function(e){const t=this.boundingBox,i=this.centerDifferenceVec3,n=this.clearedIntersectedEls,o=this.el,s=this.intersectedEls,a=this.newIntersectedEls,r=this.objectEls,l=this.prevCheckTime,c=this.previousIntersectedEls;let d,h,u;if(this.data.enabled&&!(l&&e-l<this.data.interval)){for(this.prevCheckTime=e,this.dirty&&this.refreshObjects(),t.setFromObject(o.object3D),this.boxMin.copy(t.min),this.boxMax.copy(t.max),t.getCenter(this.boxCenter),this.data.debug&&(this.boxHelper.setFromObject(o.object3D),this.boxHelper.parent||o.sceneEl.object3D.add(this.boxHelper)),function(e,t){e.length=0;for(let i=0;i<t.length;i++)e[i]=t[i]}(c,s),s.length=0,u=0;u<r.length;u++)if(r[u]!==this.el)if(this.data.collideNonVisible||r[u].getAttribute("visible"))this.isIntersecting(r[u])&&s.push(r[u]);else if(this.data.debug){const e=r[u].object3D.boxHelper;e&&(o.sceneEl.object3D.remove(e),r[u].object3D.boxHelper=null)}for(a.length=0,u=0;u<s.length;u++)-1===c.indexOf(s[u])&&a.push(s[u]);for(n.length=0,u=0;u<c.length;u++)-1===s.indexOf(c[u])&&(c[u].hasAttribute("aabb-collider")||c[u].emit("hitend"),n.push(c[u]));for(u=0;u<a.length;u++)a[u]!==this.el&&(a[u].hasAttribute("aabb-collider")||a[u].emit("hitstart"));for(u=0;u<s.length;u++)s[u]!==this.el&&(i.copy(s[u].object3D.boundingBoxCenter).sub(this.boxCenter),(void 0===d||i.length()<d)&&(d=i.length(),h=s[u]));!s.length&&this.closestIntersectedEl?(this.hitClosestClearEventDetail.el=this.closestIntersectedEl,this.closestIntersectedEl.emit("hitclosestclear"),this.closestIntersectedEl=null,o.emit("hitclosestclear",this.hitClosestClearEventDetail)):h!==this.closestIntersectedEl&&(this.closestIntersectedEl&&(this.hitClosestClearEventDetail.el=this.closestIntersectedEl,this.closestIntersectedEl.emit("hitclosestclear",this.hitClosestClearEventDetail)),h&&(h.emit("hitclosest"),this.closestIntersectedEl=h,this.hitClosestEventDetail.el=h,o.emit("hitclosest",this.hitClosestEventDetail))),n.length&&o.emit("hitend"),a.length&&o.emit("hitstart",this.hitStartEventDetail)}},isIntersecting:function(){const e=new THREE.Box3;return function(t){let i;t.dataset.aabbColliderDynamic&&(e.setFromObject(t.object3D),i=e,t.object3D.boundingBoxCenter=t.object3D.boundingBoxCenter||new THREE.Vector3,i.getCenter(t.object3D.boundingBoxCenter)),t.dataset.aabbColliderDynamic||(t.object3D.aabbBox||(t.object3D.aabbBox=(new THREE.Box3).setFromObject(t.object3D),t.object3D.boundingBoxCenter=new THREE.Vector3,t.object3D.aabbBox.getCenter(t.object3D.boundingBoxCenter)),i=t.object3D.aabbBox),this.data.debug&&(t.object3D.boxHelper||(t.object3D.boxHelper=new THREE.BoxHelper(t.object3D,new THREE.Color(Math.random(),Math.random(),Math.random())),t.sceneEl.object3D.add(t.object3D.boxHelper)),t.object3D.boxHelper.setFromObject(t.object3D));const n=i.min,o=i.max;return this.boxMin.x<=o.x&&this.boxMax.x>=n.x&&this.boxMin.y<=o.y&&this.boxMax.y>=n.y&&this.boxMin.z<=o.z&&this.boxMax.z>=n.z}}(),setDirty:function(){this.dirty=!0},refreshObjects:function(){const e=this.data;this.objectEls=e.objects?this.el.sceneEl.querySelectorAll(e.objects):this.el.sceneEl.children,this.dirty=!1}})},9489:e=>{var t=[new THREE.Vector2,new THREE.Vector2,new THREE.Vector2,new THREE.Vector2];function i(e,i,n,o){const s=1/o,a=1/n;return t[0].set(s*i,a*e+a),t[1].set(s*i,a*e),t[2].set(s*i+s,a*e),t[3].set(s*i+s,a*e+a),t}AFRAME.registerComponent("atlas-uvs",{dependencies:["geometry"],schema:{totalColumns:{type:"int",default:1},totalRows:{type:"int",default:1},column:{type:"int",default:1},row:{type:"int",default:1}},update:function(){const e=this.data,t=i(e.row-1,e.column-1,e.totalRows,e.totalColumns),n=this.el.getObject3D("mesh").geometry;n.faceVertexUvs[0][0][0].copy(t[0]),n.faceVertexUvs[0][0][1].copy(t[1]),n.faceVertexUvs[0][0][2].copy(t[3]),n.faceVertexUvs[0][1][0].copy(t[1]),n.faceVertexUvs[0][1][1].copy(t[2]),n.faceVertexUvs[0][1][2].copy(t[3]),n.uvsNeedUpdate=!0}}),AFRAME.registerComponent("dynamic-texture-atlas",{schema:{canvasId:{default:"dynamicAtlas"},canvasHeight:{default:1024},canvasWidth:{default:1024},debug:{default:!1},numColumns:{default:8},numRows:{default:8}},multiple:!0,init:function(){const e=this.canvas=document.createElement("canvas");e.id=this.data.canvasId,e.height=this.data.canvasHeight,e.width=this.data.canvasWidth,this.ctx=e.getContext("2d"),document.body.appendChild(e),this.data.debug&&(e.style.left=0,e.style.top=0,e.style.position="fixed",e.style.zIndex=9999999999)},drawTexture:function(e,t,n,o,s){const a=this.canvas,r=this.data;e.complete||(e.onload=()=>{this.drawTexture(e,t,n)});const l=s||a.height/r.numRows,c=o||a.width/r.numColumns;return this.ctx.drawImage(e,c*t,c*n,c,l),i(t,n,r.numRows,r.numColumns)}}),e.exports.getGridUvs=i},6977:()=>{if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");var e={};AFRAME.registerComponent("audioanalyser",{schema:{buffer:{default:!1},beatDetectionDecay:{default:.99},beatDetectionMinVolume:{default:15},beatDetectionThrottle:{default:250},enabled:{default:!0},enableBeatDetection:{default:!0},enableLevels:{default:!0},enableWaveform:{default:!0},enableVolume:{default:!0},fftSize:{default:2048},smoothingTimeConstant:{default:.8},src:{parse:function(e){return e.constructor!==String?e:e.startsWith("#")||e.startsWith(".")?document.querySelector(e):e}},unique:{default:!1}},init:function(){this.audioEl=null,this.levels=null,this.waveform=null,this.volume=0,this.xhr=null,this.initContext()},update:function(e){var t=this.analyser,i=this.data;e.fftSize===i.fftSize&&e.smoothingTimeConstant===i.smoothingTimeConstant||(t.fftSize=i.fftSize,t.smoothingTimeConstant=i.smoothingTimeConstant,this.levels=new Uint8Array(t.frequencyBinCount),this.waveform=new Uint8Array(t.fftSize)),i.src&&this.refreshSource()},tick:function(e,t){var i,n=this.data;if(n.enabled){if((n.enableLevels||n.enableVolume)&&this.analyser.getByteFrequencyData(this.levels),n.enableWaveform&&this.analyser.getByteTimeDomainData(this.waveform),n.enableVolume||n.enableBeatDetection){for(var o=0,s=0;s<this.levels.length;s++)o+=this.levels[s];this.volume=o/this.levels.length}n.enableBeatDetection&&(i=this.volume,this.beatCutOff||(this.beatCutOff=i),i>this.beatCutOff&&i>this.data.beatDetectionMinVolume?(this.el.emit("audioanalyserbeat",null,!1),this.beatCutOff=1.5*i,this.beatTime=0):this.beatTime<=this.data.beatDetectionThrottle?this.beatTime+=t:(this.beatCutOff*=this.data.beatDetectionDecay,this.beatCutOff=Math.max(this.beatCutOff,this.data.beatDetectionMinVolume)))}},initContext:function(){var e,t=this.data;this.context=new(window.webkitAudioContext||window.AudioContext),e=this.analyser=this.context.createAnalyser(),(this.gainNode=this.context.createGain()).connect(e),e.connect(this.context.destination),e.fftSize=t.fftSize,e.smoothingTimeConstant=t.smoothingTimeConstant,this.levels=new Uint8Array(e.frequencyBinCount),this.waveform=new Uint8Array(e.fftSize)},refreshSource:function(){this.analyser;var e=this.data;e.buffer&&e.src.constructor===String?this.getBufferSource().then((e=>{this.source=e,this.source.connect(this.gainNode)})):(this.source=this.getMediaSource(),this.source.connect(this.gainNode))},suspendContext:function(){this.context.suspend()},resumeContext:function(){this.context.resume()},fetchAudioBuffer:function(t){return e[t]?e[t].constructor===Promise?e[t]:Promise.resolve(e[t]):(e[t]=new Promise((i=>{const n=this.xhr=new XMLHttpRequest;n.open("GET",t),n.responseType="arraybuffer",n.addEventListener("load",(()=>{function o(n){e[t]=n,i(n)}const s=this.context.decodeAudioData(n.response,o);s&&s.constructor===Promise&&s.then(o).catch(console.error)})),n.send()})),e[t])},getBufferSource:function(){var t=this.data;return this.fetchAudioBuffer(t.src).then((()=>{var i;return(i=this.context.createBufferSource()).buffer=e[t.src],this.el.emit("audioanalyserbuffersource",i,!1),i})).catch(console.error)},getMediaSource:function(){const e={};return function(){const t=this.data.src.constructor===String?this.data.src:this.data.src.src;if(e[t])return e[t];this.data.src.constructor===String?(this.audio=document.createElement("audio"),this.audio.crossOrigin="anonymous",this.audio.setAttribute("src",this.data.src)):this.audio=this.data.src;const i=this.context.createMediaElementSource(this.audio);return e[t]=i,i}}()})},8327:()=>{var e=AFRAME.utils.styleParser;if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");AFRAME.registerComponent("event-set",{schema:{default:"",parse:function(t){return e.parse(t)}},multiple:!0,init:function(){this.eventHandler=null,this.eventName=null},update:function(e){this.removeEventListener(),this.updateEventListener(),this.addEventListener()},remove:function(){this.removeEventListener()},pause:function(){this.removeEventListener()},play:function(){this.addEventListener()},updateEventListener:function(){var e,t,i,n=this.data,o=this.el;e=n._event||this.id,t=n._target,i=t?o.sceneEl.querySelector(t):o,this.eventName=e;const s=()=>{var e;for(e in n)"_event"!==e&&"_target"!==e&&AFRAME.utils.entity.setComponentProperty.call(this,i,e,n[e])};isNaN(n._delay)?this.eventHandler=s:this.eventHandler=()=>{setTimeout(s,parseFloat(n._delay))}},addEventListener:function(){this.el.addEventListener(this.eventName,this.eventHandler)},removeEventListener:function(){this.el.removeEventListener(this.eventName,this.eventHandler)}})},4454:(e,t,i)=>{THREE.BufferGeometryUtils||i(6060),AFRAME.registerComponent("geometry-merger",{schema:{preserveOriginal:{default:!1}},init:function(){var e=this;this.geometry=new THREE.Geometry,this.mesh=new THREE.Mesh(this.geometry),this.el.setObject3D("mesh",this.mesh),this.faceIndex={},this.vertexIndex={},this.el.object3D.traverse((function(t){"Mesh"===t.type&&t!==e.mesh&&(e.faceIndex[t.parent.uuid]=[e.geometry.faces.length,e.geometry.faces.length+t.geometry.faces.length-1],e.vertexIndex[t.parent.uuid]=[e.geometry.vertices.length,e.geometry.vertices.length+t.geometry.vertices.length-1],t.parent.updateMatrix(),e.geometry.merge(t.geometry,t.parent.matrix),e.data.preserveOriginal||t.parent.remove(t))}))}}),AFRAME.registerComponent("buffer-geometry-merger",{schema:{preserveOriginal:{default:!1}},init:function(){var e=[];this.el.sceneEl.object3D.updateMatrixWorld(),this.el.object3D.traverse((function(t){"Mesh"===t.type&&t.el!==self.el&&(t.geometry.applyMatrix(t.matrixWorld),e.push(t.geometry.clone()),t.parent.remove(t))}));const t=THREE.BufferGeometryUtils.mergeBufferGeometries(e);this.mesh=new THREE.Mesh(t),this.el.setObject3D("mesh",this.mesh)}})},6060:()=>{THREE.BufferGeometryUtils={computeTangents:function(e){var t=e.index,i=e.attributes;if(null!==t&&void 0!==i.position&&void 0!==i.normal&&void 0!==i.uv){var n=t.array,o=i.position.array,s=i.normal.array,a=i.uv.array,r=o.length/3;void 0===i.tangent&&e.addAttribute("tangent",new THREE.BufferAttribute(new Float32Array(4*r),4));for(var l=i.tangent.array,c=[],d=[],h=0;h<r;h++)c[h]=new THREE.Vector3,d[h]=new THREE.Vector3;var u=new THREE.Vector3,f=new THREE.Vector3,m=new THREE.Vector3,p=new THREE.Vector2,g=new THREE.Vector2,b=new THREE.Vector2,y=new THREE.Vector3,v=new THREE.Vector3,E=e.groups;0===E.length&&(E=[{start:0,count:n.length}]),h=0;for(var x=E.length;h<x;++h)for(var w=_=(D=E[h]).start,A=_+D.count;w<A;w+=3)B(n[w+0],n[w+1],n[w+2]);var k,T,R,C=new THREE.Vector3,S=new THREE.Vector3,M=new THREE.Vector3,P=new THREE.Vector3;for(h=0,x=E.length;h<x;++h){var D,_;for(w=_=(D=E[h]).start,A=_+D.count;w<A;w+=3)j(n[w+0]),j(n[w+1]),j(n[w+2])}}else console.warn("THREE.BufferGeometry: Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()");function B(e,t,i){u.fromArray(o,3*e),f.fromArray(o,3*t),m.fromArray(o,3*i),p.fromArray(a,2*e),g.fromArray(a,2*t),b.fromArray(a,2*i);var n=f.x-u.x,s=m.x-u.x,r=f.y-u.y,l=m.y-u.y,h=f.z-u.z,E=m.z-u.z,x=g.x-p.x,w=b.x-p.x,A=g.y-p.y,k=b.y-p.y,T=1/(x*k-w*A);y.set((k*n-A*s)*T,(k*r-A*l)*T,(k*h-A*E)*T),v.set((x*s-w*n)*T,(x*l-w*r)*T,(x*E-w*h)*T),c[e].add(y),c[t].add(y),c[i].add(y),d[e].add(v),d[t].add(v),d[i].add(v)}function j(e){M.fromArray(s,3*e),P.copy(M),T=c[e],C.copy(T),C.sub(M.multiplyScalar(M.dot(T))).normalize(),S.crossVectors(P,T),R=S.dot(d[e]),k=R<0?-1:1,l[4*e]=C.x,l[4*e+1]=C.y,l[4*e+2]=C.z,l[4*e+3]=k}},mergeBufferGeometries:function(e,t){for(var i=null!==e[0].index,n=new Set(Object.keys(e[0].attributes)),o=new Set(Object.keys(e[0].morphAttributes)),s={},a={},r=new THREE.BufferGeometry,l=0,c=0;c<e.length;++c){var d=e[c];if(i!==(null!==d.index))return null;for(var h in d.attributes){if(!n.has(h))return null;void 0===s[h]&&(s[h]=[]),s[h].push(d.attributes[h])}for(var h in d.morphAttributes){if(!o.has(h))return null;void 0===a[h]&&(a[h]=[]),a[h].push(d.morphAttributes[h])}if(r.userData&&(r.userData.mergedUserData=r.userData.mergedUserData||[],r.userData.mergedUserData.push(d.userData)),t){var u;if(i)u=d.index.count;else{if(void 0===d.attributes.position)return null;u=d.attributes.position.count}r.addGroup(l,u,c),l+=u}}if(i){var f=0,m=[];for(c=0;c<e.length;++c){for(var p=e[c].index,g=0;g<p.count;++g)m.push(p.getX(g)+f);f+=e[c].attributes.position.count}r.setIndex(m)}for(var h in s){var b=this.mergeBufferAttributes(s[h]);if(!b)return null;r.addAttribute(h,b)}for(var h in a){var y=a[h][0].length;if(0===y)break;for(r.morphAttributes=r.morphAttributes||{},r.morphAttributes[h]=[],c=0;c<y;++c){var v=[];for(g=0;g<a[h].length;++g)v.push(a[h][g][c]);var E=this.mergeBufferAttributes(v);if(!E)return null;r.morphAttributes[h].push(E)}}return r},mergeBufferAttributes:function(e){for(var t,i,n,o=0,s=0;s<e.length;++s){var a=e[s];if(a.isInterleavedBufferAttribute)return null;if(void 0===t&&(t=a.array.constructor),t!==a.array.constructor)return null;if(void 0===i&&(i=a.itemSize),i!==a.itemSize)return null;if(void 0===n&&(n=a.normalized),n!==a.normalized)return null;o+=a.array.length}var r=new t(o),l=0;for(s=0;s<e.length;++s)r.set(e[s].array,l),l+=e[s].array.length;return new THREE.BufferAttribute(r,i,n)}}},8581:()=>{if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");AFRAME.registerComponent("haptics",{schema:{actuatorIndex:{default:0},dur:{default:100},enabled:{default:!0},events:{type:"array"},eventsFrom:{type:"string"},force:{default:1}},multiple:!0,init:function(){this.data;var e=this;this.callPulse=function(){e.pulse()};var t=function(){e.gamepad=e.el.components["tracked-controls"].controller,e.gamepad.gamepad&&(e.gamepad=e.gamepad.gamepad),e.gamepad&&e.gamepad.hapticActuators&&e.gamepad.hapticActuators.length&&e.addEventListeners()};this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller?t():this.el.addEventListener("controllerconnected",(function(){t()}))},remove:function(){this.removeEventListeners()},pulse:function(e,t){var i=this.data;i.enabled&&this.gamepad&&this.gamepad.hapticActuators&&this.gamepad.hapticActuators[i.actuatorIndex].pulse(e||i.force,t||i.dur)},addEventListeners:function(){var e,t,i=this.data;for(t=i.eventsFrom?document.querySelector(i.eventsFrom):this.el,e=0;e<i.events.length;e++)t.addEventListener(i.events[e],this.callPulse)},removeEventListeners:function(){var e,t,i=this.data;for(t=i.eventsFrom?document.querySelector(i.eventsFrom):this.el,e=0;e<i.events.length;e++)t.removeEventListener(i.events[e],this.callPulse)}})},3008:e=>{var t=[],i=new THREE.Vector3;function n(e,n,o){var s,a,r,l,d,h,u=Math.ceil(n/e.columns);for(a=e.marginColumn,r=e.marginRow,o&&(a=e.margin,r=e.margin),d=c(e.align,u),l=c(e.align,e.columns),h=0;h<u;h++)for(s=0;s<e.columns;s++)i.set(0,0,0),0===e.plane.indexOf("x")&&(i.x=(s-l)*a),0===e.plane.indexOf("y")&&(i.y=(s-l)*a),1===e.plane.indexOf("y")&&(i.y=(h-d)*r),1===e.plane.indexOf("z")&&(i.z=(h-d)*r),f(i);return t}function o(e,n){var o,s;for(o=0;o<n;o++)s=isNaN(e.angle)?o*(2*Math.PI)/n:o*e.angle*.01745329252,i.set(0,0,0),0===e.plane.indexOf("x")&&(i.x=e.radius*Math.cos(s)),0===e.plane.indexOf("y")&&(i.y=e.radius*Math.cos(s)),1===e.plane.indexOf("y")&&(i.y=e.radius*Math.sin(s)),1===e.plane.indexOf("z")&&(i.z=e.radius*Math.sin(s)),f(i);return t}function s(e,t){return e.columns=t,n(e,t,!0)}function a(e,i){return u(1,0,0,0,1,0,0,0,1,-1,0,0,0,-1,0,0,0,-1),d(e.radius/2),t}function r(e,i){var n=(1+Math.sqrt(5))/2,o=1/n,s=2-n,a=-1*o,r=-1*s;return u(-1,s,0,-1,r,0,0,-1,s,0,-1,r,0,1,s,0,1,r,1,s,0,1,r,0,o,o,o,o,o,a,o,a,o,o,a,a,s,0,1,s,0,-1,a,o,o,a,o,a,a,a,o,a,a,a,r,0,1,r,0,-1),d(e.radius/2),t}function l(e,i){var n=Math.sqrt(3),o=-1/Math.sqrt(3);return u(0,0,n+o,-1,0,o,1,0,o,0,2*Math.sqrt(2/3),0),d(e.radius/2),t}function c(e,t){switch(e){case"start":return t-1;case"center":return(t-1)/2;case"end":return 0}}function d(e){var i;for(i=0;i<t.length;i++)t[i]=t[i]*e}function h(e,t,i){var n,o,s;if(i)for(o=0;o<e.length;o++)null!=(n=e[o].getAttribute(i))&&(s=3*parseInt(n,10),e[o].object3D.position.set(t[s],t[s+1],t[s+2]));else for(o=0;o<t.length;o+=3){if(!e[o/3])return;e[o/3].object3D.position.set(t[o],t[o+1],t[o+2])}}function u(){var e;for(e=0;e<arguments.length;e++)t.push(e)}function f(e){t.push(e.x),t.push(e.y),t.push(e.z)}AFRAME.registerComponent("layout",{schema:{angle:{type:"number",default:!1,min:0,max:360,if:{type:["circle"]}},columns:{default:1,min:0,if:{type:["box"]}},margin:{default:1,min:0,if:{type:["box","line"]}},marginColumn:{default:1,min:0,if:{type:["box"]}},marginRow:{default:1,min:0,if:{type:["box"]}},orderAttribute:{default:""},plane:{default:"xy"},radius:{default:1,min:0,if:{type:["circle","cube","dodecahedron","pyramid"]}},reverse:{default:!1},type:{default:"line",oneOf:["box","circle","cube","dodecahedron","line","pyramid"]},fill:{default:!0,if:{type:["circle"]}},align:{default:"end",oneOf:["start","center","end"]}},init:function(){var e=this,t=this.el;this.children=t.getChildEntities(),this.initialPositions=[],this.children.forEach((function(t){if(t.hasLoaded)return i();function i(){e.initialPositions.push(t.object3D.position.x),e.initialPositions.push(t.object3D.position.y),e.initialPositions.push(t.object3D.position.z)}t.addEventListener("loaded",i)})),this.handleChildAttached=this.handleChildAttached.bind(this),this.handleChildDetached=this.handleChildDetached.bind(this),t.addEventListener("child-attached",this.handleChildAttached),t.addEventListener("child-detached",this.handleChildDetached),t.addEventListener("layoutrefresh",this.update.bind(this))},update:function(e){var i,c,d,u=this.children,f=this.data,m=this.el;switch(c=u.length,f.type){case"box":d=n;break;case"circle":d=o;break;case"cube":d=a;break;case"dodecahedron":d=r;break;case"pyramid":d=l;break;default:d=s}i=m.getDOMAttribute("layout"),t.length=0,t=d(f,c,"string"==typeof i?-1!==i.indexOf("margin"):"margin"in i),f.reverse&&t.reverse(),h(u,t,f.orderAttribute)},remove:function(){this.el.removeEventListener("child-attached",this.handleChildAttached),this.el.removeEventListener("child-detached",this.handleChildDetached),h(this.children,this.initialPositions)},handleChildAttached:function(e){var t=this.el;e.detail.el.parentNode===t&&(this.children.push(e.detail.el),this.update())},handleChildDetached:function(e){-1!==this.children.indexOf(e.detail.el)&&(this.children.splice(this.children.indexOf(e.detail.el),1),this.initialPositions.splice(this.children.indexOf(e.detail.el),1),this.update())}}),e.exports.getBoxPositions=n,e.exports.getCirclePositions=o,e.exports.getLinePositions=s,e.exports.getCubePositions=a,e.exports.getDodecahedronPositions=r,e.exports.getPyramidPositions=l},8146:(e,t,i)=>{i(9779);var n=AFRAME.utils.bind;AFRAME.registerComponent("orbit-controls",{dependencies:["camera"],schema:{autoRotate:{type:"boolean"},autoRotateSpeed:{default:2},dampingFactor:{default:.1},enabled:{default:!0},enableDamping:{default:!0},enableKeys:{default:!0},enablePan:{default:!0},enableRotate:{default:!0},enableZoom:{default:!0},initialPosition:{type:"vec3"},keyPanSpeed:{default:7},minAzimuthAngle:{type:"number",default:-1/0},maxAzimuthAngle:{type:"number",default:1/0},maxDistance:{default:1e3},maxPolarAngle:{default:AFRAME.utils.device.isMobile()?90:120},minDistance:{default:1},minPolarAngle:{default:0},minZoom:{default:0},panSpeed:{default:1},rotateSpeed:{default:.05},screenSpacePanning:{default:!1},target:{type:"vec3"},zoomSpeed:{default:.5}},init:function(){var e=this.el;new THREE.Vector3,this.bindMethods(),e.sceneEl.addEventListener("enter-vr",this.onEnterVR),e.sceneEl.addEventListener("exit-vr",this.onExitVR),document.body.style.cursor="grab",document.addEventListener("mousedown",(()=>{document.body.style.cursor="grabbing"})),document.addEventListener("mouseup",(()=>{document.body.style.cursor="grab"})),this.target=new THREE.Vector3,e.getObject3D("camera").position.copy(this.data.initialPosition)},pause:function(){this.controls.dispose()},play:function(){const e=this.el;this.controls=new THREE.OrbitControls(e.getObject3D("camera"),e.sceneEl.renderer.domElement),this.update()},onEnterVR:function(){var e=this.el;(AFRAME.utils.device.checkHeadsetConnected()||AFRAME.utils.device.isMobile())&&(this.controls.enabled=!1,e.hasAttribute("look-controls")&&(e.setAttribute("look-controls","enabled",!0),oldPosition.copy(e.getObject3D("camera").position),e.getObject3D("camera").position.set(0,0,0)))},onExitVR:function(){var e=this.el;(AFRAME.utils.device.checkHeadsetConnected()||AFRAME.utils.device.isMobile())&&(this.controls.enabled=!0,e.getObject3D("camera").position.copy(oldPosition),e.hasAttribute("look-controls")&&e.setAttribute("look-controls","enabled",!1))},bindMethods:function(){this.onEnterVR=n(this.onEnterVR,this),this.onExitVR=n(this.onExitVR,this)},update:function(e){var t=this.controls,i=this.data;t&&(t.target=this.target.copy(i.target),t.autoRotate=i.autoRotate,t.autoRotateSpeed=i.autoRotateSpeed,t.dampingFactor=i.dampingFactor,t.enabled=i.enabled,t.enableDamping=i.enableDamping,t.enableKeys=i.enableKeys,t.enablePan=i.enablePan,t.enableRotate=i.enableRotate,t.enableZoom=i.enableZoom,t.keyPanSpeed=i.keyPanSpeed,t.maxPolarAngle=THREE.Math.degToRad(i.maxPolarAngle),t.maxAzimuthAngle=THREE.Math.degToRad(i.maxAzimuthAngle),t.maxDistance=i.maxDistance,t.minDistance=i.minDistance,t.minPolarAngle=THREE.Math.degToRad(i.minPolarAngle),t.minAzimuthAngle=THREE.Math.degToRad(i.minAzimuthAngle),t.minZoom=i.minZoom,t.panSpeed=i.panSpeed,t.rotateSpeed=i.rotateSpeed,t.screenSpacePanning=i.screenSpacePanning,t.zoomSpeed=i.zoomSpeed)},tick:function(){var e=this.controls;this.data.enabled&&e.enabled&&(e.enableDamping||e.autoRotate)&&this.controls.update()},remove:function(){this.controls.reset(),this.controls.dispose(),this.el.sceneEl.removeEventListener("enter-vr",this.onEnterVR),this.el.sceneEl.removeEventListener("exit-vr",this.onExitVR)}})},9779:()=>{THREE.OrbitControls=function(e,t){var i,n,o,s,a;this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.target=new THREE.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return m.phi},this.getAzimuthalAngle=function(){return m.theta},this.saveState=function(){r.target0.copy(r.target),r.position0.copy(r.object.position),r.zoom0=r.object.zoom},this.reset=function(){r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(l),r.update(),u=h.NONE},this.update=(i=new THREE.Vector3,n=(new THREE.Quaternion).setFromUnitVectors(e.up,new THREE.Vector3(0,1,0)),o=n.clone().inverse(),s=new THREE.Vector3,a=new THREE.Quaternion,function(){var e=r.object.position;return i.copy(e).sub(r.target),i.applyQuaternion(n),m.setFromVector3(i),r.autoRotate&&u===h.NONE&&M(2*Math.PI/60/60*r.autoRotateSpeed),m.theta+=p.theta,m.phi+=p.phi,m.theta=Math.max(r.minAzimuthAngle,Math.min(r.maxAzimuthAngle,m.theta)),m.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,m.phi)),m.makeSafe(),m.radius*=g,m.radius=Math.max(r.minDistance,Math.min(r.maxDistance,m.radius)),r.target.add(b),i.setFromSpherical(m),i.applyQuaternion(o),e.copy(r.target).add(i),r.object.lookAt(r.target),!0===r.enableDamping?(p.theta*=1-r.dampingFactor,p.phi*=1-r.dampingFactor):p.set(0,0,0),g=1,b.set(0,0,0),!!(y||s.distanceToSquared(r.object.position)>f||8*(1-a.dot(r.object.quaternion))>f)&&(r.dispatchEvent(l),s.copy(r.object.position),a.copy(r.object.quaternion),y=!1,!0)}),this.dispose=function(){r.domElement.removeEventListener("contextmenu",$,!1),r.domElement.removeEventListener("mousedown",H,!1),r.domElement.removeEventListener("wheel",z,!1),r.domElement.removeEventListener("touchstart",U,!1),r.domElement.removeEventListener("touchend",G,!1),r.domElement.removeEventListener("touchmove",V,!1),document.removeEventListener("mousemove",I,!1),document.removeEventListener("mouseup",F,!1),window.removeEventListener("keydown",N,!1)};var r=this,l={type:"change"},c={type:"start"},d={type:"end"},h={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},u=h.NONE,f=1e-6,m=new THREE.Spherical,p=new THREE.Spherical,g=1,b=new THREE.Vector3,y=!1,v=new THREE.Vector2,E=new THREE.Vector2,x=new THREE.Vector2,w=new THREE.Vector2,A=new THREE.Vector2,k=new THREE.Vector2,T=new THREE.Vector2,R=new THREE.Vector2,C=new THREE.Vector2;function S(){return Math.pow(.95,r.zoomSpeed)}function M(e){p.theta-=e}function P(e){p.phi-=e}var D,_=(D=new THREE.Vector3,function(e,t){D.setFromMatrixColumn(t,0),D.multiplyScalar(-e),b.add(D)}),B=function(){var e=new THREE.Vector3;return function(t,i){e.setFromMatrixColumn(i,1),e.multiplyScalar(t),b.add(e)}}(),j=function(){var e=new THREE.Vector3;return function(t,i){var n=r.domElement===document?r.domElement.body:r.domElement;if(r.object.isPerspectiveCamera){var o=r.object.position;e.copy(o).sub(r.target);var s=e.length();s*=Math.tan(r.object.fov/2*Math.PI/180),_(2*t*s/n.clientHeight,r.object.matrix),B(2*i*s/n.clientHeight,r.object.matrix)}else r.object.isOrthographicCamera?(_(t*(r.object.right-r.object.left)/r.object.zoom/n.clientWidth,r.object.matrix),B(i*(r.object.top-r.object.bottom)/r.object.zoom/n.clientHeight,r.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),r.enablePan=!1)}}();function O(e){r.object.isPerspectiveCamera?g/=e:r.object.isOrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom*e)),r.object.updateProjectionMatrix(),y=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function L(e){r.object.isPerspectiveCamera?g*=e:r.object.isOrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/e)),r.object.updateProjectionMatrix(),y=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function H(e){if(!1!==r.enabled){switch(e.preventDefault(),e.button){case r.mouseButtons.ORBIT:if(!1===r.enableRotate)return;!function(e){v.set(e.clientX,e.clientY)}(e),u=h.ROTATE;break;case r.mouseButtons.ZOOM:if(!1===r.enableZoom)return;!function(e){T.set(e.clientX,e.clientY)}(e),u=h.DOLLY;break;case r.mouseButtons.PAN:if(!1===r.enablePan)return;!function(e){w.set(e.clientX,e.clientY)}(e),u=h.PAN}u!==h.NONE&&(document.addEventListener("mousemove",I,!1),document.addEventListener("mouseup",F,!1),r.dispatchEvent(c))}}function I(e){if(!1!==r.enabled)switch(e.preventDefault(),u){case h.ROTATE:if(!1===r.enableRotate)return;!function(e){E.set(e.clientX,e.clientY),x.subVectors(E,v);var t=r.domElement===document?r.domElement.body:r.domElement;M(2*Math.PI*x.x/t.clientWidth*r.rotateSpeed),P(2*Math.PI*x.y/t.clientHeight*r.rotateSpeed),v.copy(E),r.update()}(e);break;case h.DOLLY:if(!1===r.enableZoom)return;!function(e){R.set(e.clientX,e.clientY),C.subVectors(R,T),C.y>0?O(S()):C.y<0&&L(S()),T.copy(R),r.update()}(e);break;case h.PAN:if(!1===r.enablePan)return;!function(e){A.set(e.clientX,e.clientY),k.subVectors(A,w),j(k.x,k.y),w.copy(A),r.update()}(e)}}function F(e){!1!==r.enabled&&(document.removeEventListener("mousemove",I,!1),document.removeEventListener("mouseup",F,!1),r.dispatchEvent(d),u=h.NONE)}function z(e){!1===r.enabled||!1===r.enableZoom||u!==h.NONE&&u!==h.ROTATE||(e.preventDefault(),r.dispatchEvent(c),function(e){e.deltaY<0?L(S()):e.deltaY>0&&O(S()),r.update()}(e),r.dispatchEvent(d))}function N(e){!1!==r.enabled&&!1!==r.enableKeys&&!1!==r.enablePan&&function(e){switch(e.keyCode){case r.keys.UP:j(0,r.keyPanSpeed),r.update();break;case r.keys.BOTTOM:j(0,-r.keyPanSpeed),r.update();break;case r.keys.LEFT:j(r.keyPanSpeed,0),r.update();break;case r.keys.RIGHT:j(-r.keyPanSpeed,0),r.update()}}(e)}function U(e){if(!1!==r.enabled){switch(e.touches.length){case 1:if(!1===r.enableRotate)return;!function(e){v.set(e.touches[0].pageX,e.touches[0].pageY)}(e),u=h.TOUCH_ROTATE;break;case 2:if(!1===r.enableZoom)return;!function(e){var t=e.touches[0].pageX-e.touches[1].pageX,i=e.touches[0].pageY-e.touches[1].pageY,n=Math.sqrt(t*t+i*i);T.set(0,n)}(e),u=h.TOUCH_DOLLY;break;case 3:if(!1===r.enablePan)return;!function(e){w.set(e.touches[0].pageX,e.touches[0].pageY)}(e),u=h.TOUCH_PAN;break;default:u=h.NONE}u!==h.NONE&&r.dispatchEvent(c)}}function V(e){if(!1!==r.enabled)switch(e.preventDefault(),e.touches.length){case 1:if(!1===r.enableRotate)return;if(u!==h.TOUCH_ROTATE)return;!function(e){E.set(e.touches[0].pageX,e.touches[0].pageY),x.subVectors(E,v);var t=r.domElement===document?r.domElement.body:r.domElement;M(2*Math.PI*x.x/t.clientWidth*r.rotateSpeed),P(2*Math.PI*x.y/t.clientHeight*r.rotateSpeed),v.copy(E),r.update()}(e);break;case 2:if(!1===r.enableZoom)return;if(u!==h.TOUCH_DOLLY)return;!function(e){var t=e.touches[0].pageX-e.touches[1].pageX,i=e.touches[0].pageY-e.touches[1].pageY,n=Math.sqrt(t*t+i*i);R.set(0,n),C.subVectors(R,T),C.y>0?L(S()):C.y<0&&O(S()),T.copy(R),r.update()}(e);break;case 3:if(!1===r.enablePan)return;if(u!==h.TOUCH_PAN)return;!function(e){A.set(e.touches[0].pageX,e.touches[0].pageY),k.subVectors(A,w),j(k.x,k.y),w.copy(A),r.update()}(e);break;default:u=h.NONE}}function G(e){!1!==r.enabled&&(r.dispatchEvent(d),u=h.NONE)}function $(e){!1!==r.enabled&&e.preventDefault()}r.domElement.addEventListener("contextmenu",$,!1),r.domElement.addEventListener("mousedown",H,!1),r.domElement.addEventListener("wheel",z,!1),r.domElement.addEventListener("touchstart",U,!1),r.domElement.addEventListener("touchend",G,!1),r.domElement.addEventListener("touchmove",V,!1),window.addEventListener("keydown",N,!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls,Object.defineProperties(THREE.OrbitControls.prototype,{center:{get:function(){return console.warn("THREE.OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(e){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!e}},noRotate:{get:function(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(e){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!e}},noPan:{get:function(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(e){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!e}},noKeys:{get:function(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(e){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!e}},staticMoving:{get:function(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(e){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!e}},dynamicDampingFactor:{get:function(){return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(e){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=e}}})},7571:()=>{AFRAME.registerComponent("proxy-event",{schema:{captureBubbles:{default:!1},enabled:{default:!0},event:{type:"string"},from:{type:"string"},to:{type:"string"},as:{type:"string"},bubbles:{default:!1}},multiple:!0,init:function(){var e,t,i,n=this.data,o=this.el,s=this;if(n.from?e="PARENT"===n.from?[o.parentNode]:document.querySelectorAll(n.from):i="CHILDREN"===n.to?o.querySelectorAll("*"):"SELF"===n.to?[o]:document.querySelectorAll(n.to),n.from)for(t=0;t<e.length;t++)this.addEventListenerFrom(e[t]);else o.addEventListener(n.event,(function(e){var n=s.data;if(n.enabled&&(n.captureBubbles||e.target===o))for(t=0;t<i.length;t++)i[t].emit(n.as||n.event,e.detail?e.detail:null,n.bubbles)}))},addEventListenerFrom:function(e){var t=this.data,i=this;e.addEventListener(t.event,(function(t){var n=i.data;n.enabled&&(n.captureBubbles||t.target===e)&&i.el.emit(n.as||n.event,t.detail?t.detail:null,!1)}))}})},1335:function(e){var t;"undefined"!=typeof self&&self,t=function(){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");AFRAME.registerShader("ring",{schema:{blur:{default:.01,is:"uniform"},color:{type:"color",is:"uniform"},progress:{default:0,is:"uniform"},radiusInner:{default:.6,is:"uniform"},radiusOuter:{default:1,is:"uniform"}},vertexShader:i(1),fragmentShader:i(2)})},function(e,t){e.exports="varying vec2 vUv;\n\nvoid main () {\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n"},function(e,t){e.exports="#extension GL_OES_standard_derivatives : enable\n#define PI 3.14159265358979\nuniform float blur;\nuniform float progress;\nuniform float radiusInner;\nuniform float radiusOuter;\nuniform vec3 color;\n\nvarying vec2 vUv;\n\nvoid main () {\n  // make uvs go from -1 to 1\n  vec2 uv = vec2(vUv.x * 2.0 - 1.0, vUv.y * 2.0 - 1.0);\n  // calculate distance of fragment to center\n  float r = uv.x * uv.x + uv.y * uv.y;\n  // calculate antialias\n  float aa = fwidth(r);\n  // make full circle (radiusOuter - radiusInner)\n  float col = (1.0 - smoothstep(radiusOuter - aa, radiusOuter + blur + aa, r)) * smoothstep(radiusInner - aa, radiusInner + blur + aa, r);\n  // radial gradient\n  float a = smoothstep(-PI-aa, PI+aa, atan(uv.y, uv.x));\n  // progress angle\n  float p = 1.0 - progress - blur;\n  // apply progress to full circle (1 for done part, 0 for part to go)\n  col *= smoothstep(p, p + blur, a);\n  // multiply by user color\n  gl_FragColor = vec4(color * col, col);\n}\n"}])},e.exports=t()},1479:()=>{if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");AFRAME.registerComponent("slice9",{schema:{width:{default:1,min:0},height:{default:1,min:0},left:{default:0,min:0},right:{default:0,min:0},bottom:{default:0,min:0},top:{default:0,min:0},side:{default:"front",oneOf:["front","back","double"]},padding:{default:.1,min:.01},color:{type:"color",default:"#fff"},opacity:{default:1,min:0,max:1},transparent:{default:!0},debug:{default:!1},src:{type:"map"}},multiple:!1,init:function(){var e=this.data,t=this.material=new THREE.MeshBasicMaterial({color:e.color,opacity:e.opacity,transparent:e.transparent,wireframe:e.debug}),i=this.geometry=new THREE.PlaneBufferGeometry(e.width,e.height,3,3);new THREE.TextureLoader,this.plane=new THREE.Mesh(i,t),this.el.setObject3D("mesh",this.plane),this.textureSrc=null},updateMap:function(){var e=this.data.src;if(e){if(e===this.textureSrc)return;return this.textureSrc=e,void this.el.sceneEl.systems.material.loadTexture(e,{src:e},t.bind(this))}function t(e){this.material.map=e,this.material.needsUpdate=!0,this.regenerateMesh()}this.material.map&&t(null)},regenerateMesh:function(){var e=this.data,t=this.geometry.attributes.position.array,i=this.geometry.attributes.uv.array,n=this.material.map.image;if(n){var o={left:e.left/n.width,right:e.right/n.width,top:e.top/n.height,bottom:e.bottom/n.height};u(1,o.left,1),u(2,o.right,1),u(4,0,o.bottom),u(5,o.left,o.bottom),u(6,o.right,o.bottom),u(7,1,o.bottom),u(8,0,o.top),u(9,o.left,o.top),u(10,o.right,o.top),u(11,1,o.top),u(13,o.left,0),u(14,o.right,0);var s=e.width/2,a=e.height/2,r=-s+e.padding,l=s-e.padding,c=a-e.padding,d=-a+e.padding;h(0,-s,a),h(1,r,a),h(2,l,a),h(3,s,a),h(4,-s,c),h(5,r,c),h(6,l,c),h(7,s,c),h(8,-s,d),h(9,r,d),h(10,l,d),h(11,s,d),h(13,r,-a),h(14,l,-a),h(12,-s,-a),h(15,s,-a),this.geometry.attributes.position.needsUpdate=!0,this.geometry.attributes.uv.needsUpdate=!0}function h(e,i,n){t[3*e]=i,t[3*e+1]=n}function u(e,t,n){i[2*e]=t,i[2*e+1]=n}},update:function(e){var t=this.data;this.material.color.setStyle(t.color),this.material.opacity=t.opacity,this.material.transparent=t.transparent,this.material.wireframe=t.debug,this.material.side=function(e){switch(e){case"back":return THREE.BackSide;case"double":return THREE.DoubleSide;default:return THREE.FrontSide}}(t.side);var i=AFRAME.utils.diff(t,e);"src"in i?this.updateMap():("width"in i||"height"in i||"padding"in i||"left"in i||"top"in i||"bottom"in i||"right"in i)&&this.regenerateMesh()},remove:function(){},pause:function(){},play:function(){}})},2596:function(e){var t;"undefined"!=typeof self&&self,t=function(){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=1)}([function(e,t,i){"use strict";var n={};e.exports.select=function(e,t,i){return n[t]||(n[t]=new Function("state","item","return "+l(t)+";")),n[t](e,i)};var o=/\.([A-Za-z][\w_-]*)/g,s=/([=&|!?:+-])(\s*)([\(]?)([A-Za-z][\w_-]*)/g,a=/^([\(]?)([A-Za-z][\w_-]*)/g,r=/state\["item"\]/g;function l(e){return(e=(e=(e=e.replace(o,'["$1"]')).replace(a,'$1state["$2"]')).replace(s,'$1$2$3state["$4"]')).replace(r,"item")}function c(){var e=arguments;return function(){var t;for(t=0;t<e.length;t++)e[t].apply(this,arguments)}}e.exports.generateExpression=l,e.exports.clearObject=function(e){for(var t in e)delete e[t]},e.exports.composeHandlers=function(){var e,t,i,n=arguments;for(i={},t=0;t<n.length;t++)for(e in n[t])e in i?i[e].constructor===Array?i[e].push(n[t][e]):i[e]=[i[e],n[t][e]]:i[e]=n[t][e];for(e in i)i[e].constructor===Array&&(i[e]=c.apply(this,i[e]));return i},e.exports.composeFunctions=c;var d=["||","&&","!=","!==","==","===",">","<","<=",">="],h=/\s+/,u=/\(|\)|\!/g;function f(e){return-1===(e=function(e){return 0===e.indexOf("!!")?e.replace("!!",""):0===e.indexOf("!")?e.replace("!",""):e}(e.trim())).indexOf(".")?e:e.substring(0,e.indexOf("."))}e.exports.parseKeysToWatch=function(e,t,i){var n,o;for(o=p(t,h),n=0;n<o.length;n++)if(-1===d.indexOf(o[n])&&!o[n].startsWith("'")&&-1===e.indexOf(o[n])){if(i&&"item"===o[n])continue;e.push(f(o[n]).replace(u,""))}return e};var m={};function p(e,t){return m[t]||(m[t]={}),m[t][e]||(m[t][e]=e.split(t)),m[t][e]}e.exports.split=p,e.exports.copyArray=function(e,t){var i;for(e.length=0,i=0;i<t.length;i++)e[i]=t[i]}},function(e,t,i){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};i(2);var o,s,a=i(3),r=i(0),l=i(4).wrapArray,c={initialState:{},nonBindedStateKeys:[],handlers:{},computeState:function(){}},d="object";AFRAME.registerState=function(e){AFRAME.utils.extendDeep(c,e)},AFRAME.registerSystem("state",{init:function(){var e,t=this;for(e in this.arrays=[],this.dirtyArrays=[],this.diff={},this.state=AFRAME.utils.clone(c.initialState),this.subscriptions=[],this.initEventHandlers(),this.state)this.state[e]&&this.state[e].constructor===Array&&(this.arrays.push(e),this.state[e].__dirty=!0,l(this.state[e]));this.lastState=AFRAME.utils.clone(this.state),this.eventDetail={lastState:this.lastState,state:this.state},this.el.addEventListener("loaded",(function(){var e;for(c.computeState(t.state,"@@INIT"),e=0;e<t.subscriptions.length;e++)t.subscriptions[e].onStateUpdate(t.state)}))},dispatch:(s=[],function(e,t){var i,n;for(n in c.handlers[e](this.state,t),c.computeState(this.state,e,t),this.diff)delete this.diff[n];for(a(this.lastState,this.state,this.diff,c.nonBindedStateKeys),this.dirtyArrays.length=0,i=0;i<this.arrays.length;i++)this.state[this.arrays[i]].__dirty&&this.dirtyArrays.push(this.arrays[i]);for(s.length=0,i=0;i<this.subscriptions.length;i++){if("bind-for"===this.subscriptions[i].name){if(!this.state[this.subscriptions[i].keysToWatch[0]].__dirty)continue}else if(!this.shouldUpdate(this.subscriptions[i].keysToWatch,this.diff,this.dirtyArrays))continue;-1===s.indexOf(this.subscriptions[i])&&s.push(this.subscriptions[i])}for(i=0;i<s.length;i++)s[i].onStateUpdate();for(n in this.state)this.state[n]&&this.state[n].constructor===Array&&(this.state[n].__dirty=!1);this.copyState(this.lastState,this.state),this.eventDetail.action=e,this.eventDetail.payload=t,this.el.emit("stateupdate",this.eventDetail)}),copyState:function(e,t,i){var n;for(n in t)if(i||-1===c.nonBindedStateKeys.indexOf(n))if(t[n]&&t[n].constructor===Object){if(!(n in e)){e[n]=AFRAME.utils.clone(t[n]);continue}this.copyState(e[n],t[n],!0)}else e[n]=t[n]},subscribe:function(e){this.subscriptions.push(e)},unsubscribe:function(e){this.subscriptions.splice(this.subscriptions.indexOf(e),1)},shouldUpdate:function(e,t,i){for(var n=0;n<e.length;n++)if(e[n]in t||-1!==i.indexOf(e[n]))return!0;return!1},initEventHandlers:function(){var e,t=[];for(e in i=i.bind(this),c.handlers)-1===t.indexOf(e)&&(t.push(e),i(e));function i(e){var t=this;this.el.addEventListener(e,(function(i){t.dispatch(e,i.detail)}))}},renderTemplate:(o=/{{\s*(\w*\.)?([\w.]+)\s*}}/g,function(e,t,i){var s,a;if(a=e,t)for(;s=o.exec(e);)a=a.replace(s[0],(void 0===t?"undefined":n(t))===d?r.select(t,s[2])||"":t);return i?a:document.createRange().createContextualFragment(a)}),select:r.select}),AFRAME.registerComponent("bind",{schema:{default:{},parse:function(e){var t,i,n,o;if(e.constructor===Object)return e;if(-1===e.indexOf(":"))return e;for(t={},n=r.split(e,";"),i=0;i<n.length;i++)t[(o=r.split(n[i].trim(),":"))[0]]=o[1].trim();return t}},multiple:!0,init:function(){var e;this.data,this.keysToWatch=[],this.onStateUpdate=this.onStateUpdate.bind(this),this.system=this.el.sceneEl.systems.state,this.id&&(e=r.split(this.id,"__")[0]),this.isNamespacedBind=this.id&&e in AFRAME.components&&!AFRAME.components[e].isSingleProp||e in AFRAME.systems,this.lastData={},this.updateObj={},this.system.subscribe(this),this.onStateUpdate=this.onStateUpdate.bind(this)},update:function(){var e,t=this.data;if(this.keysToWatch.length=0,"string"==typeof t)r.parseKeysToWatch(this.keysToWatch,t);else for(e in t)r.parseKeysToWatch(this.keysToWatch,t[e]);this.onStateUpdate()},onStateUpdate:function(){var e,t,i,o,s=!1,a=this.el;if(a.parentNode){if(this.isNamespacedBind&&r.clearObject(this.updateObj),i=this.system.state,n(this.data)!==d){try{o=r.select(i,this.data)}catch(e){throw new Error("[aframe-state-component] Key '"+this.data+"' not found in state. #"+this.el.getAttribute("id")+"["+this.attrName+"]")}if((void 0===o?"undefined":n(o))!==d&&n(this.lastData)!==d&&this.lastData===o)return;return AFRAME.utils.entity.setComponentProperty(a,this.id,o),void(this.lastData=o)}for(e in this.data){t=this.data[e].trim();try{o=r.select(i,t)}catch(e){throw console.log(e),new Error("[aframe-state-component] Key '"+t+"' not found in state. #"+this.el.getAttribute("id")+"["+this.attrName+"]")}if((void 0===o?"undefined":n(o))===d||n(this.lastData[e])===d||this.lastData[e]!==o){if(e in AFRAME.components&&void 0===o)return void a.removeAttribute(e);this.isNamespacedBind?this.updateObj[e]=o:AFRAME.utils.entity.setComponentProperty(a,e,o),this.lastData[e]=o}}for(s in this.updateObj);this.isNamespacedBind&&s&&a.setAttribute(this.id,this.updateObj)}},remove:function(){this.system.unsubscribe(this)}}),AFRAME.registerComponent("bind-toggle",{schema:{type:"string"},multiple:!0,init:function(){this.system=this.el.sceneEl.systems.state,this.keysToWatch=[],this.onStateUpdate=this.onStateUpdate.bind(this),this.system.subscribe(this),this.onStateUpdate()},update:function(){this.keysToWatch.length=0,r.parseKeysToWatch(this.keysToWatch,this.data)},onStateUpdate:function(){var e,t,i=this.el;e=this.system.state;try{t=r.select(e,this.data)}catch(e){throw new Error("[aframe-state-component] Key '"+this.data+"' not found in state. #"+this.el.getAttribute("id")+"["+this.attrName+"]")}t?i.setAttribute(this.id,""):i.removeAttribute(this.id)},remove:function(){this.system.unsubscribe(this)}}),e.exports={composeFunctions:r.composeFunctions,composeHandlers:r.composeHandlers,select:r.select}},function(e,t,i){"use strict";var n,o,s=i(0);AFRAME.registerComponent("bind-for",{schema:{delay:{default:0},for:{type:"string",default:"item"},in:{type:"string"},key:{type:"string"},pool:{default:0},template:{type:"string"},updateInPlace:{default:!1}},init:function(){this.system=this.el.sceneEl.systems.state,this.onStateUpdate=this.onStateUpdate.bind(this),this.keysToWatch=[],this.renderedKeys=[],this.system.subscribe(this),this.el.children[0]&&"TEMPLATE"===this.el.children[0].tagName?this.template=this.el.children[0].innerHTML.trim():this.template=document.querySelector(this.data.template).innerHTML.trim();for(var e=0;e<this.data.pool;e++)this.el.appendChild(this.generateFromTemplate(null,e))},update:function(){this.keysToWatch[0]=s.split(this.data.in,".")[0],this.onStateUpdate()},onStateUpdateNaive:(o=[],function(){var e,t=this.data,i=this.el;try{e=s.select(this.system.state,t.in)}catch(e){throw new Error("[aframe-state-component] Key '"+t.in+"' not found in state. #"+i.getAttribute("id")+"["+this.attrName+"]")}o.length=0;for(var n=0;n<e.length;n++){var a=e[n];o.push(t.key?a[t.key].toString():a.toString())}for(var r=this.getElsToRemove(o,this.renderedKeys),l=0;l<r.length;l++)r[l].parentNode.removeChild(r[l]);e.length&&this.renderItems(e,o,0)}),renderItems:function(e,t,i){var n,o=this,s=this.data,a=this.el,r=e[i],l=s.key?r[s.key].toString():r.toString();if(-1===this.renderedKeys.indexOf(l))n=this.generateFromTemplate(r,i),a.appendChild(n),this.renderedKeys.push(l);else{if(e.length&&e[0].constructor===String){var c=s.key?r[s.key].toString():r.toString();(n=a.querySelector('[data-bind-for-value="'+c+'"]')).setAttribute("data-bind-for-key",i)}else{var d=this.getBindForKey(r,i);n=a.querySelector('[data-bind-for-key="'+d+'"]')}n.emit("bindforupdate",r,!1)}e[i+1]&&(this.data.delay?setTimeout((function(){o.renderItems(e,t,i+1)}),this.data.delay):this.renderItems(e,t,i+1))},onStateUpdateInPlace:function(){var e=[];return function(){var t,i,n=this.data,o=this.el;try{t=s.select(this.system.state,n.in)}catch(e){throw console.log(e),new Error("[aframe-state-component] Key '"+n.in+"' not found in state. #"+o.getAttribute("id")+"["+this.attrName+"]")}e.length=0;for(var a=0;a<t.length;a++){var r=t[a];i=n.key?r[n.key].toString():r.toString(),e.push(i)}for(var l=this.getElsToRemove(e,this.renderedKeys),c=0;c<l.length;c++)l[c].object3D.visible=!1,l[c].setAttribute("data-bind-for-active","false"),l[c].removeAttribute("data-bind-for-key"),l[c].removeAttribute("data-bind-for-value"),l[c].emit("bindfordeactivate",null,!1),l[c].pause();t.length&&this.renderItemsInPlace(t,e,0)}}(),renderItemsInPlace:function(e,t,i){var n,o=this,s=this.data,a=this.el,r=e[i],l=this.getBindForKey(r,i),c=s.key?r[s.key].toString():r.toString();if(-1===this.renderedKeys.indexOf(c)){if(a.querySelector(':scope > [data-bind-for-active="false"]'))(n=a.querySelector('[data-bind-for-active="false"]')).setAttribute("data-bind-for-key",l),n.setAttribute("data-bind-for-value",c),n.object3D.visible=!0,n.play(),n.setAttribute("data-bind-for-active","true"),n.emit("bindforupdateinplace",r,!1);else{var d=this.generateFromTemplate(r,i);d.addEventListener("loaded",(function(){d.emit("bindforupdateinplace",r,!1)})),a.appendChild(d)}this.renderedKeys.push(c)}else-1!==t.indexOf(c)&&(e.length&&e[0].constructor===String?(n=a.querySelector('[data-bind-for-value="'+c+'"]')).setAttribute("data-bind-for-key",i):n=a.querySelector('[data-bind-for-key="'+l+'"]'),n.emit("bindforupdateinplace",r,!1));e[i+1]&&(this.data.delay?setTimeout((function(){o.renderItemsInPlace(e,t,i+1)}),this.data.delay):this.renderItemsInPlace(e,t,i+1))},generateFromTemplate:function(e,t){var i=this.data;this.el.appendChild(this.system.renderTemplate(this.template,e));var n=this.el.children[this.el.children.length-1];if(!e)return n.setAttribute("data-bind-for-key",""),n.setAttribute("data-bind-for-active","false"),n;var o=this.getBindForKey(e,t);return n.setAttribute("data-bind-for-key",o),i.key||n.setAttribute("data-bind-for-value",e),n.setAttribute("data-bind-for-active","true"),n},getElsToRemove:(n=[],function(e,t){var i=this.data,o=this.el;n.length=0;for(var s=0;s<o.children.length;s++)if("TEMPLATE"!==o.children[s].tagName){var a=i.key?o.children[s].getAttribute("data-bind-for-key"):o.children[s].getAttribute("data-bind-for-value");-1===e.indexOf(a)&&-1!==t.indexOf(a)&&(n.push(o.children[s]),t.splice(t.indexOf(a),1))}return n}),getBindForKey:function(e,t){return this.data.key?e[this.data.key].toString():t.toString()},onStateUpdate:function(){this.data.updateInPlace?this.onStateUpdateInPlace():this.onStateUpdateNaive()}}),AFRAME.registerComponent("bind-item",{schema:{type:"string"},multiple:!0,init:function(){this.itemData=null,this.keysToWatch=[],this.prevValues={};var e=this.rootEl=this.el.closest("[data-bind-for-key]");if(!e)throw new Error("bind-item component must be attached to entity under a bind-for item.");e.addEventListener("bindforupdateinplace",this.updateInPlace.bind(this)),e.addEventListener("bindfordeactivate",this.deactivate.bind(this)),this.el.sceneEl.systems.state.subscribe(this)},update:function(){this.parseSelector()},updateInPlace:function(e){var t=this.propertyMap;if("false"!==this.rootEl.getAttribute("data-bind-for-active"))for(var i in e&&(this.itemData=e.detail),t){var n=this.select(this.itemData,t[i]);n!==this.prevValues[i]&&(AFRAME.utils.entity.setComponentProperty(this.el,i,n),this.prevValues[i]=n)}},onStateUpdate:function(){this.updateInPlace()},select:function(e,t){return s.select(this.el.sceneEl.systems.state.state,t,e)},deactivate:function(){this.prevValues={}},parseSelector:function(){var e=this.propertyMap={};this.keysToWatch.length=0;var t=s.split(this.id,"__")[0];if(!(t in AFRAME.components)||AFRAME.components[t].isSingleProp)e[this.id]=this.data,s.parseKeysToWatch(this.keysToWatch,this.data,!0);else for(var i=s.split(this.data,";"),n=0;n<i.length;n++){var o=s.split(i[n],":");e[this.id+"."+o[0].trim()]=o[1].trim(),s.parseKeysToWatch(this.keysToWatch,o[1].trim(),!0)}}})},function(e,t,i){"use strict";var n;e.exports=(n=[],function(e,t,i,o){var s,a,r,l,c,d,h;for(c in l=i||{},n.length=0,e)n.push(c);if(!t)return l;for(r in t)-1===n.indexOf(r)&&n.push(r);for(d=0;d<n.length;d++)c=n[d],o&&-1!==o.indexOf(c)||(s=e[c],a=t[c],((h=s&&a&&s.constructor===Object&&a.constructor===Object)&&!AFRAME.utils.deepEqual(s,a)||!h&&s!==a)&&(l[c]=a));return l})},function(e,t,i){"use strict";var n=["push","pop","shift","unshift","splice"];function o(e,t){var i=e[t];e[t]=function(){i.apply(e,arguments),e.__dirty=!0}}e.exports.wrapArray=function(e){var t;if(!e.__wrapped){for(t=0;t<n.length;t++)o(e,n[t]);e.__wrapped=!0}}}])},e.exports=t()},4440:()=>{var e="STICK",t=[0,90,180,270],i=["right","up","left","down"],n={NULL:{START:"thumbstart",END:"thumbend"}};i.forEach((e=>{n[e]={},n[e].START="thumb"+e+"start",n[e].END="thumb"+e+"end"}));var o=240;AFRAME.registerComponent("thumb-controls",{dependencies:["tracked-controls"],schema:{thresholdAngle:{default:89.5},thresholdPad:{default:.05},thresholdStick:{default:.75}},init:function(){var t=this.el;this.onTrackpadDown=this.onTrackpadDown.bind(this),this.onTrackpadUp=this.onTrackpadUp.bind(this),this.directionStick="",this.directionTrackpad="",this.type=e,t.addEventListener("controllerconnected",(t=>{"oculus-touch-controls"!==t.detail.name&&"windows-motion-controls"!==t.detail.name?this.type="PAD":this.type=e})),this.axis=t.components["tracked-controls"].axis},play:function(){var e=this.el;e.addEventListener("trackpaddown",this.onTrackpadDown),e.addEventListener("trackpadup",this.onTrackpadUp)},pause:function(){var e=this.el;e.removeEventListener("trackpaddown",this.onTrackpadDown),e.removeEventListener("trackpadup",this.onTrackpadUp)},onTrackpadDown:function(){var e,t=this.el;this.getDistance()<this.data.thresholdPad||(e=this.getDirection())&&(this.directionTrackpad=e,t.emit(n.NULL.START,null,!1),t.emit(n[this.directionTrackpad].START,null,!1))},onTrackpadUp:function(){var e=this.el;this.directionTrackpad&&(e.emit(n.NULL.END,null,!1),e.emit(n[this.directionTrackpad].END,null,!1),this.directionTrackpad="")},tick:function(){var e,t=this.el;if("PAD"!==this.type){if(!this.directionStick&&this.getDistance()>this.data.thresholdStick){if(!(e=this.getDirection()))return;return this.directionStick=e,t.emit(n.NULL.START,null,!1),void t.emit(n[this.directionStick].START,null,!1)}this.directionStick&&this.getDistance()<this.data.thresholdStick&&(t.emit(n.NULL.END,null,!1),t.emit(n[this.directionStick].END,null,!1),this.directionStick="")}},getDistance:function(){var e=this.axis;return Math.sqrt(e[1]*e[1]+e[0]*e[0])},getDirection:function(){var e,n,o,s,a;for(e=this.getAngle(),s=this.data.thresholdAngle/2,o=0;o<t.length;o++){if((a=t[o]+s)>360&&(a-=360),(n=t[o]-s)<0&&(e>=360+n&&e<=360||e>=0&&e<=a))return i[o];if(e>=n&&e<=a)return i[o]}},getAngle:function(){var t,i,n=this.axis;return i=this.type===e?-1:1,(t=Math.atan2(n[1]*i,n[0]))<0&&(t=2*Math.PI+t),THREE.Math.radToDeg(t)}}),AFRAME.registerComponent("thumb-controls-debug",{dependencies:["thumb-controls","tracked-controls"],schema:{controllerType:{type:"string"},hand:{type:"string"},enabled:{default:!1}},init:function(){var e,t,i,n,s=this.el;(this.data.enabled||AFRAME.utils.getUrlParameter("debug-thumb"))&&(console.log("%c debug-thumb","background: #111; color: red"),s.components["tracked-controls"].handleAxes=()=>{},i={axis:t=[0,0,0]},s.components["tracked-controls"].axis=t,s.components["thumb-controls"].axis=t,(n=this.createCanvas()).addEventListener("click",(n=>{"vive-controls"===this.data.controllerType?e?s.emit("trackpadup"):s.emit("trackpaddown"):e&&(t[0]=0,t[1]=0,s.emit("axismove",i,!1)),e=!e})),n.addEventListener("mousemove",(a=>{var r;e&&(r=n.getBoundingClientRect(),t[0]=(a.clientX-r.left)/o*2-1,t[1]=(a.clientY-r.top)/o*2-1,s.emit("axismove",i,!1))})),n.addEventListener("mouseleave",(n=>{e&&(t[0]=0,t[1]=0,s.emit("axismove",i,!1))})))},createCanvas:function(){var e,t;return(e=document.createElement("canvas")).classList.add("debugThumb"),e.height=o,e.width=o,e.style.bottom=0,e.style.borderRadius="250px",e.style.opacity=.5,e.style.position="fixed",e.style.zIndex=999999999,"left"===this.data.hand?e.style.left=0:e.style.right=0,(t=e.getContext("2d")).fillStyle="#333",t.fillRect(0,0,o,o),document.body.appendChild(e),e}})},1440:e=>{e.exports={vertexShader:"\n    varying vec2 uvs;\n    void main() {\n      uvs.xy = uv.xy;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n    }\n  ",fragmentShader:"\n    varying vec2 uvs;\n    uniform sampler2D src;\n\n    void main() {\n      gl_FragColor = texture2D(src, uvs);\n    }\n"}},4490:e=>{e.exports={vertexShader:"\n    varying vec2 uvs;\n    varying vec3 worldPos;\n    void main() {\n      uvs.xy = uv.xy;\n      vec4 p = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n      worldPos = (modelMatrix * vec4( position, 1.0 )).xyz;\n      gl_Position = p;\n    }\n  ",fragmentShader:"\n    varying vec2 uvs;\n    varying vec3 worldPos;\n    uniform vec3 tunnelNeon;\n    uniform vec3 leftLaser;\n    uniform vec3 rightLaser;\n    uniform vec3 floorNeon;\n    uniform vec3 textGlow;\n    uniform sampler2D src;\n\n    void main() {\n      float mask;\n      vec4 col = texture2D(src, uvs);\n\n      // tunnel neon\n      mask = step(0.87, uvs.x) *  step(0.5, uvs.y) * (1.0 - step(0.935, uvs.x)) * ( 1.0 - step(0.75, uvs.y));\n      col.xyz = mix(col.xyz, col.xyz * tunnelNeon, mask);\n\n      // floor & corridor neons\n      mask = step(0.935, uvs.x) * step(0.5, uvs.y) * ( 1.0 - step(0.75, uvs.y));\n      col.xyz = mix(col.xyz, col.xyz * floorNeon, mask);\n\n      // left laser\n      mask = step(0.5, uvs.x) * (1.0 - step(0.625, uvs.x)) * (1.0 - step(0.5, uvs.y));\n      col.xyz = mix(col.xyz, col.xyz * leftLaser, mask);\n\n      // right laser\n      mask = step(0.625, uvs.x) * (1.0 - step(0.75, uvs.x)) * (1.0 - step(0.5, uvs.y));\n      col.xyz = mix(col.xyz, col.xyz * rightLaser, mask);\n\n      // text glows\n      mask = step(0.87, uvs.x) *  step(0.25, uvs.y) * (1.0 - step(0.935, uvs.x)) * ( 1.0 - step(0.5, uvs.y));\n      col.xyz = mix(col.xyz, col.xyz * textGlow, mask);\n\n      gl_FragColor = col;\n    }\n  "}},6061:e=>{e.exports={vertexShader:"\n    varying vec2 uvs;\n    varying vec3 worldPos;\n    void main() {\n      uvs.xy = uv.xy;\n      vec4 p = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n      worldPos = (modelMatrix * vec4( position, 1.0 )).xyz;\n      gl_Position = p;\n    }\n  ",fragmentShader:"\n    #define FOG_RADIUS  55.0\n    #define FOG_FALLOFF 48.0\n    #define FOG_COLOR_MULT 0.8\n    varying vec2 uvs;\n    varying vec3 worldPos;\n    uniform vec3 skyColor;\n    uniform vec3 backglowColor;\n    uniform sampler2D src;\n\n    void main() {\n      vec4 col = texture2D(src, uvs);\n      float mask;\n\n      // bg\n      mask = step(0.5, uvs.x);\n      col.xyz = mix(col.xyz * skyColor, col.xyz, mask);\n\n      // backglow\n      mask = step(0.5, uvs.x) * step(0.5, uvs.y) * (1.0 - step(0.75, uvs.x));\n      col.xyz = mix(col.xyz, col.xyz * backglowColor, mask);\n\n      float fogDensity = 1.0 - pow(clamp(distance(worldPos, vec3(0., 0., -FOG_RADIUS)) / FOG_FALLOFF, 0.0, 1.0), 1.5);\n      fogDensity += clamp(0.2 - pow(distance(worldPos, vec3(0.0, 0.0, worldPos.z)) / 10.0, 2.0), 0.0, 1.0);\n      col.xyz = mix(col.xyz, backglowColor * FOG_COLOR_MULT, fogDensity);\n\n      gl_FragColor = col;\n    }\n  "}},7018:()=>{AFRAME.registerComponent("active-color",{dependencies:["material"],schema:{active:{default:!1},color:{default:"#ffffff"}},init:function(){this.defaultColor=this.el.getAttribute("material").color,this.materialObj={color:this.data.color,opacity:1}},update:function(){var e=this.el;this.data.active?(e.setAttribute("material",this.materialObj),e.object3D.visible=!0):(e.setAttribute("material","color",this.defaultColor),e.components.animation__mouseleave&&setTimeout((()=>{e.emit("mouseleave",null,!1)})))}}),AFRAME.registerComponent("active-text-color",{dependencies:["text"],schema:{active:{default:!1},color:{default:"#333"}},init:function(){this.defaultColor=this.el.getAttribute("text").color},update:function(){var e=this.el;this.data.active?e.setAttribute("text","color",this.data.color):e.setAttribute("text","color",this.defaultColor)}})},5405:()=>{AFRAME.registerComponent("audio-columns",{schema:{analyser:{type:"selector",default:"#audioAnalyser"},height:{default:1},mirror:{default:3},scale:{default:4},separation:{default:.3},thickness:{default:.1}},init:function(){var e=document.getElementById("audiocolumnObj").data,t=(new THREE.OBJLoader).parse(e).children[0].geometry;this.analyser=this.data.analyser.components.audioanalyser,this.frequencyBinCount=this.analyser.data.fftSize/2;const i=[];let n=0;for(let e=0;e<this.frequencyBinCount;e++)for(let e=0;e<2;e++){const o=t.clone();this.initBox(o,0===e?1:-1,n),i.push(o),n-=this.data.separation}this.geometry=THREE.BufferGeometryUtils.mergeBufferGeometries(i);const o=new THREE.Mesh(this.geometry,this.el.sceneEl.systems.materials.stageNormal);this.el.setObject3D("mesh",o)},tick:function(){for(let e=0;e<2*this.frequencyBinCount;e+=2){let t=this.data.height/2+this.analyser.levels[Math.floor(e/2)]/256*this.data.scale;if(isNaN(t))return;this.setBoxHeight(2*this.frequencyBinCount-e-1,t),this.setBoxHeight(2*this.frequencyBinCount-e-2,t),this.geometry.attributes.position.needsUpdate=!0}},initBox:function(e,t,i){const n=this.data;for(let o=0;o<e.attributes.position.array.length;o+=3)e.attributes.position.array[o+2]+=i,e.attributes.position.array[o+1]*=n.height/2,e.attributes.position.array[o]+=t*n.mirror},setBoxHeight:function(e,t){const i=90*e;for(let e=i;e<i+90;e+=3){let i=this.geometry.attributes.position.array[e+1];this.geometry.attributes.position.array[e+1]=i>=0?t:-1*t}}})},9034:()=>{const e=AFRAME.ANIME||AFRAME.anime;AFRAME.registerComponent("beams",{schema:{isPlaying:{default:!1},poolSize:{default:3}},init:function(){this.beams=[],this.currentRed=0,this.currentBlue=0,this.clearBeams=this.clearBeams.bind(this),this.el.sceneEl.addEventListener("cleargame",this.clearBeams)},update:function(){for(let e=0;e<this.beams.length;e++)this.beams[e].time&&(this.beams[e].visible=this.data.isPlaying)},play:function(){var e,t,i,n=new THREE.OBJLoader;e=document.getElementById("redbeamObj").data,t=n.parse(e).children[0].geometry,e=document.getElementById("bluebeamObj").data,i=n.parse(e).children[0].geometry,this.redBeams=this.createBeamPool(t,this.el.sceneEl.systems.materials.stageAdditive),this.blueBeams=this.createBeamPool(i,this.el.sceneEl.systems.materials.stageAdditive)},tick:function(e,t){if(this.data.isPlaying)for(let e=0;e<this.beams.length;e++){let i=this.beams[e];i.visible&&(i.time+=t,i.animation.tick(i.time))}},createBeamPool:function(t,i){const n=[];for(let o=0;o<this.data.poolSize;o++){let o=new THREE.Mesh(t,i);o.visible=!1,o.animation=e({autoplay:!1,targets:o.scale,x:1e-5,duration:300,easing:"easeInCubic",complete:()=>{o.visible=!1}}),this.el.object3D.add(o),n.push(o),this.beams.push(o)}return n},newBeam:function(e,t){var i;"red"===e?(i=this.redBeams[this.currentRed],this.currentRed=(this.currentRed+1)%this.redBeams.length,i.position.set(t.x,t.y,t.z+this.currentRed/50)):(i=this.blueBeams[this.currentBlue],this.currentBlue=(this.currentBlue+1)%this.blueBeams.length,i.position.set(t.x,t.y,t.z+this.currentBlue/50)),i.visible=!0,i.scale.x=1,i.time=0},clearBeams:function(){for(let e=0;e<this.beams.length;e++)this.beams[e].visible=!1,this.beams[e].time=0,this.beams[e].scale.x=1}})},3168:(e,t,i)=>{"use strict";i.r(t);var n=i(5501);i(9853);let o=AFRAME.utils.getUrlParameter("skip")||0;function s(e,t){return e._time-t._time}o=parseInt(o,10),AFRAME.registerComponent("beat-generator",{dependencies:["stage-colors"],schema:{beatAnticipationTime:{default:1.1},beatSpeed:{default:8},beatWarmupTime:{default:n.Md/1e3},beatWarmupSpeed:{default:n.G},difficulty:{type:"string"},isPlaying:{default:!1}},orientationsHumanized:["up","down","left","right","upleft","upright","downleft","downright"],horizontalPositions:[-.75,-.25,.25,.75],horizontalPositionsHumanized:{0:"left",1:"middleleft",2:"middleright",3:"right"},positionHumanized:{topLeft:{layer:2,index:0},topCenterLeft:{layer:2,index:1},topCenterRight:{layer:2,index:2},topRight:{layer:2,index:3},middleLeft:{layer:1,index:0},middleCenterLeft:{layer:1,index:1},middleCenterRight:{layer:1,index:2},middleRight:{layer:1,index:3},bottomLeft:{layer:0,index:0},bottomCenterLeft:{layer:0,index:1},bottomCenterRight:{layer:0,index:2},bottomRight:{layer:0,index:3}},verticalPositionsHumanized:{0:"bottom",1:"middle",2:"top"},init:function(){this.audioAnalyserEl=document.getElementById("audioanalyser"),this.beatData=null,this.beatDataProcessed=!1,this.beatContainer=document.getElementById("beatContainer"),this.beatsTime=void 0,this.beatsPreloadTime=0,this.beatsPreloadTimeTotal=1e3*(this.data.beatAnticipationTime+this.data.beatWarmupTime),this.bpm=void 0,this.stageColors=this.el.components["stage-colors"],this.swordOffset=1.5,this.twister=document.getElementById("twister"),this.leftStageLasers=document.getElementById("leftStageLasers"),this.rightStageLasers=document.getElementById("rightStageLasers"),this.el.addEventListener("cleargame",this.clearBeats.bind(this)),this.el.addEventListener("challengeloadend",(e=>{this.allBeatData=e.detail.beats,this.beatData=e.detail.beats[this.data.difficulty||e.detail.difficulty],this.info=e.detail.info,this.processBeats()}))},update:function(e){e.difficulty&&e.difficulty!==this.data.difficulty&&this.allBeatData&&(this.beatData=this.allBeatData[this.data.difficulty])},processBeats:function(){this.beatsTime=0,this.beatsPreloadTime=0,this.beatData._events.sort(s),this.beatData._obstacles.sort(s),this.beatData._notes.sort(s),this.bpm=this.info._beatsPerMinute;const e=this.beatData._events;if(e.length&&e[0]._time<0)for(let t=0;e[t]._time<0;t++)this.generateEvent(e[t]);this.beatDataProcessed=!0,console.log("[beat-generator] Finished processing beat data.")},tick:function(e,t){if(!this.data.isPlaying||!this.beatData)return;const i=this.el.components.song,n=this.beatsTime+o,s=this.eventsTime+o;if(void 0===this.beatsPreloadTime){if(!i.isPlaying)return;this.beatsTime=1e3*(i.getCurrentTime()+this.data.beatAnticipationTime+this.data.beatWarmupTime),this.eventsTime=1e3*i.getCurrentTime()}else this.beatsTime=this.beatsPreloadTime,this.eventsTime=1e3*i.getCurrentTime();if(this.isSeeking)return void(this.isSeeking=!1);const a=this.beatsTime+o,r=6e4/this.bpm,l=this.beatData._notes;for(let e=0;e<l.length;++e){let t=l[e]._time*r;t>n&&t<=a&&(l[e].time=t,this.generateBeat(l[e]))}const c=this.beatData._obstacles;for(let e=0;e<c.length;++e){let t=c[e]._time*r;t>n&&t<=a&&this.generateWall(c[e])}const d=this.eventsTime+o,h=this.beatData._events;for(let e=0;e<h.length;++e){let t=h[e]._time*r;t>s&&t<=d&&this.generateEvent(h[e])}void 0!==this.beatsPreloadTime&&(this.beatsPreloadTime>=this.beatsPreloadTimeTotal?(this.el.sceneEl.emit("beatloaderpreloadfinish",null,!1),this.beatsPreloadTime=void 0):this.beatsPreloadTime+=t)},seek:function(e){this.clearBeats(!0),this.beatsTime=1e3*(e+this.data.beatAnticipationTime+this.data.beatWarmupTime),this.isSeeking=!0},generateBeat:function(){const e={};return function(t){const i=this.data;let n,o=8===t._cutDirection?"dot":"arrow";0===t._type?n="red":1===t._type?n="blue":(o="mine",n=void 0);const s=this.requestBeat(o,n);s&&(e.anticipationPosition=-i.beatAnticipationTime*i.beatSpeed-this.swordOffset,e.color=n,e.cutDirection=this.orientationsHumanized[t._cutDirection],e.horizontalPosition=this.horizontalPositionsHumanized[t._lineIndex],e.speed=this.data.beatSpeed,e.type=o,e.verticalPosition=this.verticalPositionsHumanized[t._lineLayer],e.warmupPosition=-i.beatWarmupTime*i.beatWarmupSpeed,s.setAttribute("beat",e),s.play(),s.components.beat.onGenerate())}}(),generateWall:function(){const e={};return function(t){const i=this.el.sceneEl.components.pool__wall.requestEntity();if(!i)return;const n=this.data,o=this.data.beatSpeed,s=t._duration/this.bpm*60;e.anticipationPosition=-n.beatAnticipationTime*n.beatSpeed-this.swordOffset,e.durationSeconds=s,e.horizontalPosition=this.horizontalPositionsHumanized[t._lineIndex],e.isCeiling=1===t._type,e.speed=o,e.warmupPosition=-n.beatWarmupTime*n.beatWarmupSpeed,e.width=.5*t._width,i.setAttribute("wall",e),i.play()}}(),generateEvent:function(e){switch(e._type){case 0:this.stageColors.setColor("bg",e._value);break;case 1:this.stageColors.setColor("tunnel",e._value);break;case 2:this.stageColors.setColor("leftlaser",e._value);break;case 3:this.stageColors.setColor("rightlaser",e._value);break;case 4:this.stageColors.setColor("floor",e._value);break;case 8:case 9:this.twister.components.twister.pulse(e._value);break;case 12:this.leftStageLasers.components["stage-lasers"].pulse(e._value);break;case 13:this.rightStageLasers.components["stage-lasers"].pulse(e._value)}},requestBeat:function(e,t){var i,n="pool__beat-"+e;if(t&&(n+="-"+t),i=this.el.sceneEl.components[n])return i.requestEntity();console.warn("Pool "+n+" unavailable")},clearBeats:function(e){e||(this.beatsPreloadTime=0,this.beatsTime=0,this.eventsTime=0);for(let e=0;e<this.beatContainer.children.length;e++){let t=this.beatContainer.children[e];t.components.beat&&t.components.beat.returnToPool(),t.components.wall&&t.components.wall.returnToPool()}}})},8815:()=>{var e;const t="bottom";THREE.Audio.prototype.play=function(){if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){var t=this.context.createBufferSource();return t.buffer=this.buffer,t.detune.value=this.detune,t.loop=this.loop,t.onended=this.onEnded.bind(this),t.playbackRate.setValueAtTime(this.playbackRate,this.startTime),this.startTime=this.context.currentTime,e&&e(t),t.start(this.startTime,this.offset),this.isPlaying=!0,this.source=t,this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},AFRAME.registerComponent("beat-hit-sound",{directionsToSounds:{up:"",down:"",upleft:"left",upright:"right",downleft:"left",downright:"right",left:"left",right:"right"},init:function(){this.currentBeatEl=null,this.currentCutDirection="",this.processSound=this.processSound.bind(this),e=this.sourceCreatedCallback.bind(this);for(let e=1;e<=10;e++)this.el.setAttribute(`sound__beathit${e}`,{poolSize:4,src:`#hitSound${e}`,volume:.2}),this.el.setAttribute(`sound__beathit${e}left`,{poolSize:4,src:`#hitSound${e}left`,volume:.2}),this.el.setAttribute(`sound__beathit${e}right`,{poolSize:4,src:`#hitSound${e}right`,volume:.2})},play:function(){for(let e=1;e<=10;e++)setTimeout((()=>{this.el.components[`sound__beathit${e}`].loaded||(this.el.setAttribute(`sound__beathit${e}`,"src",""),this.el.setAttribute(`sound__beathit${e}`,"src",`#hitSound${e}`))}),10*e),setTimeout((()=>{this.el.components[`sound__beathit${e}left`].loaded||(this.el.setAttribute(`sound__beathit${e}left`,"src",""),this.el.setAttribute(`sound__beathit${e}left`,"src",`#hitSound${e}left`))}),20*e),setTimeout((()=>{this.el.components[`sound__beathit${e}right`].loaded||(this.el.setAttribute(`sound__beathit${e}right`,"src",""),this.el.setAttribute(`sound__beathit${e}right`,"src",`#hitSound${e}right`))}),30*e)},playSound:function(e,t){const i=1+Math.floor(10*Math.random()),n=this.directionsToSounds[t||"up"],o=this.el.components[`sound__beathit${i}${n}`];this.currentBeatEl=e,o.playSound(this.processSound)},processSound:function(e){e.detune=0,this.currentBeatEl.object3D.getWorldPosition(e.position)},sourceCreatedCallback:function(e){const i=this.getLayer(this.currentBeatEl.object3D.position.y);i===t?e.detune.setValueAtTime(-400,0):"top"===i&&e.detune.setValueAtTime(200,0),"down"===this.currentCutDirection&&e.detune.linearRampToValueAtTime(-400,1),"up"===this.currentCutDirection&&e.detune.linearRampToValueAtTime(400,1)},getLayer:function(e){return 1===e?t:1.7===e?"top":"middle"},setVolume:function(e){e*=.4;for(let t=1;t<=10;t++)for(let i=0;i<4;i++)this.el.components[`sound__beathit${t}`].pool.children[i].setVolume(e),this.el.components[`sound__beathit${t}left`].pool.children[i].setVolume(e),this.el.components[`sound__beathit${t}right`].pool.children[i].setVolume(e)}})},4934:(e,t,i)=>{"use strict";i.r(t);var n=i(5501);const o=i(9133),s=(new THREE.Object3D,Math.PI/5),a={once:!0};AFRAME.registerComponent("beat",{schema:{anticipationPosition:{default:0},color:{default:"red",oneOf:["red","blue"]},cutDirection:{default:"down"},debug:{default:!0},horizontalPosition:{default:"middleleft",oneOf:["left","middleleft","middleright","right"]},size:{default:.4},speed:{default:8},type:{default:"arrow",oneOf:["arrow","dot","mine"]},verticalPosition:{default:"middle",oneOf:["middle","top"]},warmupPosition:{default:0}},materialColor:{blue:o.BEAT_BLUE,red:o.BEAT_RED},cutColor:{blue:"#fff",red:"#fff"},models:{arrow:"beatObjTemplate",dot:"beatObjTemplate",mine:"mineObjTemplate"},signModels:{arrowred:"arrowRedObjTemplate",arrowblue:"arrowBlueObjTemplate",dotred:"dotRedObjTemplate",dotblue:"dotBlueObjTemplate"},orientations:[180,0,270,90,225,135,315,45,0],rotations:{up:180,down:0,left:270,right:90,upleft:225,upright:135,downleft:315,downright:45},horizontalPositions:{left:-.75,middleleft:-.25,middleright:.25,right:.75},verticalPositions:{middle:1.2,top:1.7},init:function(){this.beams=document.getElementById("beams").components.beams,this.beatBoundingBox=new THREE.Box3,this.currentRotationWarmupTime=0,this.cutDirection=new THREE.Vector3,this.destroyed=!1,this.gravityVelocity=0,this.hitEventDetail={},this.hitBoundingBox=new THREE.Box3,this.poolName=void 0,this.returnToPoolTimeStart=void 0,this.rotationAxis=new THREE.Vector3,this.scoreEl=null,this.scoreElTime=void 0,this.startPositionZ=void 0,this.particles=document.getElementById("saberParticles"),this.mineParticles=document.getElementById("mineParticles"),this.explodeEventDetail={position:new THREE.Vector3,rotation:new THREE.Euler},this.glow=null,this.destroyBeat=this.destroyBeat,this.initBlock(),"mine"===this.data.type&&this.initMineFragments()},update:function(){this.updateBlock(),"mine"===this.data.type?this.poolName="pool__beat-mine":this.poolName=`pool__beat-${this.data.type}-${this.data.color}`},pause:function(){this.el.object3D.visible=!1},play:function(){this.glow=this.el.sceneEl.components["pool__beat-glow"].requestEntity(),this.blockEl.object3D.visible=!0,this.el.setAttribute("beatObject","beat"),this.destroyed=!1,this.el.object3D.visible=!0},tock:function(e,t){const i=this.el,o=this.data,s=i.object3D.position,a=i.object3D.rotation;if(this.returnToPoolTimeStart&&e-this.returnToPoolTimeStart>800)return this.returnToPool(),void(this.returnToPoolTimeStart=void 0);if(s.z<o.anticipationPosition){let e=s.z+n.G*(t/1e3);e<o.anticipationPosition?s.z=e:(s.z=o.anticipationPosition,this.beams.newBeam(this.data.color,s))}else{const i=s.z;s.z+=this.data.speed*(t/1e3),a.z=this.startRotationZ,i<-1.5&&s.z>=-1.5&&(this.returnToPoolTimeStart=e,"mine"===this.data.type&&this.destroyMine())}if(s.z>o.anticipationPosition-.4&&this.currentRotationWarmupTime<750){const e=AFRAME.ANIME.easings.easeOutBack(this.currentRotationWarmupTime/750);i.object3D.rotation.z=this.rotationZStart+e*this.rotationZChange,this.currentRotationWarmupTime+=t}},onGenerate:function(){const e=this.el,t=this.data;e.object3D.position.set(this.horizontalPositions[t.horizontalPosition],this.verticalPositions[t.verticalPosition],t.anticipationPosition+t.warmupPosition),e.object3D.rotation.z=THREE.Math.degToRad(this.rotations[t.cutDirection]),this.startRotationZ=this.el.object3D.rotation.z,this.currentRotationWarmupTime=0,this.rotationZChange=s,Math.random>.5&&(this.rotationZChange*=-1),this.el.object3D.rotation.z-=this.rotationZChange,this.rotationZStart=this.el.object3D.rotation.z,"mine"==this.data.type&&this.resetMineFragments(),this.returnToPoolTimeStart=void 0},initBlock:function(){var e=this.el,t=this.blockEl=document.createElement("a-entity"),i=this.signEl=document.createElement("a-entity");t.setAttribute("mixin","beatBlock"),t.setAttribute("mixin","beatSign"),i.object3D.position.z+=.02,t.appendChild(i),e.appendChild(t)},updateBlock:function(){const e=this.blockEl,t=this.signEl;if(e)if(e.setAttribute("material",{metalness:.7,roughness:.1,sphericalEnvMap:"#envmapTexture",emissive:this.materialColor[this.data.color],emissiveIntensity:.05,color:this.materialColor[this.data.color]}),this.setObjModelFromTemplate(e,this.models[this.data.type]),e.object3D.scale.set(1,1,1),e.object3D.scale.multiplyScalar(3.45).multiplyScalar(this.data.size),"mine"===this.data.type){const t=e.getObject3D("mesh");t?t.material=this.el.sceneEl.systems.materials["mineMaterial"+this.data.color]:e.addEventListener("model-loaded",(()=>{t.material=this.el.sceneEl.systems.materials["mineMaterial"+this.data.color]}),a)}else t.setAttribute("materials",{name:"stageAdditive"}),this.setObjModelFromTemplate(t,this.signModels[this.data.type+this.data.color])},initMineFragments:function(){var e,t=this.el.sceneEl.systems["mine-fragments-loader"].fragments.children,i=this.el.sceneEl.systems.materials["mineMaterial"+this.data.color];this.randVec=new THREE.Vector3(Math.random()*Math.PI,Math.random()*Math.PI,Math.random()*Math.PI),this.mineFragments=[],this.mineBroken=document.createElement("a-entity"),this.el.appendChild(this.mineBroken);for(var n=0;n<t.length;n++)(e=new THREE.Mesh(t[n].geometry,i)).speed=new THREE.Vector3,e.speed.set(Math.random()-.5,Math.random()-.5,Math.random()-.5),this.mineFragments.push(e),this.mineBroken.object3D.add(e)},resetMineFragments:function(){if("mine"===this.data.type)for(let e=0;e<this.mineFragments.length;e++){let t=this.mineFragments[e];t.visible=!1,t.position.set(0,0,0),t.scale.set(1,1,1),t.speed.set(5*Math.random()-2.5,5*Math.random()-2.5,5*Math.random()-2.5)}},destroyMine:function(){for(let e=0;e<this.mineFragments.length;e++)this.mineFragments[e].visible=!0;this.blockEl.object3D.visible=!1,this.destroyed=!0,this.gravityVelocity=.1,this.returnToPoolTimer=800,this.explodeEventDetail.position.copy(this.el.object3D.position),this.explodeEventDetail.rotation.copy(this.randVec),this.mineParticles.emit("explode",this.explodeEventDetail,!1)},destroyBeat:function(){this.el.object3D.visible=!1,this.el.parentNode.components["beat-hit-sound"].playSound(this.el,this.data.cutDirection),this.explodeEventDetail.position.copy(this.el.object3D.position),this.explodeEventDetail.rotation.copy(this.el.object3D.rotation),this.particles.emit("explode",this.explodeEventDetail,!1),this.glow&&(this.glow.play(),this.glow.object3D.visible=!0,this.glow.object3D.position.copy(this.el.object3D.position),this.glow.object3D.rotation.z=2*Math.random(),this.glow.emit("explode",null,!1),"mine"!==this.data.type&&setTimeout((()=>{this.el.sceneEl.components["pool__beat-glow"].returnEntity(this.glow)}),350))},returnToPool:function(){this.el.sceneEl.components[this.poolName].returnEntity(this.el)},setObjModelFromTemplate:function(){const e={};return function(t,i){if(!e[i]){const n=document.getElementById(i);if(!n.getObject3D("mesh"))return void n.addEventListener("model-loaded",(()=>{e[i]=n.getObject3D("mesh").children[0].geometry,this.setObjModelFromTemplate(t,i)}));e[i]=n.getObject3D("mesh").children[0].geometry}t.getObject3D("mesh")||t.setObject3D("mesh",new THREE.Mesh),t.getObject3D("mesh").geometry=e[i]}}()})},8068:()=>{AFRAME.registerComponent("blob-texture",{dependencies:["material"],schema:{src:{type:"string"}},update:function(){var e=this.el,t=this.data;if(t.src)if(t.src.startsWith("blob")){const i=new Image;i.onload=function(){const t=new THREE.Texture;t.image=i,e.setAttribute("material","src",""),e.getObject3D("mesh").material.map=t,e.getObject3D("mesh").material.needsUpdate=!0,t.needsUpdate=!0},i.src=t.src}else e.setAttribute("material","src",t.src)}})},9444:()=>{AFRAME.registerComponent("collider-check",{dependencies:["raycaster"],init:function(){console.log("coming here??"),this.el.addEventListener("raycaster-intersected",(function(){console.log("Player hit something!"),this.raycaster=evt.detail.el,console.log(raycaster)}))}})},4931:()=>{AFRAME.registerComponent("console-shortcuts",{play:function(){window.$=e=>document.querySelector(e),window.$$=e=>document.querySelectorAll(e),window.$$$=e=>document.querySelector(`[${e}]`).getAttribute(e),window.$$$$=e=>document.querySelector(`[${e}]`).components[e],window.scene=this.el,window.state=this.el.systems.state.state}})},2599:()=>{AFRAME.registerComponent("copy-texture",{dependencies:["geometry","material"],schema:{from:{type:"selector"}},init:function(){this.data.from.addEventListener("materialtextureloaded",(()=>{this.copyTexture()})),this.copyTexture()},copyTexture:function(){const e=this.el,t=this.data.from,i=e.getObject3D("mesh").material;t.getObject3D("mesh")&&(i.map=t.getObject3D("mesh").material.map,i.map&&(i.map.needsUpdate=!0,i.needsUpdate=!0))}})},2913:()=>{AFRAME.registerComponent("cursor-mesh",{schema:{active:{default:!0},cursorEl:{type:"selector"}},init:function(){this.scenePivotEl=document.getElementById("scenePivot")},update:function(){this.el.object3D.visible=this.data.active},tick:function(){var e,t,i=this.data.cursorEl,n=this.el,o=this.scenePivotEl;this.data.active&&i.components.cursor&&((t=i.components.cursor.intersectedEl)?(n.object3D.visible=!0,(e=i.components.raycaster.getIntersection(t))&&(n.object3D.position.copy(e.point),o&&n.object3D.rotation.copy(o.object3D.rotation))):n.object3D.visible=!1)}})},6177:()=>{AFRAME.registerComponent("debug-controller",{init:function(){var e,t;AFRAME.utils.getUrlParameter("debug")&&(console.log("%c debug-controller enabled ","background: #111; color: red"),this.isCloning=!1,this.isDeleting=!1,this.isTriggerDown=!1,window.addEventListener("mousemove",this.onMouseMove.bind(this)),e=document.getElementById("rightHand"),t=document.getElementById("leftHand"),window.addEventListener("click",(t=>{t.isTrusted&&(e.emit("triggerdown"),e.emit("triggerup"))})),"oculus"===AFRAME.utils.getUrlParameter("debug")?(e.emit("controllerconnected",{name:"oculus-touch-controls"}),t.emit("controllerconnected",{name:"oculus-touch-controls"}),e.setAttribute("controller","controllerType","oculus-touch-controls"),t.setAttribute("controller","controllerType","oculus-touch-controls")):(e.emit("controllerconnected",{name:"vive-controls"}),t.emit("controllerconnected",{name:"vive-controls"}),e.setAttribute("controller","controllerType","vive-controls"),t.setAttribute("controller","controllerType","vive-controls")),this.el.emit("enter-vr",null,!1),document.addEventListener("keydown",(i=>{var n,o,s,a;i.shiftKey&&(32!==i.keyCode?81!==i.keyCode?(78===i.keyCode&&(this.secondaryGripDown?(t.emit("gripup"),this.secondaryGripDown=!1):(t.emit("gripdown"),this.secondaryGripDown=!0)),77===i.keyCode&&(this.primaryGripDown?(e.emit("gripup"),this.primaryGripDown=!1):(e.emit("gripdown"),this.primaryGripDown=!0)),49===i.keyCode&&t.emit("menudown"),i.ctrlKey?(s=t.getAttribute("position"),72===i.keyCode&&(s.x-=.01),74===i.keyCode&&(s.y-=.01),75===i.keyCode&&(s.y+=.01),76===i.keyCode&&(s.x+=.01),59!==i.keyCode&&186!==i.keyCode||(s.z-=.01),222===i.keyCode&&(s.z+=.01),t.setAttribute("position",AFRAME.utils.clone(s))):(n=e.getAttribute("position"),72===i.keyCode&&(n.x-=.01),74===i.keyCode&&(n.y-=.01),75===i.keyCode&&(n.y+=.01),76===i.keyCode&&(n.x+=.01),59!==i.keyCode&&186!==i.keyCode||(n.z-=.01),222===i.keyCode&&(n.z+=.01),e.setAttribute("position",AFRAME.utils.clone(n))),i.ctrlKey?(a=t.getAttribute("rotation"),89===i.keyCode&&(a.x-=10),79===i.keyCode&&(a.x+=10),85===i.keyCode&&(a.y-=10),73===i.keyCode&&(a.y+=10),t.setAttribute("rotation",AFRAME.utils.clone(a))):(o=e.getAttribute("rotation"),89===i.keyCode&&(o.x-=10),79===i.keyCode&&(o.x+=10),85===i.keyCode&&(o.y-=10),73===i.keyCode&&(o.y+=10),e.setAttribute("rotation",AFRAME.utils.clone(o)))):this.isSecondaryTriggerDown?(t.emit("triggerup"),this.isSecondaryTriggerDown=!1):(t.emit("triggerdown"),this.isSecondaryTriggerDown=!0):this.isTriggerDown?(e.emit("triggerup"),this.isTriggerDown=!1):(e.emit("triggerdown"),this.isTriggerDown=!0))})))},play:function(){var e,t;this.bounds=document.body.getBoundingClientRect(),AFRAME.utils.getUrlParameter("debug")&&(e=document.getElementById("rightHand"),(t=document.getElementById("leftHand")).object3D.position.set(-.2,1.5,-.5),e.object3D.position.set(.2,1.5,-.5),t.setAttribute("rotation",{x:35,y:0,z:0}))},onMouseMove:function(){const e=new THREE.Vector3,t=new THREE.Vector2,i=new THREE.Vector3;return function(n){const o=this.bounds,s=this.el.sceneEl.camera,a=n.clientX-o.left,r=n.clientY-o.top;t.x=a/o.width*2-1,t.y=-r/o.height*2-1,document.getElementById("camera").object3D.getWorldPosition(i),e.set(t.x,t.y,.5).unproject(s).sub(i).normalize();const l=document.getElementById("rightHand").object3D.position,c=-i.z/e.z;s.getWorldPosition(l).add(e.multiplyScalar(c)),l.y+=.8}}()})},5675:()=>{AFRAME.registerComponent("debug-cursor",{init:function(){},log:function(e,t,i){t.id?console.log(`%c[${e}] ${t.id}`,`color: ${i}`):(console.log(`%c[${e}]`,`color: ${i}`),console.log(t))}})},421:()=>{AFRAME.registerComponent("debug-song-time",{dependencies:["song"],init:function(){AFRAME.utils.getUrlParameter("debug-song-time")&&setInterval((()=>{console.log(this.el.components.song.getCurrentTime())}),250)}})},5060:()=>{AFRAME.registerComponent("debug-state",{play:function(){const e=AFRAME.utils.getUrlParameter("debugstate").trim();e&&setTimeout((()=>{e.split(",").forEach((e=>{this.el.sceneEl.emit(`debug${e.trim()}`,null,!1)}))}),500)}})},4274:(e,t,i)=>{"use strict";i.r(t);var n=i(9489);i(549);const o=new THREE.Color,s=(a(),new THREE.MeshBasicMaterial({alphaMap:function(){const e=document.createElement("canvas");e.height=1,e.width=4;const t=e.getContext("2d");return t.fillStyle="rgb(10, 10, 10)",t.fillRect(0,0,1,1),t.fillStyle="rgb(15, 15, 15)",t.fillRect(1,0,1,1),t.fillStyle="rgb(23, 23 ,23)",t.fillRect(2,0,1,1),t.fillStyle="rgb(28, 28, 28)",t.fillRect(3,0,1,1),setTimeout((()=>{e.style.position="fixed",e.style.zIndex=999999999999,e.style.left=0,e.style.top=0,document.body.appendChild(e)}),1e3),new THREE.CanvasTexture(e)}(),transparent:!0,vertexColors:THREE.VertexColors}));function a(e){o.set(e);const t=[{height:.1831,radius:.0055},{height:.1832,radius:.0065},{height:.1833,radius:.0075},{height:.1834,radius:.0085}].map(((e,t)=>{const i=new THREE.CylinderBufferGeometry(e.radius,e.radius,e.height),s=[];for(t=0;t<i.attributes.position.array.length;t+=3)s[t]=o.r,s[t+1]=o.g,s[t+2]=o.b;i.addAttribute("color",new THREE.Float32BufferAttribute(s,3));const a=(0,n.getGridUvs)(0,t,1,4),r=i.attributes.uv.array;for(t=0;t<r.length;t+=6)r[t]=a[0].x,r[t+1]=a[0].y,r[t+2]=a[1].x,r[t+3]=a[1].y,r[t+4]=a[2].x,r[t+5]=a[2].y;return i.attributes.uv.needsUpdate=!0,i}));return THREE.BufferGeometryUtils.mergeBufferGeometries(t)}AFRAME.registerComponent("fake-glow",{schema:{color:{default:"#FFF"}},play:function(){this.el.setObject3D("mesh",new THREE.Mesh(a(this.data.color),s))}})},2614:(e,t,i)=>{const n=i(9133),o=new THREE.Color(n.NEON_RED),s=new THREE.Color(n.NEON_BLUE);AFRAME.registerShader("floorShader",{schema:{normalMap:{type:"map",is:"uniform"},envMap:{type:"map",is:"uniform"},hitRight:{type:"vec3",is:"uniform",default:{x:0,y:1,z:0}},hitLeft:{type:"vec3",is:"uniform",default:{x:0,y:0,z:0}}},vertexShader:"\n    varying vec2 uvs;\n    varying vec3 worldPos;\n    void main() {\n      uvs.xy = uv.xy;\n      vec4 p = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n      worldPos = (modelMatrix * vec4( position, 1.0 )).xyz;\n      gl_Position = p;\n    }\n  ",fragmentShader:`\n    varying vec2 uvs;\n    varying vec3 worldPos;\n    uniform vec3 color;\n    uniform sampler2D normalMap;\n    uniform sampler2D envMap;\n    uniform vec3 hitRight;\n    uniform vec3 hitLeft;\n\n    #define HIT_COLOR vec3(${o.r}, ${o.g}, ${o.b})\n    #define BORDER_COLOR vec3(${s.r}, ${s.g}, ${s.b})\n\n    vec3 drawCircle(vec3 p, vec3 center, float radius, float edgeWidth, vec3 color) {\n      return color*(1.0-smoothstep(radius, radius+edgeWidth, length(p-center)));\n    }\n\n    void main() {\n      vec2 p = uvs.xy - 0.5;\n      vec3 border = vec3(smoothstep(0.49, 0.495, abs(p.x)) + smoothstep(0.49, 0.495, abs(p.y)));\n      border += BORDER_COLOR * (smoothstep(0.475, 0.495, abs(p.x)) + smoothstep(0.475, 0.495, abs(p.y))) * .7;\n      p*= 4.0;\n\n      vec3 hitColor = HIT_COLOR;\n      vec3 hit = vec3(0.0);\n\n      hit += drawCircle(worldPos, hitRight, 0.04, 0.05, hitColor);\n      hit += drawCircle(worldPos, hitRight, 0.02, 0.03, vec3(0.7, 0.7, 0.7));\n      hit += drawCircle(worldPos, hitLeft, 0.04, 0.05, hitColor);\n      hit += drawCircle(worldPos, hitLeft, 0.02, 0.03, vec3(0.7, 0.7, 0.7));\n\n      vec3 normal = normalize(texture2D(normalMap, uvs).xyz);\n\n      // environment reflection\n      vec3 reflectVec = normalize(reflect(normalize(worldPos - cameraPosition), normal));\n      //vec3 reflectView = normalize((viewMatrix * vec4(reflectVec, 0.0)).xyz + vec3(0.0, 0.0, 1.0));\n\n      vec3 ref = texture2D(envMap, reflectVec.xy * vec2(0.3, 1.0) + vec2(0.75, -cameraPosition.z * 0.05)).xyz * 0.14;\n\n      gl_FragColor = vec4(ref + border + hit, 1.0);\n    }\n  `})},7565:()=>{let e=0;AFRAME.registerComponent("gpu-preloader",{dependencies:["materials"],play:function(){this.preloadMineEnvMaps(),setTimeout((()=>{this.preloadAtlas(),this.preloadBeamMap(),this.preloadBeatEnvMap()}),1e3)},preloadAtlas:function(){const e=document.querySelector("#stageObj");this.preloadTexture(e.getObject3D("mesh").children[0].material.uniforms.src.value)},preloadBeamMap:function(){const e=document.querySelector("[beams]");this.preloadTexture(e.components.beams.texture)},preloadBeatEnvMap:function(){document.querySelector('#beatContainer [mixin~="beat"]').object3D.traverse((e=>{e.material&&(e.material.envMap&&this.preloadTexture(e.material.envMap),e.material.map&&this.preloadTexture(e.material.map))}))},preloadKeyboard:function(){const e=document.getElementById("keyboard").components["super-keyboard"];this.preloadTexture(e.kbImg.getObject3D("mesh").material.map),this.preloadTexture(e.keyColorPlane.getObject3D("mesh").material.map)},preloadMineEnvMaps:function(){const e=this.el.sceneEl.components["stage-colors"];this.el.sceneEl.addEventListener("mineredenvmaploaded",(()=>{this.preloadTexture(e.mineEnvMap.red)})),this.el.sceneEl.addEventListener("mineblueenvmaploaded",(()=>{this.preloadTexture(e.mineEnvMap.blue)}))},preloadWallMap:function(){const e=document.querySelector("a-entity[wall]");this.preloadTexture(e.getObject3D("mesh").material.uniforms.tex.value),this.preloadTexture(e.getObject3D("mesh").material.uniforms.env.value)},preloadTexture:function(t){t&&t.image?t.image.complete?this.el.renderer.setTexture2D(t,e++%8):console.warn("[gpu-preloader] Error preloading, image not loaded",t):console.warn("[gpu-preloader] Error preloading texture",t)}})},5860:()=>{AFRAME.registerSystem("iframe",{init:function(){window.self!==window.top&&(document.getElementById("vrButton").style.display="none")}})},859:()=>{AFRAME.registerComponent("keyboard-raycastable",{dependencies:["super-keyboard"],schema:{condition:{default:""}},play:function(){this.el.components["super-keyboard"].kbImg.setAttribute("bind-toggle__raycastable",this.data.condition)}})},592:(e,t,i)=>{const n=i(9133),o=i(1440),s=i(4490),a=i(6061);AFRAME.registerSystem("materials",{init:function(){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",this.createMaterials.bind(this)):this.createMaterials()},createMaterials:function(){this.stageNormal=new THREE.ShaderMaterial({uniforms:{skyColor:{value:new THREE.Color(n.SKY_BLUE)},backglowColor:{value:new THREE.Color(n.BG_BLUE)},src:{value:(new THREE.TextureLoader).load(document.getElementById("atlasImg").src)}},vertexShader:a.vertexShader,fragmentShader:a.fragmentShader,fog:!1,transparent:!0}),this.stageAdditive=new THREE.ShaderMaterial({uniforms:{tunnelNeon:{value:new THREE.Color(n.NEON_RED)},floorNeon:{value:new THREE.Color(n.NEON_RED)},leftLaser:{value:new THREE.Color(n.NEON_BLUE)},rightLaser:{value:new THREE.Color(n.NEON_BLUE)},textGlow:{value:new THREE.Color(n.TEXT_OFF)},src:{value:(new THREE.TextureLoader).load(document.getElementById("atlasImg").src)}},vertexShader:s.vertexShader,fragmentShader:s.fragmentShader,blending:THREE.AdditiveBlending,fog:!1,transparent:!0}),this.logo=new THREE.ShaderMaterial({uniforms:{src:{value:(new THREE.TextureLoader).load(document.getElementById("logotexImg").src)}},vertexShader:o.vertexShader,fragmentShader:o.fragmentShader,fog:!1,transparent:!0}),this.logoadditive=new THREE.ShaderMaterial({uniforms:{src:{value:(new THREE.TextureLoader).load(document.getElementById("logotexImg").src)}},vertexShader:o.vertexShader,fragmentShader:o.fragmentShader,depthTest:!1,blending:THREE.AdditiveBlending,fog:!1,transparent:!0}),this.mineMaterialred=new THREE.MeshStandardMaterial({roughness:.38,metalness:.48,color:new THREE.Color(n.MINE_RED),emissive:new THREE.Color(n.MINE_RED_EMISSION),envMap:(new THREE.TextureLoader).load("assets/img/mineenviro-red.jpg")}),this.mineMaterialblue=new THREE.MeshStandardMaterial({roughness:.38,metalness:.48,color:new THREE.Color(n.MINE_BLUE),emissive:new THREE.Color(n.MINE_BLUE_EMISSION),envMap:(new THREE.TextureLoader).load("assets/img/mineenviro-blue.jpg")})}}),AFRAME.registerComponent("materials",{schema:{name:{default:""},recursive:{default:!0}},update:function(){if(""===this.data.name)return;if(!this.system[this.data.name])return void console.warn(`undefined material "${this.system[this.data.name]}"`);const e=this.el.getObject3D("mesh");e?this.applyMaterial(e):this.el.addEventListener("model-loaded",this.applyMaterial.bind(this))},applyMaterial:function(e){const t=this.system[this.data.name];e.detail&&(e=e.detail.model),this.data.recursive?e.traverse((e=>{"Mesh"===e.type&&(e.material=t)})):e.material=t}})},2679:()=>{const e=new THREE.OBJLoader;AFRAME.registerSystem("mine-fragments-loader",{init:function(){this.fragments=null,document.getElementById("mineBrokenObj").addEventListener("loaded",(t=>{this.fragments=e.parse(t.target.data)}))}})},5388:e=>{const t={normal:THREE.NormalBlending,additive:THREE.AdditiveBlending,substractive:THREE.SubstractiveBlending,multiply:THREE.MultiplyBlending},i={flat:THREE.MeshBasicMaterial,lambert:THREE.MeshLambertMaterial,phong:THREE.MeshPhongMaterial,standard:THREE.MeshStandardMaterial},n=new THREE.Vector3(-99999,-99999,-99999);AFRAME.registerComponent("particleplayer",{schema:{blending:{default:"additive",oneOf:["normal","additive","multiply","substractive"]},color:{default:"#fff",type:"color"},count:{default:"100%"},delay:{default:0,type:"int"},dur:{default:1e3,type:"int"},img:{type:"selector"},interpolate:{default:!1},loop:{default:"false"},on:{default:"init"},poolSize:{default:5,type:"int"},protation:{type:"vec3"},pscale:{default:1,type:"float"},scale:{default:1,type:"float"},initialScale:{type:"vec3"},finalScale:{type:"vec3"},animateScale:{default:!1},shader:{default:"flat",oneOf:["flat","lambert","phong","standard"]},src:{type:"selector"}},multiple:!0,init:function(){this.frame=0,this.framedata=null,this.indexPool=null,this.lastFrame=0,this.material=null,this.msPerFrame=0,this.numFrames=0,this.numParticles=0,this.originalVertexPositions=[],this.particleCount=0,this.particleSystems=[],this.protation=!1,this.restPositions=[],this.restRotations=[],this.sprite_rotation=!1,this.systems=null,this.useRotation=!1,this.useAge=!1,this.scaleAnim=new THREE.Vector3,this.partScale=new THREE.Vector3(1,1,1)},update:function(e){const n=this.data;if(!n.src)return;e.on!==n.on&&(e.on&&this.el.removeEventListener(e.on,this.start),"play"!==n.on&&this.el.addEventListener(n.on,this.start.bind(this))),this.partScale.set(1,1,1),this.loadParticlesJSON(n.src,n.scale),this.numFrames=this.framedata.length,this.numParticles=this.numFrames>0?this.framedata[0].length:0,"%"===n.count[n.count.length-1]?this.particleCount=Math.floor(parseInt(n.count)*this.numParticles/100):this.particleCount=parseInt(n.count),this.particleCount=Math.min(this.numParticles,Math.max(0,this.particleCount)),this.msPerFrame=n.dur/this.numFrames,this.indexPool=new Array(this.numParticles);const o={color:new THREE.Color(n.color),side:THREE.DoubleSide,blending:t[n.blending],map:n.img?(new THREE.TextureLoader).load(n.img.src):null,depthWrite:!1,opacity:n.opacity,transparent:!!n.img||"normal"!==n.blending||n.opacity<1};void 0!==i[n.shader]?this.material=new i[n.shader](o):this.material=new i.flat(o),this.createParticles(n.poolSize),"init"===n.on&&this.start()},loadParticlesJSON:function(e,t){var i;this.restPositions.length=0,this.restRotations.length=0;const n=JSON.parse(e.data),o=n.frames,s=n.precision;this.useRotation=n.rotation,this.useAge=void 0!==n.age&&n.age,!1!==n.sprite_rotation?this.sprite_rotation={x:n.sprite_rotation[0]/s,y:n.sprite_rotation[1]/s,z:n.sprite_rotation[2]/s}:this.sprite_rotation=!1,this.framedata=new Array(o.length);for(let e=0;e<o.length;e++){this.framedata[e]=new Array(o[e].length);for(let n=0;n<o[e].length;n++){let a=o[e][n];i=0!==a;let r=this.framedata[e][n]={position:i?{x:a[0]/s*t,y:a[1]/s*t,z:a[2]/s*t}:null,alive:i};this.useRotation&&(r.rotation=i?{x:a[3]/s,y:a[4]/s,z:a[5]/s}:null),this.useAge&&(r.age=i?a[6]/s:0),i&&0===e&&(this.restPositions[n]=r.position?{x:r.position.y,y:r.position.y,z:r.position.z}:null,this.restRotations[n]=r.rotation?{x:r.rotation.y,y:r.rotation.y,z:r.rotation.z}:null)}}},createParticles:function(){const e=[];return function(t){const i=this.data;var n=parseInt(this.data.loop);this.particleSystems.length=0,isNaN(n)&&(n="true"===this.data.loop?Number.MAX_VALUE:0);for(let o=0;o<t;o++){let t={active:!1,activeParticleIndices:new Array(this.particleCount),loopCount:0,loopTotal:n,mesh:null,time:0};const s=i.img?i.img.width/i.img.height:1;e.length=0;for(let t=0;t<this.numParticles;t++){let t=new THREE.PlaneBufferGeometry(.1*s*i.pscale,.1*i.pscale);!1!==this.sprite_rotation?(t.rotateX(this.sprite_rotation.x),t.rotateY(this.sprite_rotation.y),t.rotateZ(this.sprite_rotation.z)):(t.rotateX(this.data.protation.x*Math.PI/180),t.rotateY(this.data.protation.y*Math.PI/180),t.rotateZ(this.data.protation.z*Math.PI/180)),e.push(t)}let r=THREE.BufferGeometryUtils.mergeBufferGeometries(e);t.mesh=new THREE.Mesh(r,this.material),t.mesh.visible=!1,this.el.setObject3D(`particleplayer${o}`,t.mesh),a(this.originalVertexPositions,r.attributes.position.array);for(let e=0;e<r.attributes.position.array.length;e++)r.attributes.position.array[e]=-99999;for(let e=0;e<t.activeParticleIndices.length;e++)t.activeParticleIndices[e]=e;this.particleSystems.push(t)}}}(),start:function(e){this.data.delay>0?setTimeout((()=>this.startAfterDelay(e)),this.data.delay):this.startAfterDelay(e)},startAfterDelay:function(e){var t,i=-1,n=0,o=e?e.detail.position:null,s=e?e.detail.rotation:null;o instanceof THREE.Vector3||(o=new THREE.Vector3),s instanceof THREE.Euler||(s=new THREE.Euler);for(var a=0;a<this.particleSystems.length;a++){if(!1===this.particleSystems[a].active){i=a;break}this.particleSystems[a].time>n&&(i=a,n=this.particleSystems[a].time)}if(-1!==i)return(t=this.particleSystems[i]).active=!0,t.loopCount=1,t.mesh.visible=!0,t.mesh.position.copy(o),t.mesh.rotation.copy(s),t.time=0,this.resetParticles(t),t},doLoop:function(e){e.loopCount++,e.frame=-1,e.time=0,this.resetParticles(e)},resetParticle:function(e,t){const i=e.mesh.geometry;this.restPositions[t]?s(t,i,this.originalVertexPositions,this.restPositions[t],this.useRotation&&this.restRotations[t],null):s(t,i,this.originalVertexPositions,n,void 0,null)},resetParticles:function(e){var t,i;if(this.particleCount===this.numParticles){for(t=0;t<this.numParticles;t++)this.resetParticle(e,t);return}const o=e.mesh.geometry;for(t=0;t<this.numParticles;t++)t<this.particleCount&&s(e.activeParticleIndices[t],o,this.originalVertexPositions,n,void 0,null),this.indexPool[t]=t;for(t=0;t<this.particleCount;t++)i=t+Math.floor(Math.random()*(this.numParticles-t)),e.activeParticleIndices[t]=this.indexPool[i],this.indexPool[i]=this.indexPool[t],this.resetParticle(e,e.activeParticleIndices[t])},tick:function(){const e=new THREE.Vector3;return function(t,i){var o,a,r,l,c,d,h=this.useRotation;const u=this.data.animateScale&&!this.useAge,f=this.data.animateScale&&this.useAge;for(let t=0;t<this.particleSystems.length;t++){let m=this.particleSystems[t];if(m.active){d=this.data.interpolate&&this.data.dur/this.numFrames>i,o=(c=m.time/this.data.dur)*this.numFrames,a=this.framedata[Math.floor(o)],d&&(l=o-Math.floor(o),r=o<this.numFrames-1?this.framedata[Math.floor(o)+1]:null),u&&this.partScale.lerpVectors(this.data.initialScale,this.data.finalScale,c);for(let t=0;t<m.activeParticleIndices.length;t++){let i=m.activeParticleIndices[t],o=h&&a[i].rotation;f&&this.partScale.lerpVectors(this.data.initialScale,this.data.finalScale,a[i].age),a[i].alive?d&&r&&r[i].alive?(e.lerpVectors(a[i].position,r[i].position,l),s(i,m.mesh.geometry,this.originalVertexPositions,e,o,this.partScale)):s(i,m.mesh.geometry,this.originalVertexPositions,a[i].position,o,this.partScale):s(i,m.mesh.geometry,this.originalVertexPositions,n,void 0,null)}m.time+=i,m.time>=this.data.dur&&(m.loopCount<m.loopTotal?(this.el.emit("particleplayerloop",null,!1),this.doLoop(m)):(this.el.emit("particleplayerfinished",null,!1),m.active=!1,m.mesh.visible=!1))}}}}(),_transformPlane:s});const o=function(){const e=new THREE.Geometry;return e.vertices.push(new THREE.Vector3),e.vertices.push(new THREE.Vector3),e.vertices.push(new THREE.Vector3),e.faces.push(new THREE.Face3(0,1,2)),e}();function s(e,t,i,n,s,a){const r=t.attributes.position.array,l=12*e;o.vertices[0].set(i[l+0],i[l+1],i[l+2]),o.vertices[1].set(i[l+3],i[l+4],i[l+5]),o.vertices[2].set(i[l+6],i[l+7],i[l+8]),null!==a&&o.scale(a.x,a.y,a.z),s&&(o.rotateX(s.x),o.rotateY(s.y),o.rotateZ(s.z)),o.vertices[0].add(n),o.vertices[1].add(n),o.vertices[2].add(n),r[l+0]=o.vertices[0].x,r[l+1]=o.vertices[0].y,r[l+2]=o.vertices[0].z,r[l+3]=o.vertices[1].x,r[l+4]=o.vertices[1].y,r[l+5]=o.vertices[1].z,r[l+6]=o.vertices[2].x,r[l+7]=o.vertices[2].y,r[l+8]=o.vertices[2].z,o.vertices[0].set(i[l+3],i[l+4],i[l+5]),o.vertices[1].set(i[l+6],i[l+7],i[l+8]),o.vertices[2].set(i[l+9],i[l+10],i[l+11]),null!==a&&o.scale(a.x,a.y,a.z),s&&(o.rotateX(s.x),o.rotateY(s.y),o.rotateZ(s.z)),o.vertices[0].add(n),o.vertices[1].add(n),o.vertices[2].add(n),r[l+9]=o.vertices[2].x,r[l+10]=o.vertices[2].y,r[l+11]=o.vertices[2].z,t.attributes.position.needsUpdate=!0}function a(e,t){e.length=0;for(let i=0;i<t.length;i++)e[i]=t[i]}e.exports.transformPlane=s},3735:()=>{AFRAME.registerComponent("pause",{schema:{isPaused:{default:!1}},update:function(){this.data.isPaused&&this.el.isPlaying?this.el.pause():this.data.isPaused||this.el.isPlaying||!this.el.sceneEl.isPlaying||this.el.play()}})},4679:()=>{AFRAME.registerComponent("pauser",{schema:{enabled:{default:!0}},init:function(){this.pauseGame=this.pauseGame.bind(this),document.addEventListener("visibilitychange",(()=>{"hidden"===document.visibilityState&&this.pauseGame()}))},pauseGame:function(){this.data.enabled&&this.el.sceneEl.emit("pausegame",null,!1)}})},4047:(e,t,i)=>{var n=i(3783);AFRAME.registerSystem("play-sound",{init:function(){this.lastSoundPlayed="",this.lastSoundPlayedTime=0,this.pools={}},createPool:function(e,t){this.pools[e]||(this.pools[e]=new n(e,t))},playSound:function(e,t){this.pools[e]||this.createPool(e,t),this.pools[e].play(),this.lastSoundPlayed=e,this.lastSoundTime=this.el.time}}),AFRAME.registerComponent("play-sound",{schema:{enabled:{default:!0},event:{type:"string"},sound:{type:"string"},volume:{type:"number",default:1}},multiple:!0,init:function(){this.el.addEventListener(this.data.event,(e=>{this.data.enabled&&this.system.playSound(this.src,this.data.volume)}))},update:function(){if(this.src=this.data.sound,this.data.sound.startsWith("#"))try{this.src=document.querySelector(this.data.sound).getAttribute("src")}catch(e){console.log(e,this.data.sound)}}})},3583:()=>{var e,t;AFRAME.registerComponent("raycaster-target",{schema:{bindToggle:{default:""},depth:{type:"number"},height:{type:"number"},position:{type:"vec3",default:{x:0,y:0,z:0}},rotation:{type:"vec3",default:{x:0,y:0,z:0}},useBoxTarget:{default:!1},width:{type:"number"}},init:(e={primitive:"box"},t={primitive:"plane"},function(){var i,n,o=this.data,s=this.el;(n=document.createElement("a-entity")).classList.add("raycasterTarget"),o.bindToggle?n.setAttribute("bind-toggle__raycastable",o.bindToggle):n.setAttribute("data-raycastable",""),o.useBoxTarget?((i=e).depth=o.depth,i.height=o.height,i.width=o.width):((i=t).height=o.height,i.width=o.width),n.setAttribute("geometry",i),n.object3D.visible=!1,n.object3D.position.copy(o.position),n.object3D.rotation.x=THREE.Math.degToRad(o.rotation.x),n.object3D.rotation.y=THREE.Math.degToRad(o.rotation.y),n.object3D.rotation.z=THREE.Math.degToRad(o.rotation.z),s.appendChild(n)})})},312:(e,t,i)=>{"use strict";i.r(t);var n=function(){},o={},s=[],a=[];function r(e,t){var i,r,l,c,d=a;for(c=arguments.length;c-- >2;)s.push(arguments[c]);for(t&&null!=t.children&&(s.length||s.push(t.children),delete t.children);s.length;)if((r=s.pop())&&void 0!==r.pop)for(c=r.length;c--;)s.push(r[c]);else"boolean"==typeof r&&(r=null),(l="function"!=typeof e)&&(null==r?r="":"number"==typeof r?r=String(r):"string"!=typeof r&&(l=!1)),l&&i?d[d.length-1]+=r:d===a?d=[r]:d.push(r),i=l;var h=new n;return h.nodeName=e,h.children=d,h.attributes=null==t?void 0:t,h.key=null==t?void 0:t.key,void 0!==o.vnode&&o.vnode(h),h}function l(e,t){for(var i in t)e[i]=t[i];return e}function c(e,t){e&&("function"==typeof e?e(t):e.current=t)}var d="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout,h=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,u=[];function f(e){!e._dirty&&(e._dirty=!0)&&1==u.push(e)&&(o.debounceRendering||d)(m)}function m(){for(var e;e=u.pop();)e._dirty&&j(e)}function p(e,t,i){return"string"==typeof t||"number"==typeof t?void 0!==e.splitText:"string"==typeof t.nodeName?!e._componentConstructor&&g(e,t.nodeName):i||e._componentConstructor===t.nodeName}function g(e,t){return e.normalizedNodeName===t||e.nodeName.toLowerCase()===t.toLowerCase()}function b(e){var t=l({},e.attributes);t.children=e.children;var i=e.nodeName.defaultProps;if(void 0!==i)for(var n in i)void 0===t[n]&&(t[n]=i[n]);return t}function y(e){var t=e.parentNode;t&&t.removeChild(e)}function v(e,t,i,n,o){if("className"===t&&(t="class"),"key"===t);else if("ref"===t)c(i,null),c(n,e);else if("class"!==t||o)if("style"===t){if(n&&"string"!=typeof n&&"string"!=typeof i||(e.style.cssText=n||""),n&&"object"==typeof n){if("string"!=typeof i)for(var s in i)s in n||(e.style[s]="");for(var s in n)e.style[s]="number"==typeof n[s]&&!1===h.test(s)?n[s]+"px":n[s]}}else if("dangerouslySetInnerHTML"===t)n&&(e.innerHTML=n.__html||"");else if("o"==t[0]&&"n"==t[1]){var a=t!==(t=t.replace(/Capture$/,""));t=t.toLowerCase().substring(2),n?i||e.addEventListener(t,E,a):e.removeEventListener(t,E,a),(e._listeners||(e._listeners={}))[t]=n}else if("list"!==t&&"type"!==t&&!o&&t in e){try{e[t]=null==n?"":n}catch(e){}null!=n&&!1!==n||"spellcheck"==t||e.removeAttribute(t)}else{var r=o&&t!==(t=t.replace(/^xlink:?/,""));null==n||!1===n?r?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.removeAttribute(t):"function"!=typeof n&&(r?e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),n):e.setAttribute(t,n))}else e.className=n||""}function E(e){return this._listeners[e.type](o.event&&o.event(e)||e)}var x=[],w=0,A=!1,k=!1;function T(){for(var e;e=x.shift();)o.afterMount&&o.afterMount(e),e.componentDidMount&&e.componentDidMount()}function R(e,t,i,n,o,s){w++||(A=null!=o&&void 0!==o.ownerSVGElement,k=null!=e&&!("__preactattr_"in e));var a=C(e,t,i,n,s);return o&&a.parentNode!==o&&o.appendChild(a),--w||(k=!1,s||T()),a}function C(e,t,i,n,o){var s=e,a=A;if(null!=t&&"boolean"!=typeof t||(t=""),"string"==typeof t||"number"==typeof t)return e&&void 0!==e.splitText&&e.parentNode&&(!e._component||o)?e.nodeValue!=t&&(e.nodeValue=t):(s=document.createTextNode(t),e&&(e.parentNode&&e.parentNode.replaceChild(s,e),S(e,!0))),s.__preactattr_=!0,s;var r,l,c=t.nodeName;if("function"==typeof c)return function(e,t,i,n){for(var o=e&&e._component,s=o,a=e,r=o&&e._componentConstructor===t.nodeName,l=r,c=b(t);o&&!l&&(o=o._parentComponent);)l=o.constructor===t.nodeName;return o&&l&&(!n||o._component)?(B(o,c,3,i,n),e=o.base):(s&&!r&&(O(s),e=a=null),o=D(t.nodeName,c,i),e&&!o.nextBase&&(o.nextBase=e,a=null),B(o,c,1,i,n),e=o.base,a&&e!==a&&(a._component=null,S(a,!1))),e}(e,t,i,n);if(A="svg"===c||"foreignObject"!==c&&A,c=String(c),(!e||!g(e,c))&&(r=c,(l=A?document.createElementNS("http://www.w3.org/2000/svg",r):document.createElement(r)).normalizedNodeName=r,s=l,e)){for(;e.firstChild;)s.appendChild(e.firstChild);e.parentNode&&e.parentNode.replaceChild(s,e),S(e,!0)}var d=s.firstChild,h=s.__preactattr_,u=t.children;if(null==h){h=s.__preactattr_={};for(var f=s.attributes,m=f.length;m--;)h[f[m].name]=f[m].value}return!k&&u&&1===u.length&&"string"==typeof u[0]&&null!=d&&void 0!==d.splitText&&null==d.nextSibling?d.nodeValue!=u[0]&&(d.nodeValue=u[0]):(u&&u.length||null!=d)&&function(e,t,i,n,o){var s,a,r,l,c,d=e.childNodes,h=[],u={},f=0,m=0,g=d.length,b=0,v=t?t.length:0;if(0!==g)for(var E=0;E<g;E++){var x=d[E],w=x.__preactattr_;null!=(A=v&&w?x._component?x._component.__key:w.key:null)?(f++,u[A]=x):(w||(void 0!==x.splitText?!o||x.nodeValue.trim():o))&&(h[b++]=x)}if(0!==v)for(E=0;E<v;E++){var A;if(c=null,null!=(A=(l=t[E]).key))f&&void 0!==u[A]&&(c=u[A],u[A]=void 0,f--);else if(m<b)for(s=m;s<b;s++)if(void 0!==h[s]&&p(a=h[s],l,o)){c=a,h[s]=void 0,s===b-1&&b--,s===m&&m++;break}c=C(c,l,i,n),r=d[E],c&&c!==e&&c!==r&&(null==r?e.appendChild(c):c===r.nextSibling?y(r):e.insertBefore(c,r))}if(f)for(var E in u)void 0!==u[E]&&S(u[E],!1);for(;m<=b;)void 0!==(c=h[b--])&&S(c,!1)}(s,u,i,n,k||null!=h.dangerouslySetInnerHTML),function(e,t,i){var n;for(n in i)t&&null!=t[n]||null==i[n]||v(e,n,i[n],i[n]=void 0,A);for(n in t)"children"===n||"innerHTML"===n||n in i&&t[n]===("value"===n||"checked"===n?e[n]:i[n])||v(e,n,i[n],i[n]=t[n],A)}(s,t.attributes,h),A=a,s}function S(e,t){var i=e._component;i?O(i):(null!=e.__preactattr_&&c(e.__preactattr_.ref,null),!1!==t&&null!=e.__preactattr_||y(e),M(e))}function M(e){for(e=e.lastChild;e;){var t=e.previousSibling;S(e,!0),e=t}}var P=[];function D(e,t,i){var n,o=P.length;for(e.prototype&&e.prototype.render?(n=new e(t,i),L.call(n,t,i)):((n=new L(t,i)).constructor=e,n.render=_);o--;)if(P[o].constructor===e)return n.nextBase=P[o].nextBase,P.splice(o,1),n;return n}function _(e,t,i){return this.constructor(e,i)}function B(e,t,i,n,s){e._disable||(e._disable=!0,e.__ref=t.ref,e.__key=t.key,delete t.ref,delete t.key,void 0===e.constructor.getDerivedStateFromProps&&(!e.base||s?e.componentWillMount&&e.componentWillMount():e.componentWillReceiveProps&&e.componentWillReceiveProps(t,n)),n&&n!==e.context&&(e.prevContext||(e.prevContext=e.context),e.context=n),e.prevProps||(e.prevProps=e.props),e.props=t,e._disable=!1,0!==i&&(1!==i&&!1===o.syncComponentUpdates&&e.base?f(e):j(e,1,s)),c(e.__ref,e))}function j(e,t,i,n){if(!e._disable){var s,a,r,c=e.props,d=e.state,h=e.context,u=e.prevProps||c,f=e.prevState||d,m=e.prevContext||h,p=e.base,g=e.nextBase,y=p||g,v=e._component,E=!1,A=m;if(e.constructor.getDerivedStateFromProps&&(d=l(l({},d),e.constructor.getDerivedStateFromProps(c,d)),e.state=d),p&&(e.props=u,e.state=f,e.context=m,2!==t&&e.shouldComponentUpdate&&!1===e.shouldComponentUpdate(c,d,h)?E=!0:e.componentWillUpdate&&e.componentWillUpdate(c,d,h),e.props=c,e.state=d,e.context=h),e.prevProps=e.prevState=e.prevContext=e.nextBase=null,e._dirty=!1,!E){s=e.render(c,d,h),e.getChildContext&&(h=l(l({},h),e.getChildContext())),p&&e.getSnapshotBeforeUpdate&&(A=e.getSnapshotBeforeUpdate(u,f));var k,C,M=s&&s.nodeName;if("function"==typeof M){var P=b(s);(a=v)&&a.constructor===M&&P.key==a.__key?B(a,P,1,h,!1):(k=a,e._component=a=D(M,P,h),a.nextBase=a.nextBase||g,a._parentComponent=e,B(a,P,0,h,!1),j(a,1,i,!0)),C=a.base}else r=y,(k=v)&&(r=e._component=null),(y||1===t)&&(r&&(r._component=null),C=R(r,s,h,i||!p,y&&y.parentNode,!0));if(y&&C!==y&&a!==v){var _=y.parentNode;_&&C!==_&&(_.replaceChild(C,y),k||(y._component=null,S(y,!1)))}if(k&&O(k),e.base=C,C&&!n){for(var L=e,H=e;H=H._parentComponent;)(L=H).base=C;C._component=L,C._componentConstructor=L.constructor}}for(!p||i?x.push(e):E||(e.componentDidUpdate&&e.componentDidUpdate(u,f,A),o.afterUpdate&&o.afterUpdate(e));e._renderCallbacks.length;)e._renderCallbacks.pop().call(e);w||n||T()}}function O(e){o.beforeUnmount&&o.beforeUnmount(e);var t=e.base;e._disable=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;var i=e._component;i?O(i):t&&(null!=t.__preactattr_&&c(t.__preactattr_.ref,null),e.nextBase=t,y(t),P.push(e),M(t)),c(e.__ref,null)}function L(e,t){this._dirty=!0,this.context=t,this.props=e,this.state=this.state||{},this._renderCallbacks=[]}let H;l(L.prototype,{setState:function(e,t){this.prevState||(this.prevState=this.state),this.state=l(l({},this.state),"function"==typeof e?e(this.state,this.props):e),t&&this._renderCallbacks.push(t),f(this)},forceUpdate:function(e){e&&this._renderCallbacks.push(e),j(this,2)},render:function(){}});class I extends L{constructor(){var e,t,i;super(),this.state={open:!1,results:[],url:"supermedium.com/beatsaver-viewer"},document.addEventListener("click",(e=>{this.state.open&&(e.target.closest("#searchResultsContainer")||e.target.closest("#searchInput")||e.target.closest("#searchToggle")||this.setState({open:!1}))})),document.getElementById("searchToggle").addEventListener("click",(()=>{this.setState({open:!this.state.open}),setTimeout((()=>{document.getElementById("searchInput").focus()}),15)})),H.addEventListener("challengeset",(e=>{const t=e.detail;t&&(this.setState({url:`supermedium.com/beatsaver-viewer?id=${t}`}),function(e){let t=window.location.search.toString();t?t.match(z)?t=t.replace(z,`id=${e}`):t+=`&id=${e}`:t=`?id=${e}`;let i=`${window.location.protocol}//${window.location.host}${window.location.pathname}`;i+=t,window.history.pushState({path:i},"",i)}(t))})),this.search=(e=this.search.bind(this),100,function(){let n=this,o=arguments,s=function(){i=null,e.apply(n,o)},a=t;clearTimeout(i),i=setTimeout(s,100),a&&e.apply(n,o)}),this.selectSong=this.selectSong.bind(this)}componentDidUpdate(){this.state.open&&document.getElementById("controlsDifficultyOptions").classList.remove(".difficultyOptionsActive")}search(e){const t=new XMLHttpRequest;t.open("GET",`https://beatsaver.com/api/search/text/0?q=${e.target.value}`),t.addEventListener("load",(()=>{this.setState({results:JSON.parse(t.responseText).docs}),ga("send","event","search","search")})),t.send()}selectSong(e){H.emit("songselect",this.state.results[e.target.closest(".searchResult").dataset.i]),this.setState({open:!1}),ga("send","pageview"),document.getElementById("searchInput").value=""}render(){return r("div",{id:"search"},r("div",{id:"searchResultsContainer",style:{display:this.state.open&&this.state.results.length?"flex":"none"}},r("h3",null,"Search Results (beatsaver.com)"),r("ul",{id:"searchResults"},this.state.results.map(((e,t)=>r("li",{class:"searchResult","data-id":e.key,onClick:this.selectSong,key:e.key,"data-i":t},r("img",{src:`https://beatsaver.com${e.coverURL}`}),r("p",null,e.metadata.songSubName&&F(e.metadata.songSubName,20)+"  "||"",F(e.metadata.songName,25))))))),r("p",{id:"url",style:{display:this.state.open?"none":"block"}},this.state.url),r("input",{id:"searchInput",type:"search",placeholder:"Search BeatSaver songs...",onKeyUp:this.search,style:{display:this.state.open?"flex":"none"}}))}}function F(e,t){return e?e.length>=t?e.substring(0,t-2)+"..":e:""}AFRAME.registerSystem("search",{init:function(){H=this.el,function(e,t,i){R(i,e,{},!1,t,!1)}(r(I,null),document.getElementById("controls"))}});const z=/id=[\d\w-]+/},6545:()=>{const e={once:!0};let t=AFRAME.utils.getUrlParameter("time").trim();function i(e,t){return e?e.length>=t?e.substring(0,t-2)+"..":e:""}t=!t||isNaN(t)?void 0:parseFloat(t),AFRAME.registerComponent("song-controls",{dependencies:["song"],schema:{difficulty:{default:""},songName:{default:""},songSubName:{default:""},songImage:{default:""},isPlaying:{default:!1}},init:function(){this.song=this.el.components.song,this.tick=AFRAME.utils.throttleTick(this.tick.bind(this),100),void 0!==t&&this.el.sceneEl.addEventListener("songstartaudio",(()=>{setTimeout((()=>{this.seek(t)}),100)}),e),document.getElementById("audioAnalyser").addEventListener("audioanalyserbuffersource",(e=>{document.getElementById("songDuration").innerHTML=o(e.detail.buffer.duration)})),this.songProgress=document.getElementById("songProgress")},update:function(){this.controls&&(this.data.isPlaying?document.body.classList.add("isPlaying"):document.body.classList.remove("isPlaying"),document.getElementById("songImage").src=this.data.songImage,document.getElementById("songName").innerHTML=i(this.data.songName,15),document.getElementById("songName").setAttribute("title",this.data.songName),document.getElementById("songSubName").innerHTML=i(this.data.songSubName,18),document.getElementById("songSubName").setAttribute("title",this.data.songSubName),document.getElementById("controlsDifficulty").innerHTML=this.data.difficulty)},play:function(){this.controls=document.getElementById("controls"),this.difficulty=document.getElementById("controlsDifficulty"),this.difficultyOptions=document.getElementById("controlsDifficultyOptions"),this.playhead=document.getElementById("playhead");const e=this.timeline=document.getElementById("timeline"),t=this.timelineHover=document.getElementById("timelineHover");e.offsetWidth,this.el.sceneEl.addEventListener("challengeloadend",(e=>{this.controls.classList.add("challengeLoaded");for(let e=0;e<this.difficultyOptions.children.length;e++)this.difficultyOptions.children[e].style.display="none";e.detail.info.difficultyLevels.forEach((e=>{this.difficultyOptions.querySelector(`[data-difficulty="${e._difficulty}"]`).style.display="inline-block"}))})),e.addEventListener("click",(t=>{if(!this.song.source)return;const i=(t.clientX-e.getBoundingClientRect().left)/e.getBoundingClientRect().width*this.song.source.buffer.duration;this.seek(i),function(e){e=parseInt(e);let t=window.location.search.toString();t?t.match(n)?t=t.replace(n,`time=${e}`):t+=`&time=${e}`:t=`?time=${e}`;let i=`${window.location.protocol}//${window.location.host}${window.location.pathname}`;i+=t,window.history.pushState({path:i},"",i)}(i)})),e.addEventListener("mouseenter",(e=>{this.song.source&&t.classList.add("timelineHoverActive")})),e.addEventListener("mousemove",(i=>{const n=i.clientX-e.getBoundingClientRect().left,s=n/e.getBoundingClientRect().width;t.style.left=n-17+"px",t.innerHTML=o(s*this.song.source.buffer.duration)})),e.addEventListener("mouseleave",(e=>{t.classList.remove("timelineHoverActive")})),document.getElementById("controlsPause").addEventListener("click",(()=>{this.el.sceneEl.emit("pausegame",null,!1)})),this.difficulty.addEventListener("click",(()=>{this.controls.classList.toggle("difficultyOptionsActive")})),this.el.sceneEl.addEventListener("click",(e=>{this.controls.classList.remove("difficultyOptionsActive")})),this.difficultyOptions.addEventListener("click",(e=>{this.songProgress.innerHTML=o(0),this.playhead.style.width="0%",this.el.sceneEl.emit("difficultyselect",e.target.dataset.difficulty,!1),this.controls.classList.remove("difficultyOptionsActive")})),document.addEventListener("click",(e=>{if(e.target.closest("#volumeSliderContainer")||e.target.closest("#controlsVolume"))return;const t=document.getElementById("volumeSliderContainer");t.classList.contains("volumeActive")&&t.classList.remove("volumeActive")})),document.getElementById("controlsVolume").addEventListener("click",(e=>{document.getElementById("volumeSliderContainer").classList.toggle("volumeActive")})),document.getElementById("volumeSlider").addEventListener("change",(e=>{this.song.audioAnalyser.gainNode.gain.cancelScheduledValues(0),this.song.audioAnalyser.gainNode.gain.value=e.target.value,document.getElementById("beatContainer").components["beat-hit-sound"].setVolume(e.target.value)}))},tick:function(){this.song.isPlaying&&this.song.source&&(this.updatePlayhead(),this.songProgress.innerHTML=o(this.song.getCurrentTime()))},seek:function(t){this.data.isPlaying&&this.song.stopAudio(),this.song.data.analyserEl.addEventListener("audioanalyserbuffersource",(e=>{this.song.source=e.detail,this.song.startAudio(t),this.el.components["beat-generator"].seek(t),this.updatePlayhead()}),e),this.song.audioAnalyser.refreshSource()},updatePlayhead:function(){const e=Math.max(0,Math.min(100,this.song.getCurrentTime()/this.song.source.buffer.duration*100));this.playhead.style.width=e+"%"}});const n=/time=\d+/;function o(e){const t=~~(e/3600),i=~~(e%3600/60),n=~~e%60;let o="";return t>0&&(o+=t+":"+(i<10?"0":"")),o+=i+":"+(n<10?"0":""),o+=""+n,o}},6851:()=>{AFRAME.registerComponent("song-progress-ring",{dependencies:["geometry","material"],schema:{enabled:{default:!1}},init:function(){this.tick=AFRAME.utils.throttleTick(this.tick.bind(this),1e3),this.progress=this.el.getObject3D("mesh").material.uniforms.progress,this.el.sceneEl.addEventListener("cleargame",(()=>{this.progress.value=0}))},update:function(e){this.progress.value=0},updateRing:function(){const e=this.el.sceneEl.components.song.source;if(!e)return;const t=this.el.sceneEl.components.song.getCurrentTime()/e.buffer.duration;this.progress.value=t},tick:function(){this.data.enabled&&this.updateRing()}})},6020:(e,t,i)=>{i(9853);const n={once:!0};let o=AFRAME.utils.getUrlParameter("skip");o=o?parseInt(o)/1e3:0,AFRAME.registerComponent("song",{schema:{audio:{default:""},analyserEl:{type:"selector",default:"#audioAnalyser"},difficulty:{default:""},hasReceivedUserGesture:{default:!1},isBeatsPreloaded:{default:!1},isPaused:{default:!1},isPlaying:{default:!1}},init:function(){this.analyserSetter={buffer:!0},this.audioAnalyser=this.data.analyserEl.components.audioanalyser,this.context=this.audioAnalyser.context,this.isPlaying=!1,this.songLoadingIndicator=document.getElementById("songLoadingIndicator"),this.songStartTime=0,this.audioAnalyser.gainNode.gain.value=document.getElementById("volumeSlider").value||.35,this.el.addEventListener("gamemenurestart",this.onRestart.bind(this))},update:function(e){const t=this.data;this.el.sceneEl.isPlaying&&(e.isPaused&&!t.isPaused&&(-1!==navigator.userAgent.indexOf("Chrome")?this.source.playbackRate.value=1:this.audioAnalyser.resumeContext(),this.isPlaying=!0),e.difficulty&&e.difficulty!==t.difficulty&&this.onRestart(),!e.isBeatsPreloaded&&this.data.isBeatsPreloaded&&this.source&&this.startAudio(),e.audio!==t.audio&&t.audio&&(this.el.sceneEl.emit("songprocessingstart",null,!1),this.getAudio().then((e=>{this.el.sceneEl.emit("songprocessingfinish",null,!1)})).catch(console.error)),!e.isPaused&&t.isPaused&&(-1!==navigator.userAgent.indexOf("Chrome")?this.source.playbackRate.value=1e-9:this.audioAnalyser.suspendContext(),this.isPlaying=!1))},pause:function(){this.data.isPlaying&&this.audioAnalyser.suspendContext()},play:function(){this.data.isPlaying&&this.audioAnalyser.resumeContext()},getAudio:function(){const e=this.data;return this.isPlaying=!1,new Promise((t=>{e.analyserEl.addEventListener("audioanalyserbuffersource",(e=>{this.source=e.detail,t(this.source)}),n),this.analyserSetter.src=this.data.audio,e.analyserEl.setAttribute("audioanalyser",this.analyserSetter)}))},stopAudio:function(){this.source?(this.source.stop(),this.source.disconnect(),this.source=null,this.isPlaying=!1):console.warn("[song] Tried to stopAudio, but not playing.")},onRestart:function(){this.isPlaying=!1,this.source&&this.source.disconnect(),this.audioAnalyser.gainNode.gain.cancelScheduledValues(0),this.el.sceneEl.emit("songprocessingstart",null,!1),this.data.analyserEl.addEventListener("audioanalyserbuffersource",(e=>{this.source=e.detail,this.el.sceneEl.emit("songprocessingfinish",null,!1),this.data.isPlaying&&this.data.isBeatsPreloaded&&this.startAudio()}),n),this.audioAnalyser.refreshSource()},startAudio:function(e){const t=e||o||0;this.songStartTime=this.context.currentTime-t,this.source.start(0,t),this.isPlaying=!0,this.el.emit("songstartaudio")},getCurrentTime:function(){return this.context.currentTime-this.songStartTime}})},7967:()=>{AFRAME.registerComponent("stage-colors",{dependencies:["background"],schema:{color:{default:"blue",oneOf:["blue","red"]}},init:function(){this.colorCodes=["off","blue","blue","bluefade","","red","red","redfade"],this.el.addEventListener("cleargame",this.resetColors.bind(this))},setColor:function(e,t){this.el.emit(`${e}color${this.colorCodes[t]}`,null,!1)},resetColors:function(){this.el.emit("bgcolorblue",null,!1),this.el.emit("tunnelcolorred",null,!1),this.el.emit("floorcolorred",null,!1),this.el.emit("leftlasercolorblue",null,!1),this.el.emit("rightlasercolorblue",null,!1)}})},3185:()=>{AFRAME.registerComponent("stage-lasers",{schema:{enabled:{default:!0}},init:function(){this.speed=0,this.lasers=[this.el.children[0].object3D,this.el.children[1].object3D,this.el.children[2].object3D]},pulse:function(e){this.speed=e/8},tick:function(e,t){0!==this.speed&&(t/=1e3,!this.data.enabled&&(this.speed*=.97,Math.abs(this.speed)<.01)?this.speed=0:(this.lasers[0].rotation.z+=this.speed*t,this.lasers[1].rotation.z-=this.speed*t*1.01,this.lasers[2].rotation.z+=this.speed*t*1.02))}})},4207:()=>{AFRAME.registerShader("stageShader",{schema:{color:{type:"vec3",is:"uniform",default:{x:0,y:0,z:0}},fogColor:{type:"vec3",is:"uniform",default:{x:0,y:.48,z:.72}},src:{type:"map",is:"uniform"}},vertexShader:"\n    varying vec2 uvs;\n    varying vec3 worldPos;\n    void main() {\n      uvs.xy = uv.xy;\n      vec4 p = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n      worldPos = (modelMatrix * vec4( position, 1.0 )).xyz;\n      gl_Position = p;\n    }\n  ",fragmentShader:"\n    #define FOG_RADIUS  50.0\n    #define FOG_FALLOFF 45.0\n    varying vec2 uvs;\n    varying vec3 worldPos;\n    uniform vec3 color;\n    uniform vec3 fogColor;\n    uniform sampler2D src;\n\n    void main() {\n      vec4 col = texture2D(src, uvs);\n      col.xyz = mix(fogColor, col.xyz, clamp(distance(worldPos, vec3(0., 0., -FOG_RADIUS)) / FOG_FALLOFF, 0., 1.));\n      gl_FragColor = col;\n    }\n  "})},8287:()=>{AFRAME.registerComponent("stats-param",{init:function(){"true"===AFRAME.utils.getUrlParameter("stats")&&this.el.setAttribute("stats","")}})},4897:()=>{AFRAME.registerComponent("sub-object",{schema:{from:{type:"selector"},name:{type:"string"}},init:function(){var e=this.el,t=this.data;t.from.addEventListener("model-loaded",(i=>{const n=i.detail.model.getObjectByName(t.name);e.setObject3D("mesh",n.clone()),e.setAttribute("material","shader","flat"),e.emit("subobjectloaded",null,!1)}))}})},6211:()=>{var e={supersaber:{wrapCount:20,inputOffsetY:.008,inputOffsetX:.08,img:"keyboard.png",hoverImg:"keyboard-hover.png",layout:[{key:"1",x:.014,y:.024,w:.094,h:.183},{key:"2",x:.108,y:.024,w:.094,h:.183},{key:"3",x:.203,y:.024,w:.095,h:.183},{key:"4",x:.299,y:.024,w:.094,h:.183},{key:"5",x:.394,y:.024,w:.093,h:.183},{key:"6",x:.487,y:.024,w:.095,h:.183},{key:"7",x:.583,y:.024,w:.093,h:.183},{key:"8",x:.677,y:.024,w:.095,h:.183},{key:"9",x:.772,y:.024,w:.093,h:.183},{key:"0",x:.866,y:.024,w:.093,h:.183},{key:"q",x:.014,y:.215,w:.094,h:.183},{key:"w",x:.108,y:.215,w:.094,h:.183},{key:"e",x:.203,y:.215,w:.095,h:.183},{key:"r",x:.299,y:.215,w:.094,h:.183},{key:"t",x:.394,y:.215,w:.093,h:.183},{key:"y",x:.487,y:.215,w:.095,h:.183},{key:"i",x:.677,y:.215,w:.095,h:.183},{key:"u",x:.583,y:.215,w:.093,h:.183},{key:"o",x:.772,y:.215,w:.093,h:.183},{key:"p",x:.866,y:.215,w:.093,h:.183},{key:"a",x:.063,y:.405,w:.094,h:.183},{key:"s",x:.158,y:.405,w:.094,h:.183},{key:"d",x:.253,y:.405,w:.095,h:.183},{key:"f",x:.349,y:.405,w:.094,h:.183},{key:"g",x:.443,y:.405,w:.093,h:.183},{key:"h",x:.537,y:.405,w:.095,h:.183},{key:"j",x:.633,y:.405,w:.092,h:.183},{key:"k",x:.726,y:.405,w:.095,h:.183},{key:"l",x:.821,y:.405,w:.093,h:.183},{key:"z",x:.111,y:.598,w:.093,h:.181},{key:"x",x:.205,y:.598,w:.095,h:.181},{key:"c",x:.301,y:.598,w:.095,h:.181},{key:"v",x:.396,y:.598,w:.093,h:.181},{key:"b",x:.49,y:.598,w:.094,h:.181},{key:"n",x:.585,y:.598,w:.094,h:.181},{key:"m",x:.68,y:.598,w:.093,h:.181},{key:"Delete",x:.777,y:.598,w:.137,h:.181},{key:" ",x:.297,y:.788,w:.381,h:.201},{key:"Escape",x:.013,y:.797,w:.137,h:.181},{key:"Insert",x:.014,y:-.001,w:.01,h:.005}]}};if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");var t={roboto:17,aileronsemibold:20,dejavu:20.5,exo2bold:20,exo2semibold:20.3,kelsonsans:22.8,monoid:19.5,mozillavr:9.5,sourcecodepro:20.3};function i(e,t){for(var i=0;i<e.length;i++)if(e[i].id===t)return e[i];return null}AFRAME.registerComponent("super-keyboard",{schema:{align:{default:"left",oneOf:["left","center","right"]},blinkingSpeed:{type:"int",default:400},filters:{type:"array"},font:{default:"aileronsemibold"},hand:{type:"selector"},imagePath:{default:"."},injectToRaycasterObjects:{default:!0},inputColor:{type:"color",default:"#6699ff"},interval:{type:"int",default:50},keyBgColor:{type:"color",default:"#000"},keyColor:{type:"color",default:"#6699ff"},keyHoverColor:{type:"color",default:"#1A407F"},keyPressColor:{type:"color",default:"#5290F6"},label:{type:"string",default:""},labelColor:{type:"color",default:"#aaa"},maxLength:{type:"int",default:0},model:{default:"basic"},show:{default:!0},value:{type:"string",default:""},width:{default:.8}},init:function(){this.el.addEventListener("click",this.click.bind(this)),this.changeEventDetail={},this.textInputObject={},this.keys=null,this.focused=!1,this.keyHover=null,this.prevCheckTime=null,this.shift=!1,this.rawValue=this.data.value,this.defaultValue=this.data.value,this.userFilterFunc=null,this.intervalId=0,this.kbImg=document.createElement("a-entity"),this.kbImg.classList.add("keyboardRaycastable"),this.kbImg.classList.add("superKeyboardImage"),this.kbImg.addEventListener("raycaster-intersected",this.hover.bind(this)),this.kbImg.addEventListener("raycaster-intersected-cleared",this.blur.bind(this)),this.el.appendChild(this.kbImg),this.label=document.createElement("a-entity"),this.label.setAttribute("text",{align:"center",font:this.data.font,baseline:"bottom",lineHeight:40,shader:"msdf",negate:!0,value:this.data.label,color:this.data.labelColor,width:this.data.width,wrapCount:30}),this.el.appendChild(this.label),this.textInput=document.createElement("a-entity"),this.textInput.setAttribute("mixin","superKeyboardTextInput"),this.textInput.setAttribute("text",{align:this.data.align,font:this.data.font,lineHeight:35,value:this.data.value,color:this.data.inputColor,width:this.data.width,wrapCount:20}),this.el.appendChild(this.textInput),this.cursor=document.createElement("a-entity"),this.cursor.object3D.position.set(0,0,.001),this.cursor.setAttribute("material",{shader:"flat",color:this.data.inputColor}),this.textInput.appendChild(this.cursor),this.cursorUpdated=!1,this.keyBgColor=new THREE.Color,this.keyHoverColor=new THREE.Color,this.keyPressColor=new THREE.Color;var e=this;document.addEventListener("keydown",(function(t){if("t"===t.key){for(var i="",n="abcdefghijklmopqrstuvQWIEUTGASDLIGKBXACQWETL102394676457",o=Math.floor(20*Math.random()),s=0;s<o;s++)i+=n[Math.floor(Math.random()*n.length)];e.el.setAttribute("super-keyboard",{value:i})}})),document.addEventListener("show",this.open.bind(this)),this.hand=null,this.handListenersSet=!1,this.raycaster=null},update:function(t){var i=e[this.data.model],n=this.data.width,o=this.data.width/2;if(void 0!==i){t&&this.defaultValue===t.defaultValue?this.updateTextInput(this.filter(this.rawValue)):(this.rawValue=this.data.value,this.defaultValue=this.data.value,this.updateTextInput(this.filter(this.data.value))),this.data.width===t.width&&this.data.height===t.height&&this.data.keyColor===t.keyColor||(this.kbImg.setAttribute("geometry",{primitive:"plane",width:n,height:o}),this.kbImg.setAttribute("material",{shader:"flat",src:this.data.imagePath+"/"+i.img,color:this.data.keyColor,transparent:!0})),this.data.label===t.label&&this.data.labelColor===t.labelColor&&this.data.width===t.width||(this.label.setAttribute("text",{value:this.data.label,color:this.data.labelColor,width:this.data.width}),this.label.object3D.position.set(0,.35*n,-.02)),this.data.width===t.width&&this.data.keyBgColor===t.keyBgColor||this.initKeyColorPlane();var s="center"!==this.data.align?i.inputOffsetX*n:0;"right"===this.data.align&&(s*=-1),this.data.font===t.font&&this.data.inputColor===t.inputColor&&this.data.width===t.width&&this.data.align===t.align||this.textInput.setAttribute("text",{font:this.data.font,color:this.data.inputColor,width:n,wrapCount:i.wrapCount,align:this.data.align});for(var a=0;a<i.layout.length;a++){var r=i.layout[a];"Insert"===r.key&&(this.inputRect=r)}this.textInput.object3D.position.set(s,n/4-(this.inputRect.y+this.inputRect.h/2)*n/2+i.inputOffsetY*n,.002),this.data.width!==t.width&&this.cursor.setAttribute("geometry",{primitive:"plane",width:.03*n,height:.01*n}),this.updateCursorPosition(),this.setupHand(),this.keyBgColor.set(this.data.keyBgColor),this.keyHoverColor.set(this.data.keyHoverColor),this.keyPressColor.set(this.data.keyPressColor),this.data.show?this.open():this.close()}else console.error('super-keyboard ERROR: model "'+this.data.model+'" undefined.')},tick:function(t){var i;if(!(this.prevCheckTime&&t-this.prevCheckTime<this.data.interval))if(this.prevCheckTime){if(this.raycaster&&this.focused&&(i=this.raycaster.getIntersection(this.kbImg)))for(var n=i.uv,o=e[this.data.model].layout,s=0;s<o.length;s++){var a=o[s];if(n.x>a.x&&n.x<a.x+a.w&&1-n.y>a.y&&1-n.y<a.y+a.h){this.keyHover!==a&&(this.keyHover=a,this.updateKeyColorPlane(this.keyHover.key,this.keyHoverColor));break}}}else this.prevCheckTime=t},play:function(){this.cursorUpdated&&this.startBlinking()},pause:function(){this.stopBlinking()},initKeyColorPlane:function(){var t=e[this.data.model],i=this.keyColorPlane=document.createElement("a-entity");i.classList.add("superKeyboardKeyColorPlane"),i.object3D.position.z=.001,i.object3D.visible=!1,i.setAttribute("geometry",{primitive:"plane",buffer:!1}),i.setAttribute("material",{shader:"flat",color:this.data.keyBgColor,transparent:!0}),t.hoverImg&&i.setAttribute("material",{src:this.data.imagePath+"/"+t.hoverImg}),i.addEventListener("componentinitialized",(function(e){"material"===e.detail.name&&(t.hoverImg||(this.getObject3D("mesh").material.blending=THREE.AdditiveBlending))})),this.el.appendChild(i)},updateKeyColorPlane:function(t,i){var n=e[this.data.model],o=this.keyColorPlane;if(t){for(var s=0;s<n.layout.length;s++){var a=n.layout[s];if(a.key===t){var r=this.data.width,l=this.data.width/2,c=r/2,d=l/2,h=a.w*r,u=a.h*l;o.object3D.scale.x=h,o.object3D.scale.y=u,o.object3D.position.x=a.x*r-c+h/2,o.object3D.position.y=(1-a.y)*l-d-u/2,o.getObject3D("mesh").material.color.copy(i);var f=o.getObject3D("mesh").geometry,m=f.faceVertexUvs[0],p=1-a.y;m[0][0].set(a.x,p),m[0][1].set(a.x,p-a.h),m[0][2].set(a.x+a.w,p),m[1][0].set(a.x,p-a.h),m[1][1].set(a.x+a.w,p-a.h),m[1][2].set(a.x+a.w,p),f.uvsNeedUpdate=!0;break}}o.object3D.visible=!0}else o.object3D.visible=!1},setupHand:function(){if(this.hand&&this.hand.ownRaycaster&&this.hand.removeAttribute("raycaster"),this.data.hand?this.hand=this.data.hand:this.hand=document.querySelector(["[cursor]","[vive-controls]","[tracked-controls]","[oculus-touch-controls]","[windows-motion-controls]","[hand-controls]","[daydream-controls] [cursor] > [raycaster]"].join(",")),this.hand){if(!this.hand.hasLoaded)return void this.hand.addEventListener("loaded",this.setupHand.bind(this));var e=this.hand.components.raycaster,t={};if(e){if(this.hand.ownRaycaster=!1,this.data.injectToRaycasterObjects){var i=e.data.objects.split(",");-1===i.indexOf(".keyboardRaycastable")&&i.push(".keyboardRaycastable"),t.objects=i.join(",").replace(/^,/,""),this.hand.setAttribute("raycaster",t)}}else this.hand.ownRaycaster=!0,t.showLine=this.data.show,t.enabled=this.data.show,this.data.injectToRaycasterObjects&&(t.objects=".keyboardRaycastable"),this.hand.setAttribute("raycaster",t);this.raycaster=this.hand.components.raycaster}else console.error('super-keyboard: no controller found. Add <a-entity> with controller or specify with super-keyboard="hand: #selectorToController".')},filter:function(e){if(""===e)return"";for(var t=0;t<this.data.filters.length;t++)switch(this.data.filters[t]){case"custom":this.userFilterFunc&&(e=this.userFilterFunc(e));break;case"allupper":e=e.toUpperCase();break;case"alllower":e=e.toLowerCase();break;case"title":e=e.split(" ").map((function(e){return e[0].toUpperCase()+e.substr(1)})).join(" ");break;case"numbers":e=e.split("").filter((function(e){return!isNaN(parseInt(e))||"."===e})).join("");break;case"first":e=e[0].toUpperCase()+e.substr(1);break;case"trim":e=e.trim()}return this.data.maxLength>0?e.substr(0,this.data.maxLength):e},click:function(e){if(this.keyHover){switch(this.keyHover.key){case"Enter":this.accept();break;case"Insert":return;case"Delete":this.rawValue=this.rawValue.substr(0,this.rawValue.length-1);var t=this.filter(this.rawValue);this.el.setAttribute("super-keyboard","value",t),this.updateTextInput(t),this.changeEventDetail.value=t,this.el.emit("superkeyboardchange",this.changeEventDetail);break;case"Shift":this.shift=!this.shift,this.keyHover.el.setAttribute("material","color",this.shift?this.data.keyHoverColor:this.data.keyBgColor);break;case"Escape":this.dismiss();break;default:if(this.data.maxLength>0&&this.rawValue.length>this.data.maxLength)break;this.rawValue+=this.shift?this.keyHover.key.toUpperCase():this.keyHover.key,t=this.filter(this.rawValue),this.el.setAttribute("super-keyboard","value",t),this.updateTextInput(t),this.changeEventDetail.value=t,this.el.emit("superkeyboardchange",this.changeEventDetail)}this.updateKeyColorPlane(this.keyHover.key,this.keyPressColor);var i=this;setTimeout((function(){i.updateKeyColorPlane(i.keyHover.key,i.keyHoverColor)}),100),this.updateCursorPosition()}},open:function(){this.el.object3D.visible=!0,this.hand&&this.hand.ownRaycaster&&this.hand.setAttribute("raycaster",{showLine:!0,enabled:!0})},close:function(){this.el.object3D.visible=!1,this.hand&&this.hand.ownRaycaster&&this.hand.setAttribute("raycaster",{showLine:!1,enabled:!1})},accept:function(){this.el.object3D.visible=!1,this.hand&&this.hand.ownRaycaster&&this.hand.setAttribute("raycaster",{showLine:!1,enabled:!1}),this.el.emit("superkeyboardinput",{value:this.data.value}),this.data.show=!1},dismiss:function(){this.data.value=this.defaultValue,this.updateTextInput(),this.el.object3D.visible=!1,this.hand&&this.hand.ownRaycaster&&this.hand.setAttribute("raycaster",{showLine:!1,enabled:!1}),this.el.emit("superkeyboarddismiss"),this.data.show=!1},blur:function(e){this.focused=!1,this.keyHover&&"Shift"!==this.keyHover.key&&this.updateKeyColorPlane(this.keyHover.key,this.keyBgColor),this.keyHover=null},hover:function(e){this.focused=!0},startBlinking:function(){this.stopBlinking(),this.intervalId=window.setInterval(this.blink.bind(this),this.data.blinkingSpeed)},stopBlinking:function(){window.clearInterval(this.intervalId),this.intervalId=0},blink:function(){this.cursor.object3D.visible=!this.cursor.object3D.visible},setCustomFilter:function(e){this.userFilterFunc=e},addCustomModel:function(t,i){t&&(e[t]=i)},updateCursorPosition:function(){var n=this.textInput.components.text.currentFont;if(!n){var o=this;return this.cursor.object3D.visible=!1,void window.setTimeout((function(){o.updateCursorPosition(),o.startBlinking()}),700)}var s=this.data.width,a=e[this.data.model],r=-this.inputRect.h/2*s/2.4+a.inputOffsetY*s,l=this.data.width/this.textInput.components.text.data.wrapCount,c=0,d=t[this.textInput.components.text.data.font];void 0===d&&(d=20);for(var h=0;h<this.data.value.length;h++){var u=i(n.chars,this.data.value.charCodeAt(h));c+=u.width+u.xadvance*(32===u.id?2:1)}"center"===this.data.align?c=c*l*d*.0011/2+.02*s:"left"===this.data.align?(c=c*l*d*.0011+.02*s,c-=s/2):"right"===this.data.align&&(c=-c*l*d*.0011-.02*s,c+=s/2),this.cursor.object3D.position.set(c,r,.001),this.cursorUpdated=!0},updateTextInput:function(e){this.textInputObject.value=e||this.data.value,this.textInput.setAttribute("text",this.textInputObject)}})},4524:()=>{AFRAME.registerComponent("toggle-pause-play",{schema:{isPlaying:{default:!1}},update:function(){const e=this.data.isPlaying?"pause":"play";parent.postMessage(JSON.stringify({verify:"game-action",action:e}),"*")}})},5417:()=>{AFRAME.registerComponent("twister",{schema:{enabled:{default:!1},twist:{default:0},vertices:{default:4,type:"int"},count:{default:12,type:"int"},positionIncrement:{default:1.4},radiusIncrement:{default:.4},thickness:{default:.37}},init:function(){this.currentTwist=0,this.animate=!1,this.geometry=null},pulse:function(e){this.data.enabled&&(e=0==e?.03+.25*Math.random():Math.min(.4*e,.4),e*=Math.random()<.5?-1:1,this.el.setAttribute("twister",{twist:e}))},update:function(e){var t=6,i=[];if(Math.abs(this.data.twist-this.currentTwist)>.001)this.animate=!0;else{this.clear();for(var n=0;n<this.data.count;n++){let e=this.createSegment(t);e.translate(0,this.data.positionIncrement*n,0),i.push(e),t+=this.data.radiusIncrement}this.geometry=THREE.BufferGeometryUtils.mergeBufferGeometries(i);var o=this.el.sceneEl.systems.materials.stageNormal,s=new THREE.Mesh(this.geometry,o);this.el.object3D.add(s)}},createSegment:function(e){const t=this.data.thickness;var i,n=[new THREE.Vector2(e-t,t),new THREE.Vector2(e-t,-t),new THREE.Vector2(e+t,-t),new THREE.Vector2(e+t,t),new THREE.Vector2(e-t,t)];i=new THREE.LatheBufferGeometry(n,this.data.vertices);for(let e=0;e<i.attributes.uv.array.length;e+=2)i.attributes.uv.array[e]=.77,i.attributes.uv.array[e+1]=.001;return i},clear:function(){this.el.object3D.remove(this.el.object3D.children[0]),this.geometry&&this.geometry.dispose(),this.geometry=new THREE.BufferGeometry},tick:function(e,t){if(this.animate){var i,n,o,s,a,r,l=this.geometry.attributes.position.array;t*=.001,r=(this.data.twist-this.currentTwist)*t,this.currentTwist+=r,i=3*r;for(var c=0;c<this.data.count;c++){for(var d=0;d<75;d+=3)a=Math.cos(i),s=Math.sin(i),n=l[75*c+d],o=l[75*c+d+2],l[75*c+d]=n*a-o*s,l[75*c+d+2]=o*a+n*s;i*=1.05}this.geometry.attributes.position.needsUpdate=!0,Math.abs(this.data.twist-this.currentTwist)<.001&&(this.animate=!1)}}})},8020:()=>{AFRAME.registerComponent("user-gesture",{play:function(){document.addEventListener("click",(e=>{e.target.closest("#controls")||this.el.sceneEl.emit("usergesturereceive",null,!1)}))}})},6900:()=>{var e=new THREE.Color;AFRAME.registerComponent("vertex-colors-buffer",{schema:{baseColor:{type:"color"},itemSize:{default:3}},update:function(t){var i,n,o,s,a=this.data,r=this.el,l=this;if((s=this.el.getObject3D("mesh"))&&s.geometry)if((o=s.geometry).attributes.position){for(o.attributes.color||o.addAttribute("color",new THREE.BufferAttribute(new Float32Array(o.attributes.position.array.length),3)),i=o.attributes.color.array,e.set(a.baseColor),n=0;n<i.length;n+=a.itemSize)i[n]=e.r,i[n+1]=e.g,i[n+2]=e.b;o.attributes.color.needsUpdate=!0}else console.warn("Geometry has no vertices",r);else r.addEventListener("object3dset",(function e(i){"mesh"===i.detail.type&&(r.removeEventListener("object3dset",e),l.update(t))}))}})},8077:()=>{AFRAME.registerComponent("visible-raycastable",{schema:{default:!0},update:function(){this.el.object3D.visible=this.data,this.data?this.el.setAttribute("raycastable",""):this.el.removeAttribute("raycastable","")}})},8236:(e,t,i)=>{const n=i(9133),o=new THREE.Color(n.NEON_RED),s=new THREE.Color(n.SKY_RED);AFRAME.registerShader("wallShader",{schema:{iTime:{type:"time",is:"uniform"},hitRight:{type:"vec3",is:"uniform",default:{x:0,y:1,z:0}},hitLeft:{type:"vec3",is:"uniform",default:{x:0,y:0,z:0}}},vertexShader:"\n    varying vec2 uvs;\n    varying vec3 nrml;\n    varying vec3 worldPos;\n    void main() {\n      uvs.xy = uv.xy;\n      nrml.xyz = normal.xyz;\n      vec4 p = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n      worldPos = (modelMatrix * vec4( position, 1.0 )).xyz;\n      gl_Position = p;\n    }\n  ",fragmentShader:`\n    varying vec2 uvs;\n    varying vec3 nrml;\n    varying vec3 worldPos;\n    uniform float iTime;\n    //uniform sampler2D env;\n    uniform vec3 hitRight;\n    uniform vec3 hitLeft;\n\n    #define SEED 19.1254\n    #define time (3.0 + iTime)/1000.0 * 0.15\n\n    float noise(vec3 uv) {\n      return fract(sin(uv.x*123243. + uv.y*424. + uv.z*642. + SEED) * 1524.);\n    }\n\n    vec3 drawCircle(vec3 p, vec3 center, float radius, float edgeWidth, vec3 color) {\n      return color * (1.0 - smoothstep(radius, radius + edgeWidth, length(p - center)));\n    }\n\n    float smoothNoise(vec3 uvw, float frec){\n      vec3 luvw = vec3(smoothstep(0.0, 1.0, fract(uvw.xy * frec)), fract(uvw.z * frec));\n      vec3 id = floor(uvw * frec);\n      float blt = noise(id);\n      float brt = noise(id + vec3(1.0, 0.0, 0.0));\n      float tlt = noise(id + vec3(0.0, 1.0, 0.0));\n      float trt = noise(id + vec3(1.0, 1.0, 0.0));\n\n      float blb = noise(id + vec3(0.0, 0.0, 1.0));\n      float brb = noise(id + vec3(1.0, 0.0, 1.0));\n      float tlb = noise(id + vec3(0.0, 1.0, 1.0));\n      float trb = noise(id + vec3(1.0, 1.0, 1.0));\n\n      float a = mix(blt, brt, luvw.x);\n      float b = mix(tlt, trt, luvw.x);\n      float c = mix(a, b, luvw.y);\n\n      float d = mix(blb, brb, luvw.x);\n      float e = mix(tlb, trb, luvw.x);\n      float f = mix(d, e, luvw.y);\n\n      return mix(c, f, luvw.z);\n    }\n\n    #define WALL_COLOR vec3(${o.r}, ${o.g}, ${o.b})\n    #define WALL_BG vec3(${s.r}, ${s.g}, ${s.b})\n\n    void main() {\n      vec2 uv1 = uvs.xy-0.5;\n      float angle = time / 10.0;\n      vec2 uv;\n      uv.x = uv1.x * cos(angle) - uv1.y * sin(angle);\n      uv.y = uv1.y * cos(angle) + uv1.x * sin(angle);\n      uv.x += sin(uv.y * 2.7 + time / 1.7) * 0.2;\n      uv.y += sin(uv.x * 3.1 + time / 2.4) * 0.3;\n\n      float w, r, bg;\n      r = smoothNoise(vec3(uv + worldPos.x, time / 2.0), 3.0) * 0.65;\n      r += smoothNoise(vec3(uv, time / 6.0), 8.0) * 0.3;\n      r += smoothNoise(vec3(uv, time / 14.0), 50.0) * 0.04;\n\n      bg = smoothstep(0.5, 1.0, r) + smoothstep(0.5, 0.0, r);\n      r = smoothstep(0.4, 0.50, r) - smoothstep(0.50, 0.6, r);\n      w = smoothstep(0.97, 1.0, r);\n\n\n      r += smoothstep(0.44, 0.50, abs(uv1.x));\n      r += smoothstep(0.44, 0.50, abs(uv1.y));\n\n      w += smoothstep(0.49, 0.498, abs(uv1.x));\n      w += smoothstep(0.49, 0.498, abs(uv1.y));\n\n      w *= 0.9;\n      bg *= 0.5;\n\n      vec3 COL = WALL_COLOR;\n      vec3 BG = WALL_BG * 0.1;\n\n      vec3 col = vec3(r * COL.r + w + BG.r, r * COL.g + w + BG.g, r * COL.b + w + BG.b);\n\n      vec3 hit;\n      hit = drawCircle(worldPos, hitRight, 0.04, 0.05, COL);\n      hit += drawCircle(worldPos, hitRight, 0.02, 0.03, vec3(0.7, 0.7, 0.7));\n      hit += drawCircle(worldPos, hitLeft, 0.04, 0.05, COL);\n      hit += drawCircle(worldPos, hitLeft, 0.02, 0.03, vec3(0.7, 0.7, 0.7));\n\n      gl_FragColor = vec4(col + hit, 0.7 + w + hit.x);\n    }\n`})},433:(e,t,i)=>{"use strict";i.r(t);var n=i(5501);AFRAME.registerComponent("wall",{schema:{anticipationPosition:{default:0},durationSeconds:{default:0},height:{default:1.3},horizontalPosition:{default:"middleleft",oneOf:["left","middleleft","middleright","right"]},isCeiling:{default:!1},speed:{default:1},warmupPosition:{default:0},width:{default:1}},horizontalPositions:{left:-.75,middleleft:-.25,middleright:.25,right:.75},init:function(){this.maxZ=10},update:function(){const e=this.el,t=this.data,i=t.width,n=t.durationSeconds*t.speed/2;if(t.isCeiling)return e.object3D.position.set(0,2.15,t.anticipationPosition+t.warmupPosition-n),void e.object3D.scale.set(4,1.5,t.durationSeconds*t.speed);e.object3D.position.set(this.horizontalPositions[t.horizontalPosition]+i/2-.25,t.height+.15,t.anticipationPosition+t.warmupPosition-n),e.object3D.scale.set(i,2.5,t.durationSeconds*t.speed)},pause:function(){this.el.object3D.visible=!1,this.el.removeAttribute("data-collidable-head")},play:function(){this.el.object3D.visible=!0,this.el.setAttribute("data-collidable-head","")},tock:function(e,t){const i=this.data,o=i.durationSeconds*i.speed/2,s=this.el.object3D.position;if(this.el.object3D.visible=!0,s.z<i.anticipationPosition-o){let e=s.z+n.G*(t/1e3);e<i.anticipationPosition-o?s.z=e:s.z=i.anticipationPosition-o}else s.z+=this.data.speed*(t/1e3);this.el.object3D.position.z>this.maxZ+o&&this.returnToPool()},returnToPool:function(){this.el.sceneEl.components.pool__wall.returnEntity(this.el),this.el.object3D.position.z=9999,this.el.pause(),this.el.removeAttribute("data-collidable-head")}})},2869:(e,t,i)=>{"use strict";i.r(t);var n,o=(function(e,t){var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var i=t.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(var o in i)n(i,o)&&(e[o]=i[o])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var o={arraySet:function(e,t,i,n,o){if(t.subarray&&e.subarray)e.set(t.subarray(i,i+n),o);else for(var s=0;s<n;s++)e[o+s]=t[i+s]},flattenChunks:function(e){var t,i,n,o,s,a;for(n=0,t=0,i=e.length;t<i;t++)n+=e[t].length;for(a=new Uint8Array(n),o=0,t=0,i=e.length;t<i;t++)s=e[t],a.set(s,o),o+=s.length;return a}},s={arraySet:function(e,t,i,n,o){for(var s=0;s<n;s++)e[o+s]=t[i+s]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,o)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,s))},t.setTyped(i)}(n={exports:{}},n.exports),n.exports);o.assign,o.shrinkBuf,o.setTyped,o.Buf8,o.Buf16,o.Buf32;var s=function(e,t,i,n){for(var o=65535&e|0,s=e>>>16&65535|0,a=0;0!==i;){i-=a=i>2e3?2e3:i;do{s=s+(o=o+t[n++]|0)|0}while(--a);o%=65521,s%=65521}return o|s<<16|0},a=function(){for(var e,t=[],i=0;i<256;i++){e=i;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t}(),r=function(e,t,i,n){var o=a,s=n+i;e^=-1;for(var r=n;r<s;r++)e=e>>>8^o[255&(e^t[r])];return-1^e},l=function(e,t){var i,n,o,s,a,r,l,c,d,h,u,f,m,p,g,b,y,v,E,x,w,A,k,T,R;i=e.state,n=e.next_in,T=e.input,o=n+(e.avail_in-5),s=e.next_out,R=e.output,a=s-(t-e.avail_out),r=s+(e.avail_out-257),l=i.dmax,c=i.wsize,d=i.whave,h=i.wnext,u=i.window,f=i.hold,m=i.bits,p=i.lencode,g=i.distcode,b=(1<<i.lenbits)-1,y=(1<<i.distbits)-1;e:do{m<15&&(f+=T[n++]<<m,m+=8,f+=T[n++]<<m,m+=8),v=p[f&b];t:for(;;){if(f>>>=E=v>>>24,m-=E,0==(E=v>>>16&255))R[s++]=65535&v;else{if(!(16&E)){if(0==(64&E)){v=p[(65535&v)+(f&(1<<E)-1)];continue t}if(32&E){i.mode=12;break e}e.msg="invalid literal/length code",i.mode=30;break e}x=65535&v,(E&=15)&&(m<E&&(f+=T[n++]<<m,m+=8),x+=f&(1<<E)-1,f>>>=E,m-=E),m<15&&(f+=T[n++]<<m,m+=8,f+=T[n++]<<m,m+=8),v=g[f&y];i:for(;;){if(f>>>=E=v>>>24,m-=E,!(16&(E=v>>>16&255))){if(0==(64&E)){v=g[(65535&v)+(f&(1<<E)-1)];continue i}e.msg="invalid distance code",i.mode=30;break e}if(w=65535&v,m<(E&=15)&&(f+=T[n++]<<m,(m+=8)<E&&(f+=T[n++]<<m,m+=8)),(w+=f&(1<<E)-1)>l){e.msg="invalid distance too far back",i.mode=30;break e}if(f>>>=E,m-=E,w>(E=s-a)){if((E=w-E)>d&&i.sane){e.msg="invalid distance too far back",i.mode=30;break e}if(A=0,k=u,0===h){if(A+=c-E,E<x){x-=E;do{R[s++]=u[A++]}while(--E);A=s-w,k=R}}else if(h<E){if(A+=c+h-E,(E-=h)<x){x-=E;do{R[s++]=u[A++]}while(--E);if(A=0,h<x){x-=E=h;do{R[s++]=u[A++]}while(--E);A=s-w,k=R}}}else if(A+=h-E,E<x){x-=E;do{R[s++]=u[A++]}while(--E);A=s-w,k=R}for(;x>2;)R[s++]=k[A++],R[s++]=k[A++],R[s++]=k[A++],x-=3;x&&(R[s++]=k[A++],x>1&&(R[s++]=k[A++]))}else{A=s-w;do{R[s++]=R[A++],R[s++]=R[A++],R[s++]=R[A++],x-=3}while(x>2);x&&(R[s++]=R[A++],x>1&&(R[s++]=R[A++]))}break}}break}}while(n<o&&s<r);n-=x=m>>3,f&=(1<<(m-=x<<3))-1,e.next_in=n,e.next_out=s,e.avail_in=n<o?o-n+5:5-(n-o),e.avail_out=s<r?r-s+257:257-(s-r),i.hold=f,i.bits=m},c=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],d=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],h=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],u=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],f=function(e,t,i,n,s,a,r,l){var f,m,p,g,b,y,v,E,x,w=l.bits,A=0,k=0,T=0,R=0,C=0,S=0,M=0,P=0,D=0,_=0,B=null,j=0,O=new o.Buf16(16),L=new o.Buf16(16),H=null,I=0;for(A=0;A<=15;A++)O[A]=0;for(k=0;k<n;k++)O[t[i+k]]++;for(C=w,R=15;R>=1&&0===O[R];R--);if(C>R&&(C=R),0===R)return s[a++]=20971520,s[a++]=20971520,l.bits=1,0;for(T=1;T<R&&0===O[T];T++);for(C<T&&(C=T),P=1,A=1;A<=15;A++)if(P<<=1,(P-=O[A])<0)return-1;if(P>0&&(0===e||1!==R))return-1;for(L[1]=0,A=1;A<15;A++)L[A+1]=L[A]+O[A];for(k=0;k<n;k++)0!==t[i+k]&&(r[L[t[i+k]]++]=k);if(0===e?(B=H=r,y=19):1===e?(B=c,j-=257,H=d,I-=257,y=256):(B=h,H=u,y=-1),_=0,k=0,A=T,b=a,S=C,M=0,p=-1,g=(D=1<<C)-1,1===e&&D>852||2===e&&D>592)return 1;for(;;){v=A-M,r[k]<y?(E=0,x=r[k]):r[k]>y?(E=H[I+r[k]],x=B[j+r[k]]):(E=96,x=0),f=1<<A-M,T=m=1<<S;do{s[b+(_>>M)+(m-=f)]=v<<24|E<<16|x|0}while(0!==m);for(f=1<<A-1;_&f;)f>>=1;if(0!==f?(_&=f-1,_+=f):_=0,k++,0==--O[A]){if(A===R)break;A=t[i+r[k]]}if(A>C&&(_&g)!==p){for(0===M&&(M=C),b+=T,P=1<<(S=A-M);S+M<R&&!((P-=O[S+M])<=0);)S++,P<<=1;if(D+=1<<S,1===e&&D>852||2===e&&D>592)return 1;s[p=_&g]=C<<24|S<<16|b-a|0}}return 0!==_&&(s[b+_]=A-M<<24|64<<16|0),l.bits=C,0},m=-2,p=12,g=30;function b(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function y(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new o.Buf16(320),this.work=new o.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function v(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new o.Buf32(852),t.distcode=t.distdyn=new o.Buf32(592),t.sane=1,t.back=-1,0):m}function E(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,v(e)):m}function x(e,t){var i,n;return e&&e.state?(n=e.state,t<0?(i=0,t=-t):(i=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?m:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=i,n.wbits=t,E(e))):m}function w(e,t){var i,n;return e?(n=new y,e.state=n,n.window=null,0!==(i=x(e,t))&&(e.state=null),i):m}var A,k,T=!0;function R(e){if(T){var t;for(A=new o.Buf32(512),k=new o.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(f(1,e.lens,0,288,A,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;f(2,e.lens,0,32,k,0,e.work,{bits:5}),T=!1}e.lencode=A,e.lenbits=9,e.distcode=k,e.distbits=5}function C(e,t,i,n){var s,a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new o.Buf8(a.wsize)),n>=a.wsize?(o.arraySet(a.window,t,i-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):((s=a.wsize-a.wnext)>n&&(s=n),o.arraySet(a.window,t,i-n,s,a.wnext),(n-=s)?(o.arraySet(a.window,t,i-n,n,0),a.wnext=n,a.whave=a.wsize):(a.wnext+=s,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=s))),0}var S={inflateReset:E,inflateReset2:x,inflateResetKeep:v,inflateInit:function(e){return w(e,15)},inflateInit2:w,inflate:function(e,t){var i,n,a,c,d,h,u,y,v,E,x,w,A,k,T,S,M,P,D,_,B,j,O,L,H=0,I=new o.Buf8(4),F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return m;(i=e.state).mode===p&&(i.mode=13),d=e.next_out,a=e.output,u=e.avail_out,c=e.next_in,n=e.input,h=e.avail_in,y=i.hold,v=i.bits,E=h,x=u,j=0;e:for(;;)switch(i.mode){case 1:if(0===i.wrap){i.mode=13;break}for(;v<16;){if(0===h)break e;h--,y+=n[c++]<<v,v+=8}if(2&i.wrap&&35615===y){i.check=0,I[0]=255&y,I[1]=y>>>8&255,i.check=r(i.check,I,2,0),y=0,v=0,i.mode=2;break}if(i.flags=0,i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&y)<<8)+(y>>8))%31){e.msg="incorrect header check",i.mode=g;break}if(8!=(15&y)){e.msg="unknown compression method",i.mode=g;break}if(v-=4,B=8+(15&(y>>>=4)),0===i.wbits)i.wbits=B;else if(B>i.wbits){e.msg="invalid window size",i.mode=g;break}i.dmax=1<<B,e.adler=i.check=1,i.mode=512&y?10:p,y=0,v=0;break;case 2:for(;v<16;){if(0===h)break e;h--,y+=n[c++]<<v,v+=8}if(i.flags=y,8!=(255&i.flags)){e.msg="unknown compression method",i.mode=g;break}if(57344&i.flags){e.msg="unknown header flags set",i.mode=g;break}i.head&&(i.head.text=y>>8&1),512&i.flags&&(I[0]=255&y,I[1]=y>>>8&255,i.check=r(i.check,I,2,0)),y=0,v=0,i.mode=3;case 3:for(;v<32;){if(0===h)break e;h--,y+=n[c++]<<v,v+=8}i.head&&(i.head.time=y),512&i.flags&&(I[0]=255&y,I[1]=y>>>8&255,I[2]=y>>>16&255,I[3]=y>>>24&255,i.check=r(i.check,I,4,0)),y=0,v=0,i.mode=4;case 4:for(;v<16;){if(0===h)break e;h--,y+=n[c++]<<v,v+=8}i.head&&(i.head.xflags=255&y,i.head.os=y>>8),512&i.flags&&(I[0]=255&y,I[1]=y>>>8&255,i.check=r(i.check,I,2,0)),y=0,v=0,i.mode=5;case 5:if(1024&i.flags){for(;v<16;){if(0===h)break e;h--,y+=n[c++]<<v,v+=8}i.length=y,i.head&&(i.head.extra_len=y),512&i.flags&&(I[0]=255&y,I[1]=y>>>8&255,i.check=r(i.check,I,2,0)),y=0,v=0}else i.head&&(i.head.extra=null);i.mode=6;case 6:if(1024&i.flags&&((w=i.length)>h&&(w=h),w&&(i.head&&(B=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Array(i.head.extra_len)),o.arraySet(i.head.extra,n,c,w,B)),512&i.flags&&(i.check=r(i.check,n,w,c)),h-=w,c+=w,i.length-=w),i.length))break e;i.length=0,i.mode=7;case 7:if(2048&i.flags){if(0===h)break e;w=0;do{B=n[c+w++],i.head&&B&&i.length<65536&&(i.head.name+=String.fromCharCode(B))}while(B&&w<h);if(512&i.flags&&(i.check=r(i.check,n,w,c)),h-=w,c+=w,B)break e}else i.head&&(i.head.name=null);i.length=0,i.mode=8;case 8:if(4096&i.flags){if(0===h)break e;w=0;do{B=n[c+w++],i.head&&B&&i.length<65536&&(i.head.comment+=String.fromCharCode(B))}while(B&&w<h);if(512&i.flags&&(i.check=r(i.check,n,w,c)),h-=w,c+=w,B)break e}else i.head&&(i.head.comment=null);i.mode=9;case 9:if(512&i.flags){for(;v<16;){if(0===h)break e;h--,y+=n[c++]<<v,v+=8}if(y!==(65535&i.check)){e.msg="header crc mismatch",i.mode=g;break}y=0,v=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),e.adler=i.check=0,i.mode=p;break;case 10:for(;v<32;){if(0===h)break e;h--,y+=n[c++]<<v,v+=8}e.adler=i.check=b(y),y=0,v=0,i.mode=11;case 11:if(0===i.havedict)return e.next_out=d,e.avail_out=u,e.next_in=c,e.avail_in=h,i.hold=y,i.bits=v,2;e.adler=i.check=1,i.mode=p;case p:if(5===t||6===t)break e;case 13:if(i.last){y>>>=7&v,v-=7&v,i.mode=27;break}for(;v<3;){if(0===h)break e;h--,y+=n[c++]<<v,v+=8}switch(i.last=1&y,v-=1,3&(y>>>=1)){case 0:i.mode=14;break;case 1:if(R(i),i.mode=20,6===t){y>>>=2,v-=2;break e}break;case 2:i.mode=17;break;case 3:e.msg="invalid block type",i.mode=g}y>>>=2,v-=2;break;case 14:for(y>>>=7&v,v-=7&v;v<32;){if(0===h)break e;h--,y+=n[c++]<<v,v+=8}if((65535&y)!=(y>>>16^65535)){e.msg="invalid stored block lengths",i.mode=g;break}if(i.length=65535&y,y=0,v=0,i.mode=15,6===t)break e;case 15:i.mode=16;case 16:if(w=i.length){if(w>h&&(w=h),w>u&&(w=u),0===w)break e;o.arraySet(a,n,c,w,d),h-=w,c+=w,u-=w,d+=w,i.length-=w;break}i.mode=p;break;case 17:for(;v<14;){if(0===h)break e;h--,y+=n[c++]<<v,v+=8}if(i.nlen=257+(31&y),y>>>=5,v-=5,i.ndist=1+(31&y),y>>>=5,v-=5,i.ncode=4+(15&y),y>>>=4,v-=4,i.nlen>286||i.ndist>30){e.msg="too many length or distance symbols",i.mode=g;break}i.have=0,i.mode=18;case 18:for(;i.have<i.ncode;){for(;v<3;){if(0===h)break e;h--,y+=n[c++]<<v,v+=8}i.lens[F[i.have++]]=7&y,y>>>=3,v-=3}for(;i.have<19;)i.lens[F[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,O={bits:i.lenbits},j=f(0,i.lens,0,19,i.lencode,0,i.work,O),i.lenbits=O.bits,j){e.msg="invalid code lengths set",i.mode=g;break}i.have=0,i.mode=19;case 19:for(;i.have<i.nlen+i.ndist;){for(;S=(H=i.lencode[y&(1<<i.lenbits)-1])>>>16&255,M=65535&H,!((T=H>>>24)<=v);){if(0===h)break e;h--,y+=n[c++]<<v,v+=8}if(M<16)y>>>=T,v-=T,i.lens[i.have++]=M;else{if(16===M){for(L=T+2;v<L;){if(0===h)break e;h--,y+=n[c++]<<v,v+=8}if(y>>>=T,v-=T,0===i.have){e.msg="invalid bit length repeat",i.mode=g;break}B=i.lens[i.have-1],w=3+(3&y),y>>>=2,v-=2}else if(17===M){for(L=T+3;v<L;){if(0===h)break e;h--,y+=n[c++]<<v,v+=8}v-=T,B=0,w=3+(7&(y>>>=T)),y>>>=3,v-=3}else{for(L=T+7;v<L;){if(0===h)break e;h--,y+=n[c++]<<v,v+=8}v-=T,B=0,w=11+(127&(y>>>=T)),y>>>=7,v-=7}if(i.have+w>i.nlen+i.ndist){e.msg="invalid bit length repeat",i.mode=g;break}for(;w--;)i.lens[i.have++]=B}}if(i.mode===g)break;if(0===i.lens[256]){e.msg="invalid code -- missing end-of-block",i.mode=g;break}if(i.lenbits=9,O={bits:i.lenbits},j=f(1,i.lens,0,i.nlen,i.lencode,0,i.work,O),i.lenbits=O.bits,j){e.msg="invalid literal/lengths set",i.mode=g;break}if(i.distbits=6,i.distcode=i.distdyn,O={bits:i.distbits},j=f(2,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,O),i.distbits=O.bits,j){e.msg="invalid distances set",i.mode=g;break}if(i.mode=20,6===t)break e;case 20:i.mode=21;case 21:if(h>=6&&u>=258){e.next_out=d,e.avail_out=u,e.next_in=c,e.avail_in=h,i.hold=y,i.bits=v,l(e,x),d=e.next_out,a=e.output,u=e.avail_out,c=e.next_in,n=e.input,h=e.avail_in,y=i.hold,v=i.bits,i.mode===p&&(i.back=-1);break}for(i.back=0;S=(H=i.lencode[y&(1<<i.lenbits)-1])>>>16&255,M=65535&H,!((T=H>>>24)<=v);){if(0===h)break e;h--,y+=n[c++]<<v,v+=8}if(S&&0==(240&S)){for(P=T,D=S,_=M;S=(H=i.lencode[_+((y&(1<<P+D)-1)>>P)])>>>16&255,M=65535&H,!(P+(T=H>>>24)<=v);){if(0===h)break e;h--,y+=n[c++]<<v,v+=8}y>>>=P,v-=P,i.back+=P}if(y>>>=T,v-=T,i.back+=T,i.length=M,0===S){i.mode=26;break}if(32&S){i.back=-1,i.mode=p;break}if(64&S){e.msg="invalid literal/length code",i.mode=g;break}i.extra=15&S,i.mode=22;case 22:if(i.extra){for(L=i.extra;v<L;){if(0===h)break e;h--,y+=n[c++]<<v,v+=8}i.length+=y&(1<<i.extra)-1,y>>>=i.extra,v-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=23;case 23:for(;S=(H=i.distcode[y&(1<<i.distbits)-1])>>>16&255,M=65535&H,!((T=H>>>24)<=v);){if(0===h)break e;h--,y+=n[c++]<<v,v+=8}if(0==(240&S)){for(P=T,D=S,_=M;S=(H=i.distcode[_+((y&(1<<P+D)-1)>>P)])>>>16&255,M=65535&H,!(P+(T=H>>>24)<=v);){if(0===h)break e;h--,y+=n[c++]<<v,v+=8}y>>>=P,v-=P,i.back+=P}if(y>>>=T,v-=T,i.back+=T,64&S){e.msg="invalid distance code",i.mode=g;break}i.offset=M,i.extra=15&S,i.mode=24;case 24:if(i.extra){for(L=i.extra;v<L;){if(0===h)break e;h--,y+=n[c++]<<v,v+=8}i.offset+=y&(1<<i.extra)-1,y>>>=i.extra,v-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){e.msg="invalid distance too far back",i.mode=g;break}i.mode=25;case 25:if(0===u)break e;if(w=x-u,i.offset>w){if((w=i.offset-w)>i.whave&&i.sane){e.msg="invalid distance too far back",i.mode=g;break}w>i.wnext?(w-=i.wnext,A=i.wsize-w):A=i.wnext-w,w>i.length&&(w=i.length),k=i.window}else k=a,A=d-i.offset,w=i.length;w>u&&(w=u),u-=w,i.length-=w;do{a[d++]=k[A++]}while(--w);0===i.length&&(i.mode=21);break;case 26:if(0===u)break e;a[d++]=i.length,u--,i.mode=21;break;case 27:if(i.wrap){for(;v<32;){if(0===h)break e;h--,y|=n[c++]<<v,v+=8}if(x-=u,e.total_out+=x,i.total+=x,x&&(e.adler=i.check=i.flags?r(i.check,a,x,d-x):s(i.check,a,x,d-x)),x=u,(i.flags?y:b(y))!==i.check){e.msg="incorrect data check",i.mode=g;break}y=0,v=0}i.mode=28;case 28:if(i.wrap&&i.flags){for(;v<32;){if(0===h)break e;h--,y+=n[c++]<<v,v+=8}if(y!==(4294967295&i.total)){e.msg="incorrect length check",i.mode=g;break}y=0,v=0}i.mode=29;case 29:j=1;break e;case g:j=-3;break e;case 31:return-4;case 32:default:return m}return e.next_out=d,e.avail_out=u,e.next_in=c,e.avail_in=h,i.hold=y,i.bits=v,(i.wsize||x!==e.avail_out&&i.mode<g&&(i.mode<27||4!==t))&&C(e,e.output,e.next_out,x-e.avail_out)?(i.mode=31,-4):(E-=e.avail_in,x-=e.avail_out,e.total_in+=E,e.total_out+=x,i.total+=x,i.wrap&&x&&(e.adler=i.check=i.flags?r(i.check,a,x,e.next_out-x):s(i.check,a,x,e.next_out-x)),e.data_type=i.bits+(i.last?64:0)+(i.mode===p?128:0)+(20===i.mode||15===i.mode?256:0),(0===E&&0===x||4===t)&&0===j&&(j=-5),j)},inflateEnd:function(e){if(!e||!e.state)return m;var t=e.state;return t.window&&(t.window=null),e.state=null,0},inflateGetHeader:function(e,t){var i;return e&&e.state?0==(2&(i=e.state).wrap)?m:(i.head=t,t.done=!1,0):m},inflateSetDictionary:function(e,t){var i,n=t.length;return e&&e.state?0!==(i=e.state).wrap&&11!==i.mode?m:11===i.mode&&s(1,t,n,0)!==i.check?-3:C(e,t,n,n)?(i.mode=31,-4):(i.havedict=1,0):m},inflateInfo:"pako inflate (from Nodeca project)"},M=!0,P=!0;try{String.fromCharCode.apply(null,[0])}catch(e){M=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){P=!1}for(var D=new o.Buf8(256),_=0;_<256;_++)D[_]=_>=252?6:_>=248?5:_>=240?4:_>=224?3:_>=192?2:1;D[254]=D[254]=1;var B=function(e){var t,i,n,s,a,r=e.length,l=0;for(s=0;s<r;s++)55296==(64512&(i=e.charCodeAt(s)))&&s+1<r&&56320==(64512&(n=e.charCodeAt(s+1)))&&(i=65536+(i-55296<<10)+(n-56320),s++),l+=i<128?1:i<2048?2:i<65536?3:4;for(t=new o.Buf8(l),a=0,s=0;a<l;s++)55296==(64512&(i=e.charCodeAt(s)))&&s+1<r&&56320==(64512&(n=e.charCodeAt(s+1)))&&(i=65536+(i-55296<<10)+(n-56320),s++),i<128?t[a++]=i:i<2048?(t[a++]=192|i>>>6,t[a++]=128|63&i):i<65536?(t[a++]=224|i>>>12,t[a++]=128|i>>>6&63,t[a++]=128|63&i):(t[a++]=240|i>>>18,t[a++]=128|i>>>12&63,t[a++]=128|i>>>6&63,t[a++]=128|63&i);return t},j=function(e,t){var i,n,s,a,r=t||e.length,l=new Array(2*r);for(n=0,i=0;i<r;)if((s=e[i++])<128)l[n++]=s;else if((a=D[s])>4)l[n++]=65533,i+=a-1;else{for(s&=2===a?31:3===a?15:7;a>1&&i<r;)s=s<<6|63&e[i++],a--;a>1?l[n++]=65533:s<65536?l[n++]=s:(s-=65536,l[n++]=55296|s>>10&1023,l[n++]=56320|1023&s)}return function(e,t){if(t<65537&&(e.subarray&&P||!e.subarray&&M))return String.fromCharCode.apply(null,o.shrinkBuf(e,t));for(var i="",n=0;n<t;n++)i+=String.fromCharCode(e[n]);return i}(l,n)},O=function(e,t){var i;for((t=t||e.length)>e.length&&(t=e.length),i=t-1;i>=0&&128==(192&e[i]);)i--;return i<0||0===i?t:i+D[e[i]]>t?i:t},L={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},H=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},I=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1},F=Object.prototype.toString;function z(e){if(!(this instanceof z))return new z(e);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new H,this.strm.avail_out=0;var i=S.inflateInit2(this.strm,t.windowBits);if(0!==i)throw new Error(L[i]);this.header=new I,S.inflateGetHeader(this.strm,this.header)}function N(e,t){var i=new z(t);if(i.push(e,!0),i.err)throw i.msg||L[i.err];return i.result}z.prototype.push=function(e,t){var i,n,s,a,r,l,c=this.strm,d=this.options.chunkSize,h=this.options.dictionary,u=!1;if(this.ended)return!1;n=t===~~t?t:!0===t?4:0,"string"==typeof e?c.input=function(e){for(var t=new o.Buf8(e.length),i=0,n=t.length;i<n;i++)t[i]=e.charCodeAt(i);return t}(e):"[object ArrayBuffer]"===F.call(e)?c.input=new Uint8Array(e):c.input=e,c.next_in=0,c.avail_in=c.input.length;do{if(0===c.avail_out&&(c.output=new o.Buf8(d),c.next_out=0,c.avail_out=d),2===(i=S.inflate(c,0))&&h&&(l="string"==typeof h?B(h):"[object ArrayBuffer]"===F.call(h)?new Uint8Array(h):h,i=S.inflateSetDictionary(this.strm,l)),-5===i&&!0===u&&(i=0,u=!1),1!==i&&0!==i)return this.onEnd(i),this.ended=!0,!1;c.next_out&&(0!==c.avail_out&&1!==i&&(0!==c.avail_in||4!==n&&2!==n)||("string"===this.options.to?(s=O(c.output,c.next_out),a=c.next_out-s,r=j(c.output,s),c.next_out=a,c.avail_out=d-a,a&&o.arraySet(c.output,c.output,s,a,0),this.onData(r)):this.onData(o.shrinkBuf(c.output,c.next_out)))),0===c.avail_in&&0===c.avail_out&&(u=!0)}while((c.avail_in>0||0===c.avail_out)&&1!==i);return 1===i&&(n=4),4===n?(i=S.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,0===i):2!==n||(this.onEnd(0),c.avail_out=0,!0)},z.prototype.onData=function(e){this.chunks.push(e)},z.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var U={Inflate:z,inflate:N,inflateRaw:function(e,t){return(t=t||{}).raw=!0,N(e,t)},ungzip:N},V=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dataView=new DataView(t),this.position=0}return e.prototype.skip=function(e){this.position+=e},e.prototype.readBytes=function(e){var t=4===e?"getUint32":2===e?"getUint16":"getUint8",i=this.position;return this.position+=e,this.dataView[t](i,!0)},e}(),G=function(e){for(var t=new V(e),i={};;){var n=t.readBytes(4);if(67324752!==n){if(33639248!==n)break;W(t)}else{var o=$(t);i[o.name]={buffer:o.buffer}}}return i},$=function(e){var t=0,i=void 0;e.skip(4);var n=e.readBytes(2);e.skip(8);var o=e.readBytes(4);e.skip(4);var s=e.readBytes(2),a=e.readBytes(2),r=[],l=new Uint8Array(o);for(t=0;t<s;t++)r.push(String.fromCharCode(e.readBytes(1)));for(e.skip(a),t=0;t<o;t++)l[t]=e.readBytes(1);switch(n){case 0:i=l;break;case 8:i=new Uint8Array(U.inflate(l,{raw:!0}));break;default:console.log(r.join("")+": unsupported compression type"),i=l}return{name:r.join(""),buffer:i}},W=function(e){e.skip(24);var t=e.readBytes(2),i=e.readBytes(2),n=e.readBytes(2);e.skip(12),e.skip(t),e.skip(i),e.skip(n)},q="function"==typeof Promise?Promise:function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(){};return t((function(){i()})),{then:function(e){i=e}}},K=0,Z=void 0;const X=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._id=K,this._listeners={},this.url=t,this.files=null,K++}return e.unzip=function(t){return new q((function(i){var n=new e,o=new FileReader;o.onload=function(e){var t=e.target.result;n.files=G(t),i(n)},t instanceof Blob&&o.readAsArrayBuffer(t)}))},e.prototype.load=function(){var e=this;return new q((function(t){var i=Date.now(),n=new XMLHttpRequest;n.open("GET",e.url,!0),n.responseType="arraybuffer",n.onprogress=function(t){e.dispatch({type:"progress",loaded:t.loaded,total:t.total,elapsedTime:Date.now()-i})},n.onload=function(){e.files=G(n.response),e.dispatch({type:"load",elapsedTime:Date.now()-i}),t()},n.onerror=function(t){e.dispatch({type:"error",error:t})},n.send()}))},e.prototype.extractAsBlobUrl=function(e,t){if(this.files[e].url)return this.files[e].url;var i=new Blob([this.files[e].buffer],{type:t});return this.files[e].url=URL.createObjectURL(i),this.files[e].url},e.prototype.extractAsText=function(e){var t=this.files[e].buffer;if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);for(var i="",n=0,o=t.length;n<o;n++)i+=String.fromCharCode(t[n]);return decodeURIComponent(escape(i))},e.prototype.extractAsJSON=function(e){return JSON.parse(this.extractAsText(e))},e.prototype.loadThreeJSON=function(e){var t=this,i=this.extractAsJSON(e),n=e.replace(/\/.+\.json$/,"/"),o="__ziploader_"+this._id+"__",s=new RegExp(o);return-1!==!Z.Loader.Handlers.handlers.indexOf(s)&&Z.Loader.Handlers.add(s,{load:function(e){return t.loadThreeTexture(e.replace(s,""))}}),Z.JSONLoader.prototype.parse(i,o+n)},e.prototype.loadThreeTexture=function(e){var t=new Z.Texture,i=/\.jpg$/.test(e)?"image/jpeg":/\.png$/.test(e)?"image/png":/\.gif$/.test(e)?"image/gif":void 0,n=new Blob([this.files[e].buffer],{type:i});return t.image=new Image,t.image.addEventListener("load",(function e(){t.needsUpdate=!0,t.image.removeEventListener("load",e),URL.revokeObjectURL(t.image.src)})),t.image.src=URL.createObjectURL(n),t},e.prototype.on=function(e,t){this._listeners[e]||(this._listeners[e]=[]),-1===this._listeners[e].indexOf(t)&&this._listeners[e].push(t)},e.prototype.off=function(e,t){var i=this._listeners[e];if(i){var n=i.indexOf(t);-1!==n&&i.splice(n,1)}},e.prototype.dispatch=function(e){var t=this._listeners[e.type];if(t){e.target=this;for(var i=t.length,n=0;n<i;n++)t[n].call(this,e)}},e.prototype.clear=function(e){if(e)return URL.revokeObjectURL(this.files[e].url),void delete this.files[e];for(var t in this.files)URL.revokeObjectURL(this.files[t].url);if(delete this.files,Z){var i="__ziploader_"+this._id+"__";Z.Loader.Handlers.handlers.some((function(e,t){if(e instanceof RegExp&&e.source===i)return Z.Loader.Handlers.handlers.splice(t,2),!0}))}},e.install=function(e){e.THREE&&(Z=e.THREE)},e}(),Y=(i(9853),AFRAME.utils.getUrlParameter("zip"));AFRAME.registerComponent("zip-loader",{schema:{id:{default:Y?"":AFRAME.utils.getUrlParameter("id")||"4a6"},isSafari:{default:!1},difficulty:{default:AFRAME.utils.getUrlParameter("difficulty")}},init:function(){this.fetchedZip="",this.hash=""},init:function(){Y&&this.fetchZip(Y)},update:function(e){this.data.id&&(e.id===this.data.id&&e.difficulty===this.data.difficulty||(this.fetchData(this.data.id),this.el.sceneEl.emit("cleargame",null,!1)),this.el.sceneEl.emit("challengeset",this.data.id))},play:function(){this.loadingIndicator=document.getElementById("challengeLoadingIndicator")},fetchData:function(e){return fetch(`https://beatsaver.com/api/maps/detail/${e}/`).then((e=>{e.json().then((e=>{this.hash=e.hash,this.el.sceneEl.emit("challengeimage",`https://beatsaver.com${e.coverURL}`),this.fetchZip(Y||`https://beatsaver.com/cdn/${this.data.id}/${this.hash}.zip`)}))}))},fetchZip:function(e){if(this.data.isSafari)return;if(this.isFetching===e||this.fetchedZip===this.data.id)return;this.el.emit("challengeloadstart",this.data.id,!1),this.isFetching=e;const t=new X(e);t.on("error",(e=>{this.el.emit("challengeloaderror",null),this.isFetching=""})),t.on("progress",(e=>{this.loadingIndicator.object3D.visible=!0,this.loadingIndicator.setAttribute("material","progress",e.loaded/e.total)})),t.on("load",(()=>{this.fetchedZip=this.data.id;const e={audio:"",beats:{},difficulties:null,id:this.data.id,image:"",info:""};Object.keys(t.files).forEach((i=>{i.endsWith("info.dat")&&(e.info=function(e){try{return"{"!==(e=(e=(e=e.trim()).replace(/\u0000/g,"").replace(/\u\d\d\d\d/g,"")).replace("\b"," "))[0]&&(e=e.substring(e.indexOf("{"),e.length)),ee(e,0)}catch(t){return console.log(t,e),null}}(t.extractAsText(i)))})),e.info.difficultyLevels=e.info._difficultyBeatmapSets[0]._difficultyBeatmaps;const i=e.info.difficultyLevels;e.difficulty||(e.difficulty=this.data.difficulty||i.sort((e=>e._diificultyRank))[0]._difficulty),e.difficulties=i.sort((e=>e._difficultyRank)).map((e=>e._difficulty)),Object.keys(t.files).forEach((n=>{for(let o=0;o<i.length;o++){let s=i[o]._difficulty;n.endsWith(`${s}.dat`)&&(e.beats[s]=t.extractAsJSON(n))}this.data.id||(n.endsWith("jpg")&&(e.image=t.extractAsBlobUrl(n,"image/jpg")),n.endsWith("png")&&(e.image=t.extractAsBlobUrl(n,"image/png"))),(n.endsWith("egg")||n.endsWith("ogg"))&&(e.audio=t.extractAsBlobUrl(n,"audio/ogg"))})),e.image||this.data.id||(e.image="assets/img/logo.png"),this.isFetching="",this.el.emit("challengeloadend",e,!1)})),t.load()}});const J=/column (\d+)/m,Q=/position (\d+)/m;function ee(e,t){try{return JSON.parse(e)}catch(i){let n=i.toString().match(J);if(n||(n=i.toString().match(Q)),!n)throw i;const o=parseInt(n[1]);return ee(e=(e=(e=e.replace(e[o],"x")).replace(e[o+1],"x")).replace(e[o+2],"x"),t+1)}}},5501:(e,t,i)=>{"use strict";i.d(t,{G:()=>n,Md:()=>o});const n=155,o=25/n*1e3},9133:e=>{e.exports={OFF:"#111",RED:"#ff3a7b",BLUE:"#08bfa2",UI_ACCENT:"#fff",UI_ACCENT2:"#f01978",SKY_OFF:"#297547",SKY_BLUE:"#840d42",SKY_RED:"#154136",BG_OFF:"#081a0f",BG_BLUE:"#379f5e",BG_BRIGHTBLUE:"#4fd983",BG_RED:"#ff1f81",BG_BRIGHTRED:"#ff6bb0",NEON_OFF:"#000",NEON_BLUE:"#008a70",NEON_BRIGHTBLUE:"#87c2ff",NEON_RED:"#f01978",NEON_BRIGHTRED:"#ff70b5",TEXT_OFF:"#000",TEXT_NORMAL:"#444",TEXT_BOLD:"#888",BEAT_RED:"#660338",BEAT_BLUE:"#036657",MINE_RED:"#1c060e",MINE_RED_EMISSION:"#2a0d1b",MINE_BLUE:"#011114",MINE_BLUE_EMISSION:"#072020"}},3783:e=>{e.exports=function(e,t){var i,n=0,o=[];return(i=new Audio(e)).volume=t,o.push(i),{play:function(){0===o[n].currentTime&&o[n].ended||((i=new Audio(e)).volume=t,o.push(i),n++),(0===o[n].currentTime||o[n].ended)&&o[n].play(),n=(n+1)%o.length}}}},2279:(e,t,i)=>{i(9853);const n={author:"Superman",difficulty:"Expert",id:"31",image:"assets/img/molerat.jpg",songName:"Friday",songSubName:"Rebecca Black"},o={audio:"",author:"",difficulty:"",id:"",image:"assets/img/logo.png",songName:"",songNameMedium:"",songNameShort:"",songSubName:"",songSubNameShort:""},s=-1!==navigator.userAgent.toLowerCase().indexOf("safari")&&-1===navigator.userAgent.toLowerCase().indexOf("chrome");function a(e,t){return e?e.length>=t?e.substring(0,t-2)+"..":e:""}AFRAME.registerState({initialState:{challenge:Object.assign({hasLoadError:s,isLoading:!1,isBeatsPreloaded:!1,loadErrorText:s?"iOS and Safari support coming soon! We need to convert songs to MP3 first.":""},o),hasReceivedUserGesture:!1,inVR:!1,isPaused:!1,isPlaying:!1,isSafari:s,isSongBufferProcessing:!1},handlers:{beatloaderpreloadfinish:e=>{e.challenge.isBeatsPreloaded=!0},challengeimage:(e,t)=>{e.challenge.image=t},challengeloadstart:(e,t)=>{e.challenge.isLoading=!0},challengeloadend:(e,t)=>{e.challenge.audio=t.audio,e.challenge.author=t.info._levelAuthorName,e.challenge.difficulty&&-1!==t.difficulties.indexOf(e.challenge.difficulty)||(e.challenge.difficulty=t.difficulty),e.challenge.id=t.id,t.image&&(e.challenge.image=t.image),e.challenge.isLoading=!1,e.challenge.songName=t.info._songName,e.challenge.songNameShort=a(t.info._songName,18),e.challenge.songNameMedium=a(t.info._songName,30),e.challenge.songSubName=t.info._songSubName,e.challenge.songSubNameShort=a(t.info._songSubName,21)},challengeloaderror:(e,t)=>{e.challenge.hasLoadError=!0,e.challenge.isLoading=!1,e.challenge.loadErrorText=`Sorry, song ${AFRAME.utils.getUrlParameter("id")} was not found or ZIP requires CORS headers.`},controllerconnected:(e,t)=>{e.controllerType=t.name},debugloading:e=>{n.id="-1",Object.assign(e.challenge,n),e.challenge.isLoading=!0},difficultyselect:(e,t)=>{e.challenge.difficulty=t,e.challenge.isBeatsPreloaded=!1,e.isPaused=!1},gamemenuresume:e=>{e.isPaused=!1},gamemenurestart:e=>{e.challenge.isBeatsPreloaded=!1,e.isPaused=!1,e.isSongBufferProcessing=!0},pausegame:e=>{e.isPlaying&&(e.isPaused=!0)},songprocessingfinish:e=>{e.isSongBufferProcessing=!1},songprocessingstart:e=>{e.isSongBufferProcessing=!0},songselect:(e,t)=>{e.challenge=Object.assign(e.challenge,o),e.challenge.id=t.key,e.challenge.author=t.metadata.levelAuthorName,e.challenge.image=`https://beatsaver.com${t.coverURL}`,e.challenge.songName=t.metadata.songName,e.challenge.songNameShort=a(t.metadata.songName,18),e.challenge.songNameMedium=a(t.metadata.songName,30),e.challenge.songSubName=t.metadata.songSubName,e.challenge.songSubNameShort=a(t.metadata.songSubName,21),e.challenge.isBeatsPreloaded=!1,e.challenge.isLoading=!0,e.hasReceivedUserGesture=!1,e.isPaused=!1,e.isSongBufferProcessing=!1},usergesturereceive:e=>{e.hasReceivedUserGesture=!0},"enter-vr":e=>{e.inVR=!0},"exit-vr":e=>{e.inVR=!1}},computeState:e=>{e.isPlaying=!e.isPaused&&!e.isSongBufferProcessing&&!e.challenge.isLoading&&e.hasReceivedUserGesture}})},9853:e=>{e.exports.getS3FileUrl=function(e,t){return`https://saber.supermedium.com/${e}-${t}?v=1`}},549:()=>{THREE.BufferGeometryUtils={computeTangents:function(e){var t=e.index,i=e.attributes;if(null!==t&&void 0!==i.position&&void 0!==i.normal&&void 0!==i.uv){var n=t.array,o=i.position.array,s=i.normal.array,a=i.uv.array,r=o.length/3;void 0===i.tangent&&e.addAttribute("tangent",new THREE.BufferAttribute(new Float32Array(4*r),4));for(var l=i.tangent.array,c=[],d=[],h=0;h<r;h++)c[h]=new THREE.Vector3,d[h]=new THREE.Vector3;var u=new THREE.Vector3,f=new THREE.Vector3,m=new THREE.Vector3,p=new THREE.Vector2,g=new THREE.Vector2,b=new THREE.Vector2,y=new THREE.Vector3,v=new THREE.Vector3,E=e.groups;0===E.length&&(E=[{start:0,count:n.length}]);for(var x=0,w=E.length;x<w;++x)for(var A=B=(_=E[x]).start,k=B+_.count;A<k;A+=3)j(n[A+0],n[A+1],n[A+2]);var T,R,C,S=new THREE.Vector3,M=new THREE.Vector3,P=new THREE.Vector3,D=new THREE.Vector3;for(x=0,w=E.length;x<w;++x){var _,B;for(A=B=(_=E[x]).start,k=B+_.count;A<k;A+=3)O(n[A+0]),O(n[A+1]),O(n[A+2])}}else console.warn("THREE.BufferGeometry: Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()");function j(e,t,i){u.fromArray(o,3*e),f.fromArray(o,3*t),m.fromArray(o,3*i),p.fromArray(a,2*e),g.fromArray(a,2*t),b.fromArray(a,2*i);var n=f.x-u.x,s=m.x-u.x,r=f.y-u.y,l=m.y-u.y,h=f.z-u.z,E=m.z-u.z,x=g.x-p.x,w=b.x-p.x,A=g.y-p.y,k=b.y-p.y,T=1/(x*k-w*A);y.set((k*n-A*s)*T,(k*r-A*l)*T,(k*h-A*E)*T),v.set((x*s-w*n)*T,(x*l-w*r)*T,(x*E-w*h)*T),c[e].add(y),c[t].add(y),c[i].add(y),d[e].add(v),d[t].add(v),d[i].add(v)}function O(e){P.fromArray(s,3*e),D.copy(P),R=c[e],S.copy(R),S.sub(P.multiplyScalar(P.dot(R))).normalize(),M.crossVectors(D,R),C=M.dot(d[e]),T=C<0?-1:1,l[4*e]=S.x,l[4*e+1]=S.y,l[4*e+2]=S.z,l[4*e+3]=T}},mergeBufferGeometries:function(e,t){for(var i=null!==e[0].index,n=new Set(Object.keys(e[0].attributes)),o=new Set(Object.keys(e[0].morphAttributes)),s={},a={},r=new THREE.BufferGeometry,l=0,c=0;c<e.length;++c){var d=e[c];if(i!==(null!==d.index))return null;for(var h in d.attributes){if(!n.has(h))return null;void 0===s[h]&&(s[h]=[]),s[h].push(d.attributes[h])}for(var h in d.morphAttributes){if(!o.has(h))return null;void 0===a[h]&&(a[h]=[]),a[h].push(d.morphAttributes[h])}if(r.userData.mergedUserData=r.userData.mergedUserData||[],r.userData.mergedUserData.push(d.userData),t){var u;if(i)u=d.index.count;else{if(void 0===d.attributes.position)return null;u=d.attributes.position.count}r.addGroup(l,u,c),l+=u}}if(i){var f=0,m=[];for(c=0;c<e.length;++c){var p=e[c].index;if(f>0){p=p.clone();for(var g=0;g<p.count;++g)p.setX(g,p.getX(g)+f)}m.push(p),f+=e[c].attributes.position.count}var b=this.mergeBufferAttributes(m);if(!b)return null;r.index=b}for(var h in s){var y=this.mergeBufferAttributes(s[h]);if(!y)return null;r.addAttribute(h,y)}for(var h in a){var v=a[h][0].length;if(0===v)break;for(r.morphAttributes=r.morphAttributes||{},r.morphAttributes[h]=[],c=0;c<v;++c){var E=[];for(g=0;g<a[h].length;++g)E.push(a[h][g][c]);var x=this.mergeBufferAttributes(E);if(!x)return null;r.morphAttributes[h].push(x)}}return r},mergeBufferAttributes:function(e){for(var t,i,n,o=0,s=0;s<e.length;++s){var a=e[s];if(a.isInterleavedBufferAttribute)return null;if(void 0===t&&(t=a.array.constructor),t!==a.array.constructor)return null;if(void 0===i&&(i=a.itemSize),i!==a.itemSize)return null;if(void 0===n&&(n=a.normalized),n!==a.normalized)return null;o+=a.array.length}for(var r=new t(o),l=0,c=0;c<e.length;++c)r.set(e[c].array,l),l+=e[c].array.length;return new THREE.BufferAttribute(r,i,n)}}},9172:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>s});var n=i(3645),o=i.n(n)()((function(e){return e[1]}));o.push([e.id,'html{background:#111}#controls{align-items:center;background:rgba(0,0,0,0.85);border-radius:10px;bottom:0;display:none;font-family:system-ui,BlinkMacSystemFont,-apple-system,"Segoe UI",Helvetica,Arial,sans-serif;left:0;margin:0 auto 10px auto;padding:10px;position:fixed;right:0;width:675px;z-index:99999999}#controls.challengeLoaded{display:flex}#controls #controlsVolume{cursor:pointer;padding:3px 10px 0 3px}#controls #controlsVolume img{height:20px;width:20px}#controls #volumeSliderContainer{background:rgba(0,0,0,0.85);border-radius:0 5px 5px 0;bottom:95px;cursor:pointer;display:none;left:9px;padding-top:4px;position:absolute;transform:rotate(-90deg);z-index:999999999}#controls #volumeSliderContainer.volumeActive{display:block}#controls #volumeSliderContainer input{cursor:pointer;padding:0;width:100px}#controls #pause{cursor:pointer;display:flex;padding-right:10px;opacity:0;transition:opacity .5s}#controls #pause:hover #pauseSymbol{fill:#d11769}#controls #logo{margin-right:10px}#controls #logo img{height:32px;width:32px}#timeline{height:12px;width:160px}#timeline:hover #timelineLine{height:6px;background:#d11769;margin-top:3px}#timelineLine{height:2px;background:#8c1248;border-radius:2px;margin-top:5px;transition:background .2s,height .2s,margin-top .2s}#playhead{background:#fafafa;position:relative;border-radius:2px 0 0 2px;height:100%;width:0%}#songTime{color:#ccc;font-size:11px;margin-left:15px;margin-right:5px;width:70px}#songInfoContainer{align-items:center;display:flex}#songInfoContainer img{height:32px;width:32px}#songInfoContainer p{font-size:13px;margin:0;text-shadow:0 0 4px #000}#songInfoContainer #songInfo{display:flex;flex-direction:column;padding-left:10px}#songInfoContainer #songName{color:#ccc;font-weight:bold;font-size:14px}#songInfoContainer #songSubName{color:#ff3690}#songInfoContainer #songInfoSelect{align-items:center;display:flex;position:absolute;right:0}#songInfoContainer #controlsDifficulty{border:1px solid #ccc;border-radius:5px;color:#ccc;cursor:pointer;padding:5px 10px;text-align:center;transition:all .1s}#songInfoContainer #controlsDifficulty p{font-family:system-ui,BlinkMacSystemFont,-apple-system,"Segoe UI",Helvetica,Arial,sans-serif}#songInfoContainer #controlsDifficulty:after{content:\'\\25B2\';display:inline-block;font-size:11px;margin-left:5px}#songInfoContainer #controlsDifficulty:hover{border-color:#fafafa;color:#fafafa}#controlsDifficultyOptions{background:#020202;border:1px solid #ccc;border-radius:5px;bottom:50px;color:#fafafa;display:none;flex-direction:column;font-family:system-ui,BlinkMacSystemFont,-apple-system,"Segoe UI",Helvetica,Arial,sans-serif;font-size:13px;list-style:none;margin:0;opacity:0;padding:0;position:absolute;right:35px;transition:all .2s}#controlsDifficultyOptions li{cursor:pointer;padding:10px;min-width:65px;transition:all .1s}#controlsDifficultyOptions li:hover{color:#d11769}.difficultyOptionsActive #controlsDifficultyOptions{display:flex;opacity:1}#timeline{cursor:pointer;position:relative}#timelineHover{bottom:0;color:#fafafa;font-size:11px;display:none;padding:5px;position:absolute}#timelineHover.timelineHoverActive{display:block}#vrButton{background:url("assets/img/enter-vr-button-background.png") no-repeat;background-size:cover;border:0;bottom:25px;cursor:pointer;height:23.5px;position:absolute;right:30px;width:42px;z-index:9999999}#vrButton.a-hidden{visibility:hidden}#vrButton:active{border:0}#vrButton:hover{background-position:0 -25px}.github-corner{opacity:1;transition:.1s opacity}.isPlaying .github-corner{opacity:0}.isPlaying #controls,.isPlaying #controls #pause{opacity:1}.a-loader-title{display:none !important}#songInfoContainer #searchToggle{cursor:pointer;height:30px;padding:0 5px 0 15px;width:30px}#songInfoContainer #searchToggle svg{left:5px;position:relative;top:5px;transform:scale(1.5)}#songInfoContainer #searchToggle g{stroke:#ccc;transition:stroke .1s}#songInfoContainer #searchToggle:hover g{stroke:#fafafa}#search{bottom:50px;align-items:center;display:flex;flex-direction:column;justify-content:center;left:0;margin:0 auto;position:absolute;right:0;width:400px}#search input,#search #url{background:rgba(0,0,0,0.85);border-radius:10px;font-family:system-ui,BlinkMacSystemFont,-apple-system,"Segoe UI",Helvetica,Arial,sans-serif;font-size:14px;position:relative}input{border:1px solid #ccc;bottom:15px;color:#fafafa;padding:8px 20px;width:340px}#url{border:1px solid #222;color:#ccc;padding:8px 20px;text-align:center}#searchResultsContainer{background:rgba(0,0,0,0.95);border:1px solid #ccc;border-radius:10px;bottom:25px;display:flex;flex-direction:column;padding-bottom:6px;position:relative;width:340px}#searchResultsContainer > h3{color:#ccc;font-size:14px;text-align:center;margin:8px 0 0 0}#searchResults{display:flex;flex-direction:column;margin:0;max-height:200px;list-style:none;overflow:auto;padding:5px 0 5px 0}#searchResults li{align-items:center;background:none;color:#ccc;cursor:pointer;display:flex;font-size:12px;margin:0;margin-bottom:2px;padding-left:10px;transition:background .1s}#searchResults li:hover{background:rgba(30,30,30,0.95)}#searchResults li img{height:24px;width:24px}#searchResults li p{margin:0;padding-left:10px}#breakWarning{background:#111;border-radius:5px;color:#fafafa;font-family:system-ui,BlinkMacSystemFont,-apple-system,"Segoe UI",Helvetica,Arial,sans-serif;font-size:18px;left:0;margin:0 15%;opacity:.75;padding:10px;position:fixed;right:0;text-align:center;z-index:999999999;top:20px}',""]);const s=o},3645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i=e(t);return t[2]?"@media ".concat(t[2]," {").concat(i,"}"):i})).join("")},t.i=function(e,i,n){"string"==typeof e&&(e=[[null,e,""]]);var o={};if(n)for(var s=0;s<this.length;s++){var a=this[s][0];null!=a&&(o[a]=!0)}for(var r=0;r<e.length;r++){var l=[].concat(e[r]);n&&o[l[0]]||(i&&(l[2]?l[2]="".concat(i," and ").concat(l[2]):l[2]=i),t.push(l))}},t}},3058:(e,t,i)=>{var n=i(9172);"string"==typeof n&&(n=[[e.id,n,""]]);i(6723)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(e.exports=n.locals)},6723:(e,t,i)=>{var n,o,s={},a=(n=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===o&&(o=n.apply(this,arguments)),o}),r=function(e,t){return t?t.querySelector(e):document.querySelector(e)},l=function(e){var t={};return function(e,i){if("function"==typeof e)return e();if(void 0===t[e]){var n=r.call(this,e,i);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}}(),c=null,d=0,h=[],u=i(1947);function f(e,t){for(var i=0;i<e.length;i++){var n=e[i],o=s[n.id];if(o){o.refs++;for(var a=0;a<o.parts.length;a++)o.parts[a](n.parts[a]);for(;a<n.parts.length;a++)o.parts.push(v(n.parts[a],t))}else{var r=[];for(a=0;a<n.parts.length;a++)r.push(v(n.parts[a],t));s[n.id]={id:n.id,refs:1,parts:r}}}}function m(e,t){for(var i=[],n={},o=0;o<e.length;o++){var s=e[o],a=t.base?s[0]+t.base:s[0],r={css:s[1],media:s[2],sourceMap:s[3]};n[a]?n[a].parts.push(r):i.push(n[a]={id:a,parts:[r]})}return i}function p(e,t){var i=l(e.insertInto);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var n=h[h.length-1];if("top"===e.insertAt)n?n.nextSibling?i.insertBefore(t,n.nextSibling):i.appendChild(t):i.insertBefore(t,i.firstChild),h.push(t);else if("bottom"===e.insertAt)i.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var o=l(e.insertAt.before,i);i.insertBefore(t,o)}}function g(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=h.indexOf(e);t>=0&&h.splice(t,1)}function b(e){var t=document.createElement("style");if(void 0===e.attrs.type&&(e.attrs.type="text/css"),void 0===e.attrs.nonce){var n=i.nc;n&&(e.attrs.nonce=n)}return y(t,e.attrs),p(e,t),t}function y(e,t){Object.keys(t).forEach((function(i){e.setAttribute(i,t[i])}))}function v(e,t){var i,n,o,s;if(t.transform&&e.css){if(!(s="function"==typeof t.transform?t.transform(e.css):t.transform.default(e.css)))return function(){};e.css=s}if(t.singleton){var a=d++;i=c||(c=b(t)),n=w.bind(null,i,a,!1),o=w.bind(null,i,a,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(i=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",y(t,e.attrs),p(e,t),t}(t),n=k.bind(null,i,t),o=function(){g(i),i.href&&URL.revokeObjectURL(i.href)}):(i=b(t),n=A.bind(null,i),o=function(){g(i)});return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else o()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=a()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var i=m(e,t);return f(i,t),function(e){for(var n=[],o=0;o<i.length;o++){var a=i[o];(r=s[a.id]).refs--,n.push(r)}for(e&&f(m(e,t),t),o=0;o<n.length;o++){var r;if(0===(r=n[o]).refs){for(var l=0;l<r.parts.length;l++)r.parts[l]();delete s[r.id]}}}};var E,x=(E=[],function(e,t){return E[e]=t,E.filter(Boolean).join("\n")});function w(e,t,i,n){var o=i?"":n.css;if(e.styleSheet)e.styleSheet.cssText=x(t,o);else{var s=document.createTextNode(o),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(s,a[t]):e.appendChild(s)}}function A(e,t){var i=t.css,n=t.media;if(n&&e.setAttribute("media",n),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}function k(e,t,i){var n=i.css,o=i.sourceMap,s=void 0===t.convertToAbsoluteUrls&&o;(t.convertToAbsoluteUrls||s)&&(n=u(n)),o&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */");var a=new Blob([n],{type:"text/css"}),r=e.href;e.href=URL.createObjectURL(a),r&&URL.revokeObjectURL(r)}},1947:e=>{e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var i=t.protocol+"//"+t.host,n=i+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(e,t){var o,s=t.trim().replace(/^"(.*)"$/,(function(e,t){return t})).replace(/^'(.*)'$/,(function(e,t){return t}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(s)?e:(o=0===s.indexOf("//")?s:0===s.indexOf("/")?i+s:n+s.replace(/^\.\//,""),"url("+JSON.stringify(o)+")")}))}},5775:(e,t,i)=>{var n={"./active-color.js":7018,"./audio-columns.js":5405,"./beams.js":9034,"./beat-generator.js":3168,"./beat-hit-sound.js":8815,"./beat.js":4934,"./blob-texture.js":8068,"./collider-check.js":9444,"./console-shortcuts.js":4931,"./copy-texture.js":2599,"./cursor-mesh.js":2913,"./debug-controller.js":6177,"./debug-cursor.js":5675,"./debug-song-time.js":421,"./debug-state.js":5060,"./fake-glow.js":4274,"./floor-shader.js":2614,"./gpu-preloader.js":7565,"./iframe.js":5860,"./keyboard-raycastable.js":859,"./materials.js":592,"./mine-fragments-loader.js":2679,"./particleplayer.js":5388,"./pause.js":3735,"./pauser.js":4679,"./play-sound.js":4047,"./raycaster-target.js":3583,"./search.js":312,"./song-controls.js":6545,"./song-progress-ring.js":6851,"./song.js":6020,"./stage-colors.js":7967,"./stage-lasers.js":3185,"./stage-shader.js":4207,"./stats-param.js":8287,"./sub-object.js":4897,"./super-keyboard.js":6211,"./toggle-pause-play.js":4524,"./twister.js":5417,"./user-gesture.js":8020,"./vertex-colors-buffer.js":6900,"./visible-raycastable.js":8077,"./wall-shader.js":8236,"./wall.js":433,"./zip-loader.js":2869};function o(e){var t=s(e);return i(t)}function s(e){if(!i.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}o.keys=function(){return Object.keys(n)},o.resolve=s,e.exports=o,o.id=5775},3608:(e,t,i)=>{var n={"./index.js":2279};function o(e){var t=s(e);return i(t)}function s(e){if(!i.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}o.keys=function(){return Object.keys(n)},o.resolve=s,e.exports=o,o.id=3608}},t={};function i(n){var o=t[n];if(void 0!==o)return o.exports;var s=t[n]={id:n,exports:{}};return e[n].call(s.exports,s,s.exports,i),s.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{function e(e){e.keys().forEach(e)}console.time=()=>{},console.timeEnd=()=>{},i(549),i(4200),i(9489),i(6977),i(8327),i(4454),i(8581),i(3008),i(8146),i(7571),i(1335),i(2596),i(1479),i(4440),e(i(5775)),e(i(3608)),i(3058)})()})();